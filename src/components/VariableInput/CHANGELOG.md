# CHANGELOG - VariableInput 组件

本文档记录 VariableInput 组件的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划改进

- 重命名 `inex.tsx` 为 `index.tsx`
- 添加完整的测试覆盖
- 优化移动端体验
- 增加可访问性支持
- 添加主题切换功能
- 性能优化和代码分割

## [1.0.0] - 2024-11-18

### 新增 ✨

- 初始版本发布
- 实现基础变量插入功能
- 支持 `{{variable}}` 语法
- 集成 Ant Design Tree 组件实现变量选择下拉框
- 实现键盘导航支持（↑↓ 箭头键、回车、ESC）
- 添加鼠标点击选择变量功能
- 实现变量过滤和搜索功能
- 支持变量块整体删除
- 添加智能光标定位，防止进入变量块
- 变量块高亮显示和样式处理
- 支持自定义变量数据结构
- 添加内容变化回调函数 `onChange`
- 实现响应式下拉框定位

### 技术实现 ⚙️

- 基于 `contentEditable` 实现富文本编辑
- 使用 Selection API 和 Range API 处理文本选择
- 集成 Ant Design Tree 组件显示变量选项
- 实现正则表达式匹配检测变量插入触发点
- 添加 DOM 操作和事件处理
- 使用 TypeScript 提供完整类型支持

### 默认配置 📋

- 内置默认变量数据结构：
  - 用户信息（姓名、邮箱、手机号）
  - 订单信息（订单号、金额、日期）
  - 地址信息（城市、区县）

### 样式设计 🎨

- 变量块使用黄色高亮背景 (`#ffe58f`)
- 圆角边框和内边距设计
- 禁用用户选择防止误操作
- 阴影和边框的下拉框样式
- 键盘导航高亮效果

### 键盘操作 ⌨️

- `↑` / `↓` : 导航变量选项
- `Enter` : 确认选择当前变量
- `Esc` : 取消变量选择
- `Backspace` / `Delete` : 删除变量块

### 鼠标操作 🖱️

- 点击变量选项插入变量
- 鼠标悬停高亮当前选项
- 支持变量树展开折叠

### 搜索过滤 🔍

- 实时搜索过滤变量选项
- 支持节点标题模糊匹配
- 自动展开匹配的父节点

### 错误处理 🛡️

- 优雅处理 DOM 操作异常
- 空值和边界情况检查
- 浏览器兼容性处理

### 性能优化 ⚡

- 防抖处理输入事件
- 智能重渲染优化
- 内存泄漏防护

### 文档 📚

- 详细的 README.md 使用文档
- API 接口完整说明
- 使用示例和最佳实践
- 故障排除指南
- 性能注意事项

### 文件结构 📁

- `index.tsx` - 主组件实现 (402 行)
- `README.md` - 使用文档
- `FILE_LIST.md` - 文件列表
- `CHANGELOG.md` - 更新日志（本文件）

---

## 版本说明

### 版本号规则

- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 状态标识

- `✅ 已完成` - 功能已完成
- `📋 计划中` - 功能已规划但未开始
- `🔄 进行中` - 功能正在开发
- `⚠️ 待修复` - 发现问题需要修复

### 变更类型

- `✨ 新增` - 新功能
- `🔄 修改` - 对现有功能的变更
- `❌ 删除` - 移除的功能
- `🐛 修复` - 问题修复
- `🔒 安全` - 安全相关修复

## 贡献指南

### 提交变更

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交变更 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 创建 Pull Request

### 代码规范

- 使用 TypeScript 严格模式
- 遵循 ESLint 和 Prettier 配置
- 添加必要的注释和文档
- 包含适当的测试用例

### 变更日志要求

- 明确标注变更类型
- 提供详细的变更描述
- 包含相关的问题或 PR 链接
- 保持中文描述的一致性

---

**维护团队**: Claude AI Assistant & 前端开发团队  
**文档版本**: v1.0.0  
**最后更新**: 2024-11-18
