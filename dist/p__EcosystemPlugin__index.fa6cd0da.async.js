"use strict";(()=>{(self.webpackChunknuwax_frontend=self.webpackChunknuwax_frontend||[]).push([[7696],{92584:function(Ma,X,u){u.r(X),u.d(X,{default:function(){return Qe}});var Ce=u(15558),q=u.n(Ce),be=u(26068),E=u.n(be),Te=u(90228),h=u.n(Te),De=u(87999),P=u.n(De),Ee=u(48305),S=u.n(Ee),Pe=u(31151),Ae=u(58974),Ne=u(94815),Le=u(18489),p=u(45736),y=u(76253),L=u(28327),f=u(95564),je=u(63619),ke=u(46219),we=u(7010),Re=u(73981),Ie=u(17701),x=u(9504),$e=u(70183),He=u(94581),Me=u.n(He),v=u(75271),b={"xagi-nav-style2":"xagi-nav-style2___VkDKq",text:"text___L1ULz","page-container":"page-container___WLDiS",container:"container___tnDVH",header:"header___dDn36",searchInput:"searchInput___cgdZK",pluginList:"pluginList___JxOh1","list-section":"list-section___k1SHt",title:"title___tWZUT",segmented:"segmented___DuKKA",select:"select___olaJQ",headerRight:"headerRight___u2mgm"},Ze=u(89082),Je=u(21445),Fe=u(34003),ze=u(59602),Be=u(79484),Ve=u(35843),Ue=u(95484),Ge=u(16621),i=u(52676),m=Me().bind(b),Ke=je.Z.Search,w=24,Oe=Be.Ne.filter(function(A){return[L.qR.Plugin].includes(A.key)}),We=(p.l$===null||p.l$===void 0?void 0:p.l$.map(function(A){return{label:A.label,value:A.key}}))||[];function Qe(){var A,B,V,Ye=ke.Z.useApp(),g=Ye.message,Xe=(0,v.useState)(""),_=S()(Xe,2),U=_[0],ee=_[1],qe=(0,v.useState)(p.eH.ALL),ae=S()(qe,2),T=ae[0],xe=ae[1],_e=(0,v.useState)(!1),re=S()(_e,2),ea=re[0],R=re[1],aa=(0,v.useState)(null),ne=S()(aa,2),N=ne[0],se=ne[1],ra=(0,v.useState)(!1),te=S()(ra,2),na=te[0],I=te[1],sa=(0,v.useState)(!1),ue=S()(sa,2),G=ue[0],le=ue[1],ta=(0,v.useState)(null),ie=S()(ta,2),$=ie[0],H=ie[1],ua=(0,v.useState)(!1),de=S()(ua,2),K=de[0],M=de[1],la=(0,v.useState)({size:10,records:[],total:0,current:1,pages:0}),oe=S()(la,2),C=oe[0],Z=oe[1],ia=(0,v.useState)({current:1,pageSize:w}),ce=S()(ia,2),j=ce[0],he=ce[1],da=(0,Ue.Z)(),oa=da.onDeleteShare,ca=(0,v.useCallback)(P()(h()().mark(function n(){var e,r,l,t,a,o,c,s,O,W,Q,Se,k,me,ye,Y=arguments;return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:e=Y.length>0&&Y[0]!==void 0?Y[0]:{},r=e.tabType,l=e.keyword,t=l===void 0?"":l,a=e.page,o=a===void 0?1:a,c=e.pageSize,s=c===void 0?w:c,O=e.shareStatus,W=O===void 0?-1:O,Q=e.categoryCode,Se=Q===void 0?"":Q,M(!0),d.prev=2,d.t0=r,d.next=d.t0===p.eH.ALL?6:d.t0===p.eH.ENABLED?8:d.t0===p.eH.SHARED?10:12;break;case 6:return k=f.wF.ALL,d.abrupt("break",13);case 8:return k=f.wF.ENABLED,d.abrupt("break",13);case 10:return k=f.wF.MY_SHARE,d.abrupt("break",13);case 12:k=f.wF.ALL;case 13:return me={queryFilter:{dataType:f.Th.PLUGIN,subTabType:k,name:t||void 0,shareStatus:W===-1?void 0:W,categoryCode:Se||void 0},current:o,pageSize:s,orders:[{column:"created",asc:!1}]},Z({size:s,records:[],total:0,current:o,pages:0}),d.next=17,(0,y.k_)(me);case 17:ye=d.sent,Z(ye),d.next=25;break;case 21:d.prev=21,d.t1=d.catch(2),console.error("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u5931\u8D25:",d.t1),g.error("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u5931\u8D25");case 25:return d.prev=25,M(!1),d.finish(25);case 28:case"end":return d.stop()}},n,null,[[2,21,25,28]])})),[T,U,j.current,j.pageSize]),D=function(e){he({current:1,pageSize:w}),ca(E()({tabType:T,keyword:e?.keyword===void 0?U:e.keyword,page:1,pageSize:w},e||{}))};(0,v.useEffect)(function(){D()},[T]);var ha=function(e){var r=T===p.eH.SHARED,l=T===p.eH.ALL;return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion,author:e.author||"",targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:l?e.useStatus===f.MN.ENABLED:void 0,shareStatus:r?e.shareStatus:void 0,publishDoc:e.publishDoc}},va=function(e){return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion||!1,author:e.author||"",dataType:e.dataType,ownedFlag:e.ownedFlag,targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:e.useStatus===f.MN.ENABLED,publishDoc:e.publishDoc}},ve=function(e){ee(e),D({keyword:e})},pa=function(){se(null),R(!1)},fa=function(){var n=P()(h()().mark(function e(r){var l;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(N){a.next=2;break}return a.abrupt("return",!1);case 2:return l=null,a.prev=3,a.next=6,(0,y.$t)({uid:N.uid,configParamJson:JSON.stringify(r)});case 6:l=a.sent,a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(3),g.error("\u64CD\u4F5C\u5931\u8D25"),a.abrupt("return",!1);case 13:if(!l){a.next=18;break}return R(!1),g.success("\u66F4\u65B0\u6210\u529F"),D(),a.abrupt("return",!0);case 18:return g.error("\u66F4\u65B0\u5931\u8D25"),a.abrupt("return",!1);case 20:case"end":return a.stop()}},e,null,[[3,9]])}));return function(r){return n.apply(this,arguments)}}(),ga=function(){var n=P()(h()().mark(function e(){var r;return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(N!=null&&N.uid){t.next=2;break}return t.abrupt("return",!1);case 2:return r=null,t.prev=3,t.next=6,(0,y.m5)(N.uid);case 6:r=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(3),g.error("\u4E0B\u7EBF\u5931\u8D25"),t.abrupt("return",!1);case 13:if(!r){t.next=18;break}return g.success("\u5DF2\u4E0B\u7EBF"),R(!1),D(),t.abrupt("return",!0);case 18:return g.error("\u4E0B\u7EBF\u5931\u8D25"),t.abrupt("return",!1);case 20:case"end":return t.stop()}},e,null,[[3,9]])}));return function(){return n.apply(this,arguments)}}(),Sa=function(){le(!1),H(null),I(!0)},ma=function(){D(),I(!1),H(null)},ya=function(){var n=P()(h()().mark(function e(r,l){var t,a,o;return h()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,t={name:r.name,description:r.description,dataType:f.Th.PLUGIN,targetType:r.targetType||L.qR.Plugin,targetId:r.targetId,categoryCode:r.categoryCode,categoryName:r.categoryName,useStatus:r.useStatus||f.MN.ENABLED,author:r.author,publishDoc:r.publishDoc,configParamJson:r.configParamJson,icon:r.icon},a=null,!(G&&$!==null&&$!==void 0&&$.uid)){s.next=16;break}if(o=E()(E()({},t),{},{uid:$.uid}),!l){s.next=11;break}return s.next=8,(0,y.Cd)(o);case 8:a=s.sent,s.next=14;break;case 11:return s.next=13,(0,y.F6)(o);case 13:a=s.sent;case 14:s.next=25;break;case 16:if(!l){s.next=22;break}return s.next=19,(0,y.$Q)(t);case 19:a=s.sent,s.next=25;break;case 22:return s.next=24,(0,y.TG)(t);case 24:a=s.sent;case 25:if(!a){s.next=31;break}return g.success(G?"\u66F4\u65B0\u6210\u529F":"\u521B\u5EFA\u6210\u529F"),ma(),s.abrupt("return",!0);case 31:return g.error("\u64CD\u4F5C\u5931\u8D25"),s.abrupt("return",!1);case 33:s.next=40;break;case 35:return s.prev=35,s.t0=s.catch(0),console.error("\u4FDD\u5B58\u5206\u4EAB\u5931\u8D25:",s.t0),g.error("\u64CD\u4F5C\u5931\u8D25"),s.abrupt("return",!1);case 40:case"end":return s.stop()}},e,null,[[0,35]])}));return function(r,l){return n.apply(this,arguments)}}(),Ca=function(){var n=P()(h()().mark(function e(r,l){var t,a,o=arguments;return h()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=o.length>2&&o[2]!==void 0?o[2]:!1,M(!0),s.prev=2,s.next=5,(0,y.k_)({queryFilter:{dataType:f.Th.PLUGIN},current:r,pageSize:l,orders:[{column:"created",asc:!1}]});case 5:a=s.sent,t&&C.records?Z(E()(E()({},a),{},{records:[].concat(q()(C.records||[]),q()(a.records||[]))})):Z(a),s.next=13;break;case 9:s.prev=9,s.t0=s.catch(2),console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",s.t0),g.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25");case 13:return s.prev=13,M(!1),s.finish(13);case 16:case"end":return s.stop()}},e,null,[[2,9,13,16]])}));return function(r,l){return n.apply(this,arguments)}}(),ba=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;K||(he(function(l){return E()(E()({},l),{},{current:e})}),Ca(e,j.pageSize,r))},Ta=function(e){D({shareStatus:e})},Da=function(e){D({categoryCode:e===""?void 0:e})},Ea=(0,v.useState)(!1),pe=S()(Ea,2),Pa=pe[0],J=pe[1],Aa=(0,v.useState)(null),fe=S()(Aa,2),Na=fe[0],F=fe[1],La=(0,v.useState)([]),ge=S()(La,2),ja=ge[0],z=ge[1],ka=function(e){J(!1),F({icon:e.icon,name:e.name,description:e.description,targetType:e.targetType,targetSubType:e.targetSubType,targetId:e.targetId.toString(),shareStatus:f.yB.DRAFT}),z([{type:e.targetType,targetId:e.targetId,status:L.BQ.Added}])},wa=function(){var n=P()(h()().mark(function e(r){var l,t,a;return h()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(T!=="shared"){c.next=11;break}H(r),le(!0),I(!0),J(!1),l=r.targetType,t={icon:r.icon||"",uid:r.uid,name:r.name||"",description:r.description||"",targetType:l,targetSubType:r.targetSubType,targetId:(r.targetId||"").toString(),author:r.author||"",publishDoc:r.publishDoc||"",shareStatus:r.shareStatus,configParamJson:r.configParamJson||""},F(t),z([{type:l,targetId:Number(t.targetId)||0,status:L.BQ.Added}]),c.next=22;break;case 11:if(!r.uid){c.next=22;break}return c.prev=12,c.next=15,(0,y.Ry)(r.uid);case 15:a=c.sent,a&&(se(a),R(!0)),c.next=22;break;case 19:c.prev=19,c.t0=c.catch(12),g.error("\u83B7\u53D6\u63D2\u4EF6\u8BE6\u60C5\u5931\u8D25");case 22:case"end":return c.stop()}},e,null,[[12,19]])}));return function(r){return n.apply(this,arguments)}}(),Ra=function(){var n=P()(h()().mark(function e(r){var l;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=null,a.prev=1,a.next=4,(0,y.n)(r);case 4:l=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(!l){a.next=14;break}return g.success("\u63D2\u4EF6\u5DF2\u4E0B\u7EBF"),D(),a.abrupt("return",!0);case 14:return a.abrupt("return",!1);case 15:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return n.apply(this,arguments)}}(),Ia=function(){var n=P()(h()().mark(function e(r){var l;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=null,a.prev=1,a.next=4,(0,y.LI)(r);case 4:l=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(!l){a.next=14;break}return g.success("\u63D2\u4EF6\u5DF2\u64A4\u9500\u53D1\u5E03"),D(),a.abrupt("return",!0);case 14:return a.abrupt("return",!1);case 15:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return n.apply(this,arguments)}}(),$a=function(){I(!1),H(null),F(null),z([])},Ha=function(e,r){var l=r.uid,t=r.name;l&&oa(l,t||"",function(){D()})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:m(b.container,"flex","flex-col","h-full","overflow-hide"),children:[(0,i.jsxs)("div",{className:m(b.header),children:[(0,i.jsxs)(we.Z,{children:[(0,i.jsx)("h3",{className:m(b.title),children:"\u63D2\u4EF6"}),(0,i.jsx)(Re.Z,{className:m(b.segmented),options:We,value:T,onChange:function(e){return xe(e)}}),T===p.eH.SHARED?(0,i.jsx)(Ie.default,{options:p.Jd,defaultValue:-1,onChange:function(e){return Ta(e)},className:m(b.select)}):(0,i.jsx)(Ae.Z,{targetType:L.qR.Plugin,onChange:function(e){return Da(e)}})]}),(0,i.jsxs)("div",{className:m(b.headerRight),children:[(0,i.jsx)(Ke,{className:m(b.searchInput),placeholder:"\u641C\u7D22\u63D2\u4EF6",value:U,onChange:function(e){return ee(e.target.value)},onSearch:ve,onClear:function(){return ve("")},allowClear:!0}),T===p.eH.SHARED&&(0,i.jsx)(x.ZP,{type:"primary",onClick:Sa,icon:(0,i.jsx)(Ge.Z,{}),children:"\u521B\u5EFA\u5206\u4EAB"})]})]}),(0,i.jsx)("div",{className:m(b.pluginList,"flex-1","scroll-container-hide"),onScroll:function(e){var r=e.currentTarget,l=r.scrollTop,t=r.scrollHeight,a=r.clientHeight;t-l-a<100&&!K&&j.current<(C.pages||0)&&ba(j.current+1,!0)},children:K&&(C==null||(A=C.records)===null||A===void 0?void 0:A.length)===0?(0,i.jsx)(ze.Z,{className:m("h-full")}):C!=null&&(B=C.records)!==null&&B!==void 0&&B.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:m(b["list-section"]),children:(V=C.records)===null||V===void 0?void 0:V.map(function(n){var e=T===p.eH.SHARED?n.shareStatus:void 0,r=n.shareStatus===f.yB.PUBLISHED,l=n.shareStatus===f.yB.REVIEWING;return(0,i.jsx)(Je.Z,E()(E()({},ha(n)),{},{onClick:P()(h()().mark(function t(){return h()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,wa(n);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},t)})),footer:(0,i.jsx)("footer",{className:m("flex","items-center","content-end"),children:e&&!(r||l)&&(0,i.jsx)(Ze.Z,{list:p.Ac,onClick:function(a){return Ha(a,n)},children:(0,i.jsx)(x.ZP,{size:"small",type:"text",icon:(0,i.jsx)(Ve.Ey,{})})})})}),n?.uid)})}),!(j.current<(C.pages||0))&&(0,i.jsx)(Fe.Z,{})]}):(0,i.jsx)("div",{className:m("flex","h-full","items-center","content-center"),children:(0,i.jsx)($e.Z,{className:m("flex","flex-col","items-center","content-center"),description:"\u6682\u65E0\u6570\u636E"})})})]}),(0,i.jsx)(Pe.Z,{visible:ea,data:N?va(N):void 0,onClose:pa,onUpdateAndEnable:fa,onDisable:ga}),(0,i.jsx)(Ne.Z,{type:f.Th.PLUGIN,targetType:L.qR.Plugin,visible:na,isEdit:G,onClose:$a,onOffline:Ra,onWithdraw:Ia,onSave:ya,data:Na,onAddComponent:function(){J(!0)},onRemoveComponent:function(){F(null),z([])}}),(0,i.jsx)(Le.Z,{checkTag:L.qR.Plugin,onAdded:ka,open:Pa,onCancel:function(){return J(!1)},tabs:Oe,addComponents:ja})]})}}}]);})();
