"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[7311],{75216:function(J,C,e){var N=e(67294),d=e(85893),j=function(x){var h=x.children,y=x.condition;return y?(0,d.jsx)(d.Fragment,{children:h}):null};C.Z=j},71437:function(J,C,e){e.d(C,{Z:function(){return $}});var N=e(95141),d=e(24969),j=e(83062),E=e(94184),x=e.n(E),h=e(67294),y={box:"box___khloQ"},I=e(85893),Y=x().bind(y),f=function(T){var X=T.className,M=T.type,S=M===void 0?N.Ai.Blank:M,R=T.icon,w=T.title,k=T.onClick,V=S===N.Ai.Blank?"tooltip-blank":"tooltip-white";return(0,I.jsx)(j.Z,{title:w,classNames:{root:V},children:(0,I.jsx)("span",{className:Y("hover-box","flex","content-center","items-center","cursor-pointer",y.box,X),onClick:k,children:R||(0,I.jsx)(d.Z,{})})})},$=f},59096:function(J,C,e){e.r(C),e.d(C,{default:function(){return Ge}});var N=e(15009),d=e.n(N),j=e(97857),E=e.n(j),x=e(99289),h=e.n(x),y=e(5574),I=e.n(y),Y=e(78390),f=e(8380),$=e(50066),Q=e(95875),T=e(76688),X=e(97630),M=e(72568),S=e(32909),R=e(21015),w=e(95123),k=e(29269),V=e(99171),re=e(91120),m=e(95141),H=e(19515),ie=e(3622),Ee=e(30961),se=e(48689),A=e(99859),Ie=e(45360),Z=e(25278),de=e(38089),ce=e(34041),q=e(84567),Te=e(83062),ve=e(42075),Ae=e(78045),me=e(79368),K=e(85804),Ze=e(94184),he=e.n(Ze),_=e(67294),G=e(39902),p={container:"container___IEl0t","main-container":"main-container___sMpOU",title:"title___ODWN6","request-select":"request-select___M1IeR","table-wrap":"table-wrap___ty9xJ","mb-24":"mb-24___UJXHH",select:"select___yVYzb"},Pe=e(26145),De=e(30881),Be=e(86384),Ne=e(6171),Re=e(86548),Oe=e(8751),be=e(24019),Me=e(14313),Se=e(66309),ke=e(30381),pe=e.n(ke),c={header:"header___fCRSy","icon-back":"icon-back___t7VtQ",logo:"logo___PI8Y9",section:"section___c_GEv","top-box":"top-box___M54E6",name:"name___VB2L3",circle:"circle___XOm84","bottom-box":"bottom-box___OPqdd",box:"box___NiV4x","update-time":"update-time___r2_WM",history:"history___cyNGM","try-btn":"try-btn___k7NAI"},n=e(85893),v=he().bind(c),Ve=function(F){var r=F.pluginInfo,ee=F.onEdit,ne=F.onToggleHistory,O=F.onSave,o=F.onTryRun,te=F.onPublish,L=(0,G.useParams)(),ue=L.spaceId,U=(0,_.useMemo)(function(){if(r){var P;return!(r!=null&&(P=r.permissions)!==null&&P!==void 0&&P.includes(m.jE.Publish))}else return!1},[r]);return(0,n.jsxs)("header",{className:v("flex","items-center","w-full",c.header),children:[(0,n.jsx)(Ne.Z,{className:v(c["icon-back"],"cursor-pointer"),onClick:function(){return(0,Be.bC)("/space/".concat(ue,"/library"))}}),(0,n.jsx)("img",{className:v(c.logo),src:r?.icon||Pe,alt:""}),(0,n.jsxs)("section",{className:v("flex-1","flex","flex-col","content-between",c.section),children:[(0,n.jsxs)("div",{className:v("flex","w-full",c["top-box"]),children:[(0,n.jsx)("h3",{className:v(c.name,"text-ellipsis"),children:r?.name}),(0,n.jsx)(Re.Z,{className:v("cursor-pointer","hover-box"),onClick:ee}),(0,n.jsx)(Oe.Z,{className:v(c.circle)}),r?.publishDate!==null&&pe()(r?.publishDate).isBefore(r?.modified)&&(0,n.jsx)(Se.Z,{bordered:!1,color:"volcano",style:{marginLeft:"6px"},children:"\u6709\u66F4\u65B0\u672A\u53D1\u5E03"})]}),(0,n.jsxs)("div",{className:v(c["bottom-box"],"flex","items-center"),children:[(0,n.jsx)("span",{className:v(c.box),children:r?.type===De.AQ.HTTP?"http":"\u4EE3\u7801"}),(0,n.jsx)("span",{className:v(c.box),children:r?.publishStatus===m.xH.Published?"\u5DF2\u53D1\u5E03":"\u672A\u53D1\u5E03"}),(0,n.jsxs)("span",{className:v(c["update-time"]),children:["\u914D\u7F6E\u81EA\u52A8\u4FDD\u5B58\u4E8E",pe()(r?.created).format("HH:mm")]})]})]}),(0,n.jsx)(be.Z,{className:v(c.history,"cursor-pointer"),onClick:ne}),(0,n.jsx)(K.ZP,{className:v(c["try-btn"]),type:"primary",onClick:O,children:"\u4FDD\u5B58"}),(0,n.jsx)(K.ZP,{className:v(c["try-btn"]),type:"primary",icon:(0,n.jsx)(Me.Z,{}),onClick:o,children:"\u8BD5\u8FD0\u884C"}),(0,n.jsx)(K.ZP,{type:"primary",onClick:te,disabled:U,children:"\u53D1\u5E03"})]})},He=Ve,g=he().bind(p),Ke=function(){var F=(0,G.useParams)(),r=Number(F.spaceId),ee=A.Z.useForm(),ne=I()(ee,1),O=ne[0],o=(0,w.Z)(),te=o.isModalOpen,L=o.setIsModalOpen,ue=o.autoAnalysisOpen,U=o.setAutoAnalysisOpen,P=o.visible,fe=o.setVisible,Ue=o.openModal,ge=o.setOpenModal,D=o.pluginId,i=o.pluginInfo,ze=o.setPluginInfo,We=o.openPlugin,Ce=o.setOpenPlugin,b=o.inputConfigArgs,Je=o.setInputConfigArgs,xe=o.outputConfigArgs,ae=o.expandedRowKeys,Ye=o.setExpandedRowKeys,$e=o.outputExpandedRowKeys,B=o.handleInputValue,z=o.handleOutputValue,Qe=o.handleInputAddChild,Xe=o.handleOutputAddChild,we=o.handleInputDel,qe=o.handleOutputDel,_e=o.handleConfirmUpdate,en=o.handleInputConfigAdd,nn=o.handleOutputConfigAdd,ye=o.handleOutputConfigArgs,tn=o.handleConfirmPublishPlugin,le=(0,_.useRef)(!1),un=(0,G.useRequest)(V.dB,{manual:!0,debounceInterval:300,onSuccess:function(u){if(ze(u),u.config){var t=u.config,a=t.method,s=t.url,oe=t.contentType,hn=t.timeout,je=t.inputArgs,pn=t.outputArgs;O.setFieldsValue({method:a||m.LM.GET,url:s,contentType:oe||m.lT.OTHER,timeout:hn||10});var fn=(0,ie.kS)(je);Ye(fn),Je(je),ye(pn)}}}),an=un.run,ln=(0,G.useRequest)(V.i,{manual:!0,debounceInterval:300,onSuccess:function(){le.current&&(Ie.ZP.success("\u63D2\u4EF6\u4FDD\u5B58\u6210\u529F"),le.current=!1)}}),on=ln.run;(0,_.useEffect)(function(){an(D)},[D]);var Fe=function(u){return u[u.length-1]},rn=[{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u540D\u79F0"}),dataIndex:"name",key:"name",className:"flex items-center",render:function(u,t){return(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0\uFF0C\u786E\u4FDD\u542B\u4E49\u6E05\u6670",value:u,onChange:function(s){return B(t.key,"name",s.target.value)}})}},{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u63CF\u8FF0"}),dataIndex:"description",key:"description",render:function(u,t){return(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u63CF\u8FF0\uFF0C\u786E\u4FDD\u63CF\u8FF0\u8BE6\u7EC6\u4FBF\u4E8E\u5927\u6A21\u578B\u66F4\u597D\u7684\u7406\u89E3",value:u,onChange:function(s){return B(t.key,"description",s.target.value)}})}},{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u7C7B\u578B"}),dataIndex:"dataType",key:"dataType",width:120,render:function(u,t){return(0,n.jsx)(de.Z,{rootClassName:p.select,allowClear:!1,options:k.DJ,expandTrigger:"hover",displayRender:Fe,defaultValue:(0,H.n3)(u),onChange:function(s){B(t.key,"dataType",(0,H.$g)(s))},placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B"})}},{title:(0,n.jsx)(f.Z,{label:"\u4F20\u5165\u65B9\u5F0F"}),dataIndex:"inputType",key:"inputType",width:120,render:function(u,t){return(0,ie.YY)(b,t.key,1)===1&&(0,n.jsx)(ce.Z,{rootClassName:p.select,options:R.R0,value:u,onChange:function(s){return B(t.key,"inputType",s)}})}},{title:"\u662F\u5426\u5FC5\u987B",dataIndex:"require",key:"require",width:100,align:"center",render:function(u,t){return(0,n.jsx)(q.Z,{checked:u,onChange:function(s){return B(t.key,"require",s.target.checked)}})}},{title:"\u9ED8\u8BA4\u503C",dataIndex:"bindValue",key:"bindValue",width:150,render:function(u,t){var a;return(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C",disabled:m.Gi.Object===t.dataType||m.Gi.Array_Object===t.dataType||((a=t.dataType)===null||a===void 0?void 0:a.includes("Array"))||!t.enable,value:u,onChange:function(oe){return B(t.key,"bindValue",oe.target.value)}})}},{title:"\u5F00\u542F",dataIndex:"enable",key:"enable",width:70,align:"center",render:function(u,t){return(0,n.jsx)(Te.Z,{title:t.require&&!t.bindValue&&"\u6B64\u53C2\u6570\u662F\u5FC5\u586B\u53C2\u6570\uFF0C\u586B\u5199\u9ED8\u8BA4\u503C\u540E\uFF0C\u6B64\u5F00\u5173\u53EF\u7528",children:(0,n.jsx)(q.Z,{disabled:t.require&&!t.bindValue,checked:u,onChange:function(s){return B(t.key,"enable",s.target.checked)}})})}},{title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:function(u,t){return(0,n.jsxs)(ve.Z,{size:"middle",children:[(m.Gi.Object===t.dataType||m.Gi.Array_Object===t.dataType)&&(0,n.jsx)(S.Me,{className:g("cursor-pointer"),onClick:function(){return Qe(t.key)}}),(0,n.jsx)(se.Z,{onClick:function(){return we(t.key)}})]})}}],sn=[{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u540D\u79F0"}),dataIndex:"name",key:"name",width:430,className:"flex items-center",render:function(u,t){return(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0\uFF0C\u786E\u4FDD\u542B\u4E49\u6E05\u6670",value:u,onChange:function(s){return z(t.key,"name",s.target.value)}})}},{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u63CF\u8FF0"}),dataIndex:"description",key:"description",render:function(u,t){return(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u63CF\u8FF0\uFF0C\u786E\u4FDD\u63CF\u8FF0\u8BE6\u7EC6\u4FBF\u4E8E\u5927\u6A21\u578B\u66F4\u597D\u7684\u7406\u89E3",onChange:function(s){return z(t.key,"description",s.target.value)},value:u})}},{title:(0,n.jsx)(f.Z,{label:"\u53C2\u6570\u7C7B\u578B"}),dataIndex:"dataType",key:"dataType",width:120,render:function(u,t){return(0,n.jsx)(de.Z,{allowClear:!1,rootClassName:p.select,options:k.DJ,expandTrigger:"hover",displayRender:Fe,defaultValue:(0,H.n3)(u),onChange:function(s){z(t.key,"dataType",(0,H.$g)(s))},placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B"})}},{title:"\u5F00\u542F",dataIndex:"enable",key:"enable",width:70,align:"center",render:function(u,t){return(0,n.jsx)(q.Z,{checked:u,onChange:function(s){return z(t.key,"enable",s.target.checked)}})}},{title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:function(u,t){return(0,n.jsxs)(ve.Z,{size:"middle",children:[(m.Gi.Object===t.dataType||m.Gi.Array_Object===t.dataType)&&(0,n.jsx)(S.Me,{className:g("cursor-pointer"),onClick:function(){return Xe(t.key)}}),(0,n.jsx)(se.Z,{onClick:function(){return qe(t.key)}})]})}}],W=function(){var l=h()(d()().mark(function u(){var t;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,O.validateFields();case 2:t=s.sent,on({id:D,config:E()(E()({},t),{},{inputArgs:b,outputArgs:xe})});case 4:case"end":return s.stop()}},u)}));return function(){return l.apply(this,arguments)}}(),dn=function(){var l=h()(d()().mark(function u(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return le.current=!0,a.next=3,W();case 3:case"end":return a.stop()}},u)}));return function(){return l.apply(this,arguments)}}(),cn=function(){var l=h()(d()().mark(function u(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,W();case 2:L(!0);case 3:case"end":return a.stop()}},u)}));return function(){return l.apply(this,arguments)}}(),vn=function(){var l=h()(d()().mark(function u(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,W();case 2:ge(!0);case 3:case"end":return a.stop()}},u)}));return function(){return l.apply(this,arguments)}}(),mn=function(){var l=h()(d()().mark(function u(){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,W();case 2:U(!0);case 3:case"end":return a.stop()}},u)}));return function(){return l.apply(this,arguments)}}();return(0,n.jsxs)("div",{className:g("flex","h-full"),children:[(0,n.jsxs)("div",{className:g(p.container,"flex","flex-col","flex-1","h-full"),children:[(0,n.jsx)(He,{pluginInfo:i,onEdit:function(){return Ce(!0)},onToggleHistory:function(){return fe(!P)},onSave:dn,onTryRun:cn,onPublish:vn}),(0,n.jsxs)("div",{className:g(p["main-container"],"overflow-y"),children:[(0,n.jsx)("h3",{className:g(p.title,"mb-12"),children:"\u8BF7\u6C42\u914D\u7F6E"}),(0,n.jsxs)(A.Z,{form:O,initialValues:{method:m.LM.GET,contentType:m.lT.OTHER,timeout:10},layout:"vertical",requiredMark:Ee.N,children:[(0,n.jsx)(A.Z.Item,{label:(0,n.jsx)(f.Z,{label:"\u8BF7\u6C42\u65B9\u6CD5\u4E0E\u8DEF\u5F84"}),children:(0,n.jsxs)("div",{className:g("flex"),children:[(0,n.jsx)(A.Z.Item,{name:"method",noStyle:!0,children:(0,n.jsx)(ce.Z,{rootClassName:g(p["request-select"]),options:R.dh,placeholder:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u65B9\u6CD5"})}),(0,n.jsx)(A.Z.Item,{name:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u8DEF\u5F84"}],noStyle:!0,children:(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u8DEF\u5F84"})})]})}),(0,n.jsx)(A.Z.Item,{name:"contentType",label:"\u8BF7\u6C42\u5185\u5BB9\u683C\u5F0F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u5185\u5BB9\u683C\u5F0F"}],children:(0,n.jsx)(Ae.ZP.Group,{options:R.Ev})}),(0,n.jsx)(A.Z.Item,{name:"timeout",label:"\u8BF7\u6C42\u8D85\u65F6\u914D\u7F6E",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D85\u65F6\u914D\u7F6E"}],children:(0,n.jsx)(Z.Z,{placeholder:"\u8BF7\u6C42\u8D85\u65F6\u914D\u7F6E\uFF0C\u4EE5\u79D2\u4E3A\u5355\u4F4D"})})]}),(0,n.jsx)(Q.Z,{title:"\u5165\u53C2\u914D\u7F6E",onClick:en}),(0,n.jsx)(me.Z,{className:g(p["table-wrap"],p["mb-24"],"overflow-hide"),columns:rn,dataSource:b,pagination:!1,expandable:{childrenColumnName:"subArgs",defaultExpandAllRows:!0,expandedRowKeys:ae,expandIcon:function(){return null}}}),(0,n.jsx)(Q.Z,{title:"\u51FA\u53C2\u914D\u7F6E",onClick:nn,extra:(0,n.jsx)(K.ZP,{onClick:mn,children:"\u81EA\u52A8\u89E3\u6790"})}),(0,n.jsx)(me.Z,{className:g(p["table-wrap"],"overflow-hide"),columns:sn,dataSource:xe,pagination:!1,expandable:{childrenColumnName:"subArgs",defaultExpandAllRows:!0,expandedRowKeys:$e,expandIcon:function(){return null}}}),(0,n.jsx)(T.Z,{inputConfigArgs:b,inputExpandedRowKeys:ae,pluginId:D,pluginName:i?.name,open:te,onCancel:function(){return L(!1)}}),(0,n.jsx)($.Z,{inputConfigArgs:b,inputExpandedRowKeys:ae,pluginId:D,pluginName:i?.name,open:ue,onCancel:function(){return U(!1)},onConfirm:ye})]})]}),(0,n.jsx)(X.Z,{mode:re.qR.Plugin,targetId:D,spaceId:r,category:i?.category,open:Ue,onlyShowTemplate:!1,onCancel:function(){return ge(!1)},onConfirm:tn}),(0,n.jsx)(M.Z,{targetId:D,targetName:i?.name,targetType:re.qR.Plugin,permissions:i?.permissions||[],visible:P,onClose:function(){return fe(!1)}}),(0,n.jsx)(Y.Z,{open:We,id:i?.id,icon:i?.icon,name:i?.name,description:i?.description,mode:m.jA.Update,onCancel:function(){return Ce(!1)},onConfirm:_e})]})},Ge=Ke},30961:function(J,C,e){e.d(C,{N:function(){return j},g:function(){return E}});var N=e(67294),d=e(85893),j=function(h,y){var I=y.required;return(0,d.jsxs)(d.Fragment,{children:[h,I?(0,d.jsx)("span",{style:{color:"red",fontWeight:600,marginLeft:"4px"},children:"*"}):null]})},E=function(h){return(0,d.jsx)(d.Fragment,{children:h})}}}]);})();
