"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[3126],{78390:function(ae,W,e){var M=e(97857),t=e.n(M),B=e(5574),r=e.n(B),h=e(26145),P=e(75216),I=e(83926),c=e(61474),S=e(68104),L=e(21015),O=e(99171),$=e(95141),T=e(30881),x=e(30961),i=e(99859),N=e(45360),d=e(25278),V=e(78045),H=e(94184),K=e.n(H),G=e(67294),C=e(39902),U=e(4141),R=e(85893),g=K(),de=function(o){var m=o.spaceId,s=o.id,a=o.icon,l=o.name,p=o.description,b=o.mode,_=b===void 0?$.jA.Create:b,j=o.open,w=o.onCancel,u=o.onConfirm,y=i.Z.useForm(),Q=r()(y,1),n=Q[0],Y=(0,G.useState)(""),ee=r()(Y,2),D=ee[0],z=ee[1],ve=(0,G.useState)(),se=r()(ve,2),oe=se[0],ce=se[1],Pe=(0,G.useState)(!1),pe=r()(Pe,2),he=pe[0],ie=pe[1];(0,G.useEffect)(function(){j&&(z(a||""),n.setFieldsValue({name:l,description:p}))},[j,a,l,p]);var Ae=function(k,A){A===T.AQ.CODE?C.history.push("/space/".concat(m,"/plugin/").concat(k,"/cloud-tool")):A===T.AQ.HTTP&&C.history.push("/space/".concat(m,"/plugin/").concat(k))},me=(0,C.useRequest)(O.VR,{manual:!0,debounceInterval:300,onSuccess:function(k,A){z(""),w();var le=A[0].type;Ae(k,le),N.ZP.success("\u63D2\u4EF6\u5DF2\u521B\u5EFA"),ie(!1)},onError:function(){ie(!1)}}),Ce=me.run,ge=(0,C.useRequest)(O.i,{manual:!0,debounceInterval:300,onSuccess:function(k,A){z("");var le=A[0];u?.(le),N.ZP.success("\u63D2\u4EF6\u66F4\u65B0\u6210\u529F"),ie(!1)},onError:function(){ie(!1)}}),De=ge.run,_e=function(k){ie(!0),_===$.jA.Create?Ce(t()(t()({},k),{},{icon:D,spaceId:m})):De(t()(t()({},k),{},{icon:D,id:s}))},J=function(){n.submit()},be=function(k){var A=k.target.value;A===T.AQ.HTTP&&n.setFieldValue("codeLang",null),ce(A)};return(0,R.jsx)(U.Z,{form:n,title:_===$.jA.Create?"\u65B0\u5EFA\u63D2\u4EF6":"\u66F4\u65B0\u63D2\u4EF6",open:j,classNames:K(),loading:he,onCancel:w,onConfirm:J,children:(0,R.jsxs)("div",{className:g("flex","flex-col","items-center","py-16"),children:[(0,R.jsx)(S.Z,{className:g("mt-16","mb-16"),onUploadSuccess:z,imageUrl:D,defaultImage:h}),(0,R.jsxs)(i.Z,{form:n,requiredMark:x.N,layout:"vertical",onFinish:_e,rootClassName:g("w-full"),autoComplete:"off",children:[(0,R.jsx)(i.Z.Item,{name:"name",label:"\u63D2\u4EF6\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u540D\u79F0"},{validator:function(k,A){return!A||A?.length<=30?Promise.resolve():A?.length>30?Promise.reject(new Error("\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC730\u4E2A\u5B57\u7B26!")):Promise.reject(new Error("\u8BF7\u8F93\u5165\u63D2\u4EF6\u540D\u79F0!"))}}],children:(0,R.jsx)(d.Z,{placeholder:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u540D\u79F0\uFF0C\u786E\u4FDD\u540D\u79F0\u542B\u4E49\u6E05\u6670\u4E14\u7B26\u5408\u5E73\u53F0\u89C4\u8303",showCount:!0,maxLength:30})}),(0,R.jsx)(I.Z,{name:"description",label:"\u63D2\u4EF6\u63CF\u8FF0",initialValue:p,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u7684\u4E3B\u8981\u529F\u80FD\u548C\u4F7F\u7528\u573A\u666F"}],placeholder:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u7684\u4E3B\u8981\u529F\u80FD\u548C\u4F7F\u7528\u573A\u666F\uFF0C\u786E\u4FDD\u5185\u5BB9\u7B26\u5408\u5E73\u53F0\u89C4\u8303\u3002\u5E2E\u52A9\u7528\u6237/\u5927\u6A21\u578B\u66F4\u597D\u5730\u7406\u89E3",maxLength:100}),(0,R.jsxs)(P.Z,{condition:_===$.jA.Create,children:[(0,R.jsx)(i.Z.Item,{name:"type",label:"\u63D2\u4EF6\u5DE5\u5177\u521B\u5EFA\u65B9\u5F0F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u63D2\u4EF6\u5DE5\u5177\u521B\u5EFA\u65B9\u5F0F"}],children:(0,R.jsx)(V.ZP.Group,{options:L.B1,value:oe,onChange:be})}),(0,R.jsx)(P.Z,{condition:oe===T.AQ.CODE,children:(0,R.jsx)(i.Z.Item,{name:"codeLang",label:"IDE \u8FD0\u884C\u65F6",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u63D2\u4EF6\u6A21\u5F0F"}],children:(0,R.jsx)(c.Z,{options:L._n})})})]})]})]})})};W.Z=de},64345:function(ae,W,e){e.d(W,{Z:function(){return O}});var M=e(71437),t=e(95141),B=e(45605),r=e(94184),h=e.n(r),P=e(67294),I={"label-wrapper":"label-wrapper___o8I1N"},c=e(85893),S=h().bind(I),L=function(T){var x=T.className,i=T.label,N=T.title,d=T.type,V=d===void 0?t.Ai.Blank:d;return(0,c.jsxs)("div",{className:S(I["label-wrapper"],"flex","items-center",x),children:[(0,c.jsx)("span",{children:i}),(0,c.jsx)(M.Z,{title:N,icon:(0,c.jsx)(B.Z,{}),type:V})]})},O=L},70852:function(ae,W,e){e.d(W,{Z:function(){return S}});var M=e(50888),t=e(94184),B=e.n(t),r=e(67294),h={container:"container___VkdMQ"},P=e(85893),I=B().bind(h),c=function(O){var $=O.className;return(0,P.jsxs)("div",{className:I("flex","flex-1","items-center","content-center",h.container,$),children:[(0,P.jsx)(M.Z,{}),(0,P.jsx)("span",{children:"\u52A0\u8F7D\u4E2D..."})]})},S=c},97630:function(ae,W,e){e.d(W,{Z:function(){return b}});var M=e(9783),t=e.n(M),B=e(19632),r=e.n(B),h=e(97857),P=e.n(h),I=e(5574),c=e.n(I),S=e(4141),L=e(64345),O=e(61474),$=e(90254),T=e(43186),x=e(92135),i=e(91120),N=e(95141),d=e(30881),V=e(1322),H=e(80882),K=e(99859),G=e(45360),C=e(84567),U=e(25278),R=e(79368),g=e(94184),de=e.n(g),Z=e(67294),o=e(39902),m=e(88773),s={"modal-content":"modal-content____os3U","modal-header":"modal-header___Oz0DB","modal-body":"modal-body___X8pJV","input-textarea":"input-textarea___XDb1O",select:"select___W_1UF","table-wrap":"table-wrap___wLfVM","label-normal":"label-normal___pz7II","font-12":"font-12___gy3WH","down-outlined":"down-outlined___x8ZCt","ml-8":"ml-8___sqmBJ","table-copy":"table-copy___wfPST","text-center":"text-center___RjgmM"},a=e(85893),l=de().bind(s),p=function(j){var w=j.mode,u=w===void 0?i.qR.Agent:w,y=j.spaceId,Q=j.category,n=j.targetId,Y=j.open,ee=j.onlyShowTemplate,D=ee===void 0?!0:ee,z=j.onCancel,ve=j.onConfirm,se=K.Z.useForm(),oe=c()(se,1),ce=oe[0],Pe=(0,Z.useState)(""),pe=c()(Pe,2),he=pe[0],ie=pe[1],Ae=(0,Z.useState)([]),me=c()(Ae,2),Ce=me[0],ge=me[1],De=(0,Z.useState)([]),_e=c()(De,2),J=_e[0],be=_e[1],ue=(0,Z.useState)([]),k=c()(ue,2),A=k[0],le=k[1],xe=(0,Z.useState)([d.HD.Space]),je=c()(xe,2),Le=je[0],Fe=je[1],Ue=(0,Z.useState)([]),Me=c()(Ue,2),fe=Me[0],Ne=Me[1],Te=(0,o.useModel)("squareModel"),Re=Te.agentInfoList,Ie=Te.pluginInfoList,te=Te.workflowInfoList,re=(0,$.Z)(),ye=re.runQueryCategory,Ee=(0,o.useRequest)(x.ui,{manual:!0,debounceWait:300}),$e=Ee.run,Se=Ee.data;(0,Z.useEffect)(function(){var F,E=(Se==null||(F=Se.filter(function(v){return v.spaceRole!==N.g8.User}))===null||F===void 0||(F=F.filter(function(v){return v.id===y||v.id!==y&&v.receivePublish===V.IP.Receive}))===null||F===void 0?void 0:F.map(function(v){return{key:(0,m.Z)(),name:v.name,scope:d.HD.Space,spaceId:v.id}}))||[],f=[{key:d.HD.Tenant,name:"\u7CFB\u7EDF\u5E7F\u573A",scope:d.HD.Tenant},{key:d.HD.Space,name:"\u7A7A\u95F4",scope:d.HD.Space,children:E}];be(f)},[Se]),(0,Z.useEffect)(function(){if(fe!=null&&fe.length){var F=fe.map(function(E){return{allowCopy:E.allowCopy,onlyTemplate:E.onlyTemplate,scope:E.scope,spaceId:E.spaceId}});fe.some(function(E){return E.spaceId===y})||F.push({allowCopy:i.fC.No,onlyTemplate:i.Qc.No,scope:d.HD.Space,spaceId:y}),le(F)}else le([{allowCopy:i.fC.No,onlyTemplate:i.Qc.No,scope:d.HD.Space,spaceId:y}])},[fe,y]);var He=(0,o.useRequest)(T.hm,{manual:!0,debounceInterval:300,onSuccess:function(E){Ne(E)}}),Ge=He.run;(0,Z.useEffect)(function(){Y&&(ye(),$e(),Ge({targetId:n,targetType:u}))},[Y]),(0,Z.useEffect)(function(){var F,E=[];switch(u){case i.qR.Agent:E=Re,ie("\u667A\u80FD\u4F53");break;case i.qR.Plugin:E=Ie,ie("\u63D2\u4EF6");break;case i.qR.Workflow:E=te,ie("\u5DE5\u4F5C\u6D41");break}var f=(F=E)===null||F===void 0?void 0:F.map(function(q){return{label:q.description,value:q.name}});if(ge(f),f?.length>0){var v=Q||f[0].value;ce.setFieldValue("category",v)}},[u,Q,Re,Ie,te]);var We=(0,o.useRequest)(T.$G,{manual:!0,debounceInterval:300,onSuccess:function(E){G.ZP.success(E||"\u53D1\u5E03\u7533\u8BF7\u5DF2\u63D0\u4EA4\uFF0C\u7B49\u5F85\u5BA1\u6838\u4E2D"),ve()}}),Qe=We.run,Ve=We.loading,Ye=function(E){Qe(P()(P()({},E),{},{targetType:u,targetId:n,items:A}))},ze=function(){ce.submit()},Oe=function(E,f){return A?.find(function(v){return E===d.HD.Tenant?v.scope===E:v.scope===E&&v.spaceId===f})},ke=function(E,f){return!!Oe(E,f)},Xe=function(E,f){var v=Oe(E,f);if(E===d.HD.Tenant)return!v;var q=A?.find(function(X){return X.scope===d.HD.Tenant});return q?.allowCopy===i.fC.Yes?v?v?.allowCopy===i.fC.Yes:!0:!v},Ke=function(E,f){var v=Oe(E,f);return v?.allowCopy===i.fC.Yes},Je=function(E,f){var v=Oe(E,f);return v?.onlyTemplate===i.Qc.Yes},qe=function(E,f){var v=E.scope,q=E.spaceId;if(f){var X=Oe(d.HD.Tenant),ne=X?.allowCopy===i.fC.Yes?i.fC.Yes:i.fC.No;le([].concat(r()(A),[{scope:v,spaceId:q,allowCopy:ne,onlyTemplate:i.Qc.No}]))}else{var we;v===d.HD.Tenant?we=A.filter(function(Be){return Be.scope!==v}):we=A.filter(function(Be){return Be.spaceId!==q}),le(we)}},en=function(E,f){var v=E.scope,q=E.spaceId,X;v===d.HD.Tenant?X=A?.map(function(ne){return ne.scope===v?P()(P()({},ne),{},{allowCopy:f?i.fC.Yes:i.fC.No,onlyTemplate:i.Qc.No}):f?P()(P()({},ne),{},{allowCopy:i.fC.Yes}):ne}):X=A?.map(function(ne){return ne.spaceId===q?P()(P()({},ne),{},{allowCopy:f?i.fC.Yes:i.fC.No,onlyTemplate:i.Qc.No}):ne}),le(X)},nn=function(E,f){var v=E.scope,q=E.spaceId,X=A?.map(function(ne){return ne.scope===v&&(v===d.HD.Tenant||ne.spaceId===q)?P()(P()({},ne),{},{onlyTemplate:f?i.Qc.Yes:i.Qc.No}):ne});le(X)},tn=function(){Fe(function(E){return E.includes(d.HD.Space)?[]:[d.HD.Space]})},Ze=[{title:(0,a.jsx)(L.Z,{className:l(s["label-normal"]),label:"\u53D1\u5E03\u7A7A\u95F4",title:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"1. \u7CFB\u7EDF\u5E7F\u573A\uFF1A\u667A\u80FD\u4F53\u5C06\u51FA\u73B0\u5728\u7CFB\u7EDF\u5E7F\u573A\u4E2D\u3002"}),(0,a.jsx)("p",{children:"2. \u7A7A\u95F4\u5E7F\u573A\uFF1A\u667A\u80FD\u4F53\u5C06\u51FA\u73B0\u5728\u9009\u62E9\u7684\u7A7A\u95F4\u5E7F\u573A\u4E2D\u3002"})]}),type:N.Ai.White}),dataIndex:"name",render:function(E,f){var v;return f!=null&&(v=f.children)!==null&&v!==void 0&&v.length?(0,a.jsxs)("div",{onClick:tn,className:"cursor-pointer",children:[(0,a.jsx)(H.Z,{className:l(s["font-12"],t()({},s["down-outlined"],!Le.includes(d.HD.Space)))}),(0,a.jsx)("span",{className:l(s["ml-8"]),children:f.name})]}):(0,a.jsx)(C.Z,{checked:ke(f.scope,f.spaceId),disabled:f?.spaceId===y,onChange:function(X){return qe(f,X.target.checked)},children:(0,a.jsx)("div",{className:"text-ellipsis",style:{width:"148px"},children:f.name})})}},{title:(0,a.jsx)(L.Z,{className:l(s["label-normal"]),label:"\u5141\u8BB8\u590D\u5236\uFF08\u6A21\u677F\uFF09",title:(0,a.jsx)("p",{children:"\u9009\u4E2D\u540E\u5C06\u51FA\u73B0\u5728\u5E7F\u573A\u6A21\u7248\u4E2D\uFF0C\u7528\u6237\u53EF\u76F4\u63A5\u590D\u5236\u5230\u81EA\u5DF1\u7684\u5DE5\u4F5C\u7A7A\u95F4\u4E2D\u53BB\u3002\u590D\u5236\u53EF\u9009\u7684\u524D\u63D0\u662F\u53D1\u5E03\u5DF2\u9009\u3002"}),type:N.Ai.White}),dataIndex:"allowCopy",width:180,render:function(E,f){var v;return f!=null&&(v=f.children)!==null&&v!==void 0&&v.length?null:(0,a.jsx)(C.Z,{className:l(s["table-copy"]),checked:Ke(f.scope,f.spaceId),disabled:Xe(f.scope,f.spaceId),onChange:function(X){return en(f,X.target.checked)}})}},{title:(0,a.jsx)(L.Z,{className:l(s["label-normal"]),label:"\u4EC5\u6A21\u677F",title:"\u9009\u62E9\u540E\u4EC5\u5728\u6A21\u677F\u5E7F\u573A\u5C55\u793A\uFF0C\u4EC5\u6A21\u677F\u53EA\u6709\u5728\u5141\u8BB8\u590D\u5236\u9009\u62E9\u540E\u624D\u53EF\u9009",type:N.Ai.White}),dataIndex:"onlyTemplate",width:100,render:function(E,f){var v;return f!=null&&(v=f.children)!==null&&v!==void 0&&v.length?null:(0,a.jsx)("div",{className:l(s["text-center"]),children:(0,a.jsx)(C.Z,{checked:Je(f.scope,f.spaceId),disabled:!Ke(f.scope,f.spaceId),onChange:function(X){return nn(f,X.target.checked)}})})}}],rn=D?Ze:Ze.slice(0,1);return(0,a.jsx)(S.Z,{form:ce,classNames:{content:s["modal-content"],header:s["modal-header"],body:s["modal-body"]},loading:Ve,title:"\u53D1\u5E03".concat(he),centered:!0,open:Y,onConfirm:ze,onCancel:z,children:(0,a.jsxs)(K.Z,{form:ce,layout:"vertical",onFinish:Ye,children:[(0,a.jsx)(K.Z.Item,{name:"remark",label:"\u53D1\u5E03\u8BB0\u5F55",children:(0,a.jsx)(U.Z.TextArea,{rootClassName:l(s["input-textarea"],"dispose-textarea-count"),placeholder:"\u8FD9\u91CC\u586B\u5199\u8BE6\u7EC6\u7684\u53D1\u5E03\u8BB0\u5F55",autoSize:{minRows:5,maxRows:8},maxLength:200,showCount:!0})}),(0,a.jsx)(K.Z.Item,{name:"category",label:"\u5206\u7C7B\u9009\u62E9",children:(0,a.jsx)(O.Z,{className:s.select,options:Ce})}),(0,a.jsx)(K.Z.Item,{label:"\u9009\u62E9\u53D1\u5E03\u8303\u56F4",children:(0,a.jsx)(R.Z,{className:l(s["table-wrap"]),columns:rn,dataSource:J,pagination:!1,expandable:{childrenColumnName:"children",defaultExpandAllRows:!0,expandedRowKeys:Le,expandIcon:function(){return null}}})})]})})},b=p},57882:function(ae,W,e){e.d(W,{Z:function(){return O}});var M=e(9783),t=e.n(M),B=e(97937),r=e(94184),h=e.n(r),P=e(67294),I={container:"container___ZmQyk",hidden:"hidden___sQc7Y",header:"header___NPVhj",close:"close___T88xb","divider-horizontal":"divider-horizontal___Lmz1p"},c=e(85893),S=h().bind(I),L=function(T){var x=T.className,i=T.title,N=T.visible,d=T.onClose,V=T.children;return(0,c.jsxs)("div",{className:S("flex","flex-col","overflow-y",I.container,x,t()({},I.hidden,!N)),children:[(0,c.jsxs)("div",{className:S(I.header,"flex","items-center","content-between"),children:[(0,c.jsx)("h3",{children:i}),(0,c.jsx)(B.Z,{className:S(I.close,"cursor-pointer"),onClick:d})]}),(0,c.jsx)("div",{className:S(I["divider-horizontal"])}),(0,c.jsx)("div",{className:"flex-1 overflow-y",children:V})]})},O=L},72568:function(ae,W,e){e.d(W,{Z:function(){return y}});var M=e(97857),t=e.n(M),B=e(5574),r=e.n(B),h=e(57882),P=e(89299),I=e(99171),c=e(43186),S=e(1444),L=e(91120),O=e(95141),$=e(21640),T=e(45360),x=e(85576),i=e(32983),N=e(95012),d=e(94184),V=e.n(d),H=e(67294),K=e(39902),G=e(75216),C=e(70852),U=e(9783),R=e.n(U),g=e(30381),de=e.n(g),Z={container:"container___YEnC0","p-info":"p-info___ngWA2","p-name":"p-name___B1WDf","p-time":"p-time___s518D",btn:"btn___U_H2c","off-btn":"off-btn____lpPp","disabled-btn":"disabled-btn___bofq0"},o=e(85893),m=V().bind(Z),s=function(n){var Y,ee,D=n.info,z=n.onOffShelf;return(0,o.jsxs)("div",{className:m("flex","items-center",Z.container),children:[(0,o.jsxs)("div",{className:m("flex","flex-col","flex-1","overflow-hide",Z["p-info"]),children:[(0,o.jsx)("span",{className:m(Z["p-name"],"text-ellipsis"),children:D?.description}),(0,o.jsx)("span",{className:m(Z["p-time"],"text-ellipsis"),children:"".concat((D==null||(Y=D.publishUser)===null||Y===void 0?void 0:Y.nickName)||(D==null||(ee=D.publishUser)===null||ee===void 0?void 0:ee.userName),"\u53D1\u5E03\u4E8E").concat(de()(D?.publishDate).format("YYYY-MM-DD HH:mm"))})]}),(0,o.jsx)("div",{className:m("flex","items-center","content-center","radius-6","cursor-pointer",Z.btn,R()({},Z["disabled-btn"],D?.publishStatus!==O.xH.Published),R()({},Z["off-btn"],D?.publishStatus===O.xH.Published)),onClick:z,children:"".concat(D?.publishStatus===O.xH.Published?"\u4E0B\u67B6":D?.publishStatus===O.xH.Applying?"\u5BA1\u6838\u4E2D":"\u5DF2\u4E0B\u67B6")})]})},a=s,l={"main-wrap":"main-wrap___T75Vs",title:"title___t_LaB","drawer-body":"drawer-body___HO7rG"},p={container:"container___mV4sm",header:"header___Xyxou",name:"name___a7L2w","author-update-time":"author-update-time___lFZ7X",desc:"desc___F6dcW"},b=V().bind(p),_=function(n){var Y,ee,D=n.info,z=n.renderActions;return(0,o.jsxs)("div",{className:b(p.container,"flex","flex-col","py-6"),children:[(0,o.jsxs)("div",{className:b("flex","items-center",p.header),children:[(0,o.jsx)("span",{className:b(p.name,"text-ellipsis"),children:((Y=D.opUser)===null||Y===void 0?void 0:Y.nickName)||((ee=D.opUser)===null||ee===void 0?void 0:ee.userName)}),(0,o.jsx)("span",{className:b(p["author-update-time"]),children:de()(D.created).format("YYYY-MM-DD HH:mm")})]}),(0,o.jsx)(G.Z,{condition:D.description,children:(0,o.jsx)("p",{className:b("text-ellipsis-2",p.desc),children:D.description})}),z(D)]},D.id)},j=_,w=V().bind(l),u=function(n){var Y=n.targetId,ee=n.targetName,D=n.targetType,z=D===void 0?L.qR.Agent:D,ve=n.permissions,se=ve===void 0?[]:ve,oe=n.visible,ce=n.isDrawer,Pe=ce===void 0?!1:ce,pe=n.onClose,he=n.renderActions,ie=he===void 0?function(){return null}:he,Ae=(0,H.useState)(!1),me=r()(Ae,2),Ce=me[0],ge=me[1],De=(0,H.useState)([]),_e=r()(De,2),J=_e[0],be=_e[1],ue=(0,H.useState)([]),k=r()(ue,2),A=k[0],le=k[1],xe=z===L.qR.Agent?"\u667A\u80FD\u4F53":z===L.qR.Plugin?"\u63D2\u4EF6":"\u5DE5\u4F5C\u6D41",je=z===L.qR.Agent?P.qR:z===L.qR.Plugin?I.Pj:S.Lf,Le=(0,K.useRequest)(je,{manual:!0,debounceInterval:300,onSuccess:function(re){le(re),ge(!1)}}),Fe=Le.run,Ue=(0,K.useRequest)(c.hm,{manual:!0,debounceInterval:300,onSuccess:function(re){be(re)}}),Me=Ue.run,fe=function(re){var ye=J?.map(function(Ee){return Ee.publishId===re?t()(t()({},Ee),{},{publishStatus:null}):Ee})||[];be(ye)},Ne=(0,K.useRequest)(c.JX,{manual:!0,debounceInterval:300,onSuccess:function(re,ye){T.ZP.success("\u5DF2\u6210\u529F\u4E0B\u67B6"),fe(ye[0].publishId)}}),Te=Ne.run;(0,H.useEffect)(function(){oe&&(ge(!0),Fe(Y))},[Y,oe]),(0,H.useEffect)(function(){oe&&se!==null&&se!==void 0&&se.includes(O.jE.Publish)&&Me({targetId:Y,targetType:z})},[oe,Y,z,se]);var Re=function(re){re?.publishStatus===O.xH.Published&&x.Z.confirm({title:"\u60A8\u786E\u5B9A\u8981\u4E0B\u67B6\u6B64".concat(xe,"\u5417?"),icon:(0,o.jsx)($.Z,{}),content:ee,okText:"\u786E\u5B9A",maskClosable:!0,cancelText:"\u53D6\u6D88",onOk:function(){Te({targetType:z,targetId:Y,publishId:re.publishId})}})},Ie=Ce?(0,o.jsx)(C.Z,{className:"h-full"}):J!=null&&J.length||A!=null&&A.length?(0,o.jsxs)("div",{className:w(l["main-wrap"]),children:[(0,o.jsxs)(G.Z,{condition:se?.includes(O.jE.Publish)&&J?.length,children:[(0,o.jsx)("h5",{className:w(l.title),children:"\u5F53\u524D\u53D1\u5E03"}),J?.map(function(te){return(0,o.jsx)(a,{info:te,onOffShelf:function(){return Re(te)}},te.publishId)})]}),(0,o.jsx)("h5",{className:w(l.title),children:"\u7F16\u6392\u4E0E\u53D1\u5E03\u8BB0\u5F55"}),A?.map(function(te){return(0,o.jsx)(j,{info:te,renderActions:ie},te.id)})]}):(0,o.jsx)("div",{className:w("flex","h-full","items-center","content-center"),children:(0,o.jsx)(i.Z,{description:"\u6682\u65E0\u5386\u53F2\u8BB0\u5F55"})});return Pe?(0,o.jsx)(N.Z,{classNames:{body:w(l["drawer-body"])},closable:!0,title:"\u7248\u672C\u5386\u53F2",placement:"right",open:oe,onClose:pe,children:Ie}):(0,o.jsx)(h.Z,{title:"\u7248\u672C\u5386\u53F2",visible:oe,onClose:pe,children:Ie})},y=u},11843:function(ae,W,e){e.d(W,{$$:function(){return $},Bv:function(){return L},E9:function(){return O},RT:function(){return x},TI:function(){return d},a$:function(){return N},gN:function(){return V},k0:function(){return I},oR:function(){return H},v3:function(){return S},yA:function(){return c}});var M=e(32909),t=e(91120),B=e(95141),r=e(1322),h=e(57822),P=e(85893),I=[{value:r.Lm.Workflow,label:"\u5DE5\u4F5C\u6D41",icon:(0,P.jsx)(M.xp,{})},{value:r.Lm.Plugin,label:"\u63D2\u4EF6",icon:(0,P.jsx)(M.P1,{})},{value:r.Lm.Knowledge,label:"\u77E5\u8BC6\u5E93",icon:(0,P.jsx)(M.r7,{})},{value:r.Lm.Table,label:"\u6570\u636E\u8868",icon:(0,P.jsx)(M.ct,{})},{value:r.Lm.Model,label:"\u6A21\u578B",icon:(0,P.jsx)(M.ky,{})}],c=[{value:r.Lm.All_Type,label:"\u6240\u6709\u7C7B\u578B",icon:null}].concat(I),S=[{value:r.No.All,label:"\u5168\u90E8"},{value:r.No.Published,label:"\u5DF2\u53D1\u5E03"}],L=[{value:r.os.All_Person,label:"\u6240\u6709\u4EBA"},{value:r.os.Me,label:"\u7531\u6211\u521B\u5EFA"}],O=[{type:r.KZ.Analyze,label:"\u5206\u6790"},{type:r.KZ.Copy_To_Space,label:"\u590D\u5236\u5230\u7A7A\u95F4"},{type:r.KZ.Move,label:"\u8FC1\u79FB"},{type:r.KZ.Temporary_Session,label:"\u4E34\u65F6\u4F1A\u8BDD"},{type:r.KZ.API_Key,label:"API Key"},{type:r.KZ.Log,label:"\u65E5\u5FD7"},{type:r.KZ.Del,label:"\u5220\u9664",isDel:!0}],$=[{type:r.z$.Application_Develop,icon:(0,P.jsx)(M.iG,{}),text:"\u667A\u80FD\u4F53\u5F00\u53D1"},{type:r.z$.Component_Library,icon:(0,P.jsx)(M.f0,{}),text:"\u7EC4\u4EF6\u5E93"},{type:r.z$.MCP_Manage,icon:(0,P.jsx)(M.G,{}),text:"MCP\u7BA1\u7406"},{type:r.z$.Space_Square,icon:(0,P.jsx)(M.g2,{}),text:"\u7A7A\u95F4\u5E7F\u573A"},{type:r.z$.Team_Setting,icon:(0,P.jsx)(M.UZ,{}),text:"\u6210\u5458\u4E0E\u8BBE\u7F6E"}],T=[{label:"\u6807\u51C6\u521B\u5EFA",value:B.wG.Standard},{label:"AI \u521B\u5EFA",value:B.wG.AI}],x=[{label:"\u5F00\u542F",value:r.nb.Open},{label:"\u5173\u95ED",value:r.nb.Close}],i=[{value:t.Sj.PLUGIN,label:"\u63D2\u4EF6"},{value:t.Sj.WORKFLOW,label:"\u5DE5\u4F5C\u6D41"}],N=[{type:r.wQ.Params,label:"\u53C2\u6570"},{type:r.wQ.Method_Call,label:"\u8C03\u7528\u65B9\u5F0F"},{type:r.wQ.Output_Way,label:"\u8F93\u51FA\u65B9\u5F0F"},{type:r.wQ.Async_Run,label:"\u5F02\u6B65\u8FD0\u884C"},{type:r.wQ.Exception_Handling,label:"\u5F02\u5E38\u5904\u7406"},{type:r.wQ.Card_Bind,label:"\u5361\u7247\u7ED1\u5B9A"}],d={name:"",description:"",dataType:B.Gi.String,inputType:t.oI.Query,require:!0,bindValue:"",enable:!0},V={name:"",description:"",dataType:B.Gi.String,enable:!0},H=[{key:h.Q.Agent,label:"\u667A\u80FD\u4F53"},{key:h.Q.Plugin,label:"\u63D2\u4EF6"},{key:h.Q.Workflow,label:"\u5DE5\u4F5C\u6D41"},{key:h.Q.Template,label:"\u6A21\u677F"}]},90254:function(ae,W,e){var M=e(33049),t=e(57822),B=e(39902),r=function(){var P=(0,B.useModel)("squareModel"),I=P.setAgentInfoList,c=P.setPluginInfoList,S=P.setWorkflowInfoList,L=P.setTemplateList,O=function(i){var N=[],d=[],V=[],H=[];i?.forEach(function(K){var G,C=K==null||(G=K.children)===null||G===void 0?void 0:G.map(function(U){return{name:U.key,description:U.label}});K.type===t.Q.Agent&&(N=C),K.type===t.Q.Plugin&&(d=C),K.type===t.Q.Workflow&&(V=C),K.type===t.Q.Template&&(H=C)}),I(N),c(d),S(V),L(H)},$=(0,B.useRequest)(M.Nb,{manual:!0,debounceInterval:300,onSuccess:function(i){O(i)}}),T=$.run;return{runQueryCategory:T}};W.Z=r},43186:function(ae,W,e){e.d(W,{$G:function(){return $},JX:function(){return c},hm:function(){return L},wR:function(){return P}});var M=e(15009),t=e.n(M),B=e(99289),r=e.n(B),h=e(39902);function P(x){return I.apply(this,arguments)}function I(){return I=r()(t()().mark(function x(i){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/publish/template/copy",{method:"POST",data:i}));case 1:case"end":return d.stop()}},x)})),I.apply(this,arguments)}function c(x){return S.apply(this,arguments)}function S(){return S=r()(t()().mark(function x(i){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/publish/offShelf",{method:"POST",data:i}));case 1:case"end":return d.stop()}},x)})),S.apply(this,arguments)}function L(x){return O.apply(this,arguments)}function O(){return O=r()(t()().mark(function x(i){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/publish/item/list",{method:"POST",data:i}));case 1:case"end":return d.stop()}},x)})),O.apply(this,arguments)}function $(x){return T.apply(this,arguments)}function T(){return T=r()(t()().mark(function x(i){return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,h.request)("/api/publish/apply",{method:"POST",data:i}));case 1:case"end":return d.stop()}},x)})),T.apply(this,arguments)}},33049:function(ae,W,e){e.d(W,{CA:function(){return V},M3:function(){return K},Nb:function(){return x},VH:function(){return P},Wo:function(){return N},_U:function(){return $},pH:function(){return c}});var M=e(15009),t=e.n(M),B=e(99289),r=e.n(B),h=e(39902);function P(C){return I.apply(this,arguments)}function I(){return I=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/plugin/list",{method:"POST",data:U}));case 1:case"end":return g.stop()}},C)})),I.apply(this,arguments)}function c(C){return S.apply(this,arguments)}function S(){return S=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/workflow/list",{method:"POST",data:U}));case 1:case"end":return g.stop()}},C)})),S.apply(this,arguments)}function L(C){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime().mark(function C(U){return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",request("/api/published/knowledge/list",{method:"POST",data:U}));case 1:case"end":return g.stop()}},C)})),O.apply(this,arguments)}function $(C){return T.apply(this,arguments)}function T(){return T=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/agent/list",{method:"POST",data:U}));case 1:case"end":return g.stop()}},C)})),T.apply(this,arguments)}function x(){return i.apply(this,arguments)}function i(){return i=r()(t()().mark(function C(){return t()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,h.request)("/api/published/category/list",{method:"GET"}));case 1:case"end":return R.stop()}},C)})),i.apply(this,arguments)}function N(C){return d.apply(this,arguments)}function d(){return d=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/workflow/collect/".concat(U),{method:"POST"}));case 1:case"end":return g.stop()}},C)})),d.apply(this,arguments)}function V(C){return H.apply(this,arguments)}function H(){return H=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/workflow/unCollect/".concat(U),{method:"POST"}));case 1:case"end":return g.stop()}},C)})),H.apply(this,arguments)}function K(C){return G.apply(this,arguments)}function G(){return G=r()(t()().mark(function C(U){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,h.request)("/api/published/template/list",{method:"POST",data:U}));case 1:case"end":return g.stop()}},C)})),G.apply(this,arguments)}},1444:function(ae,W,e){e.d(W,{Lf:function(){return b}});var M=e(15009),t=e.n(M),B=e(99289),r=e.n(B),h=e(39902);function P(u){return I.apply(this,arguments)}function I(){return I=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),I.apply(this,arguments)}function c(u){return S.apply(this,arguments)}function S(){return S=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/update",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),S.apply(this,arguments)}function L(u){return O.apply(this,arguments)}function O(){return O=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/publish",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),O.apply(this,arguments)}function $(u){return T.apply(this,arguments)}function T(){return T=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/list/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),T.apply(this,arguments)}function x(u){return i.apply(this,arguments)}function i(){return i=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/add",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),i.apply(this,arguments)}function N(u){return d.apply(this,arguments)}function d(){return d=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/copy/".concat(y),{method:"POST"}));case 1:case"end":return n.stop()}},u)})),d.apply(this,arguments)}function V(u){return H.apply(this,arguments)}function H(){return H=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/delete/".concat(y),{method:"POST"}));case 1:case"end":return n.stop()}},u)})),H.apply(this,arguments)}function K(u){return G.apply(this,arguments)}function G(){return G=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/".concat(y.sourceId,"/nextIds/update"),{method:"POST",data:y.nodeId}));case 1:case"end":return n.stop()}},u)})),G.apply(this,arguments)}function C(u){return U.apply(this,arguments)}function U(){return U=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/model/list",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),U.apply(this,arguments)}function R(u){return g.apply(this,arguments)}function g(){return g=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/model/list",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),g.apply(this,arguments)}function de(u){return Z.apply(this,arguments)}function Z(){return Z=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/previous/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),Z.apply(this,arguments)}function o(u){return m.apply(this,arguments)}function m(){return m=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/node/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function s(u){return a.apply(this,arguments)}function a(){return a=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/test/node/execute",{method:"POST",data:y}));case 1:case"end":return n.stop()}},u)})),a.apply(this,arguments)}function l(u){return p.apply(this,arguments)}function p(){return p=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/valid/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function b(u){return _.apply(this,arguments)}function _(){return _=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/config/history/list/".concat(y),{method:"GET"}));case 1:case"end":return n.stop()}},u)})),_.apply(this,arguments)}function j(u){return w.apply(this,arguments)}function w(){return w=r()(t()().mark(function u(y){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,h.request)("/api/workflow/restore/".concat(y),{method:"POST"}));case 1:case"end":return n.stop()}},u)})),w.apply(this,arguments)}W.ZP={apiDeleteNode:V,apiCopyNode:N,apiAddEdge:K,getDetails:P,apiAddNode:x,updateDetails:c,getNodeList:$,getModelList:R,getModelListByWorkflowId:C,getOutputArgs:de,getNodeConfig:o,executeNode:s,publishWorkflow:L,validWorkflow:l,apiRestoreWorkflowVersion:j}},57822:function(ae,W,e){e.d(W,{Q:function(){return M}});var M=function(t){return t.Agent="Agent",t.Plugin="Plugin",t.Workflow="Workflow",t.Knowledge="Knowledge",t.Template="Template",t}({})},3622:function(ae,W,e){e.d(W,{A4:function(){return i},DY:function(){return g},IK:function(){return d},Lg:function(){return C},T6:function(){return Z},YY:function(){return x},k$:function(){return R},kS:function(){return N},mG:function(){return G},y7:function(){return U}});var M=e(9783),t=e.n(M),B=e(64599),r=e.n(B),h=e(19632),P=e.n(h),I=e(97857),c=e.n(I),S=e(11843),L=e(95141),O=e(57557),$=e.n(O),T=e(88773),x=function o(m,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!Array.isArray(m))return-1;for(var l=0;l<m.length;l++){var p=m[l];if(p.key===s)return a;if(p.subArgs){var b=o(p.subArgs,s,a+1);if(b!==-1)return b}}return-1},i=function(m,s,a){var l=function p(b){return b.map(function(_){return _.key===s?c()(c()({},_),{},{subArgs:[].concat(P()(_.subArgs||[]),[a])}):_.subArgs?c()(c()({},_),{},{subArgs:p(_.subArgs)}):_})};return l(m)||[]},N=function(m){if(!m)return[];var s=[],a=function l(p){var b=r()(p),_;try{for(b.s();!(_=b.n()).done;){var j=_.value;j.subArgs&&(s.push(j.key),l(j.subArgs))}}catch(w){b.e(w)}finally{b.f()}};return a(m),s},d=function(m,s){var a=function l(p){return p.filter(function(b){return b.key===s?!1:(b.subArgs&&(b.subArgs=l(b.subArgs)),!0)})};return a(m)||[]},V=function o(m,s,a){s?.forEach(function(l){var p;l[m]=a,(p=l.subArgs)!==null&&p!==void 0&&p.length&&o(m,l.subArgs,a)})},H=function o(m,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],l=r()(m),p;try{for(l.s();!(p=l.n()).done;){var b=p.value;if(b.key===s)return a;if(b.subArgs&&b.subArgs.length>0){a.push(b.key);var _=o(b.subArgs,s,a);if(_)return _;a.pop()}}}catch(j){l.e(j)}finally{l.f()}return null},K=function o(m,s,a){s.forEach(function(l){var p;a.includes(l.key)&&(l[m]=!0),l!=null&&(p=l.subArgs)!==null&&p!==void 0&&p.length&&o(m,l.subArgs,a)})},G=function(m,s,a,l){var p=[],b=function j(w){return w.map(function(u){if(u.key===s){if(a==="dataType")if(([L.Gi.Object,L.Gi.Array_Object].includes(l)||l.toString().includes("Array"))&&(u.bindValue=""),[L.Gi.Object,L.Gi.Array_Object].includes(l)){var y=c()({key:(0,T.Z)()},S.TI);u.subArgs=[y]}else u.subArgs=void 0;return a==="bindValueType"&&(u.bindValue=""),a==="require"&&l&&!u.bindValue&&(u.enable=!0),(a==="require"||a==="enable")&&(l?p=H(m,u.key):u.subArgs&&V(a,u.subArgs,!1)),c()(c()({},u),{},t()({},a,l))}return u.subArgs?c()(c()({},u),{},{subArgs:j(u.subArgs)}):u})},_=b(m)||[];return K(a,_,p),_},C=function(m){var s=function p(b){return b?.filter(function(_){var j;if(_.dataType===L.Gi.Object||(j=_.dataType)!==null&&j!==void 0&&j.includes("Array")){var w;return(w=_.subArgs)!==null&&w!==void 0&&w.length?c()(c()({},_),{},{subArgs:p(_.subArgs)}):!0}return!1})},a=function p(b){return b.map(function(_){var j,w=c()(c()({},_),{},{disabled:_.dataType===L.Gi.Object||!1});return(j=w.subArgs)!==null&&j!==void 0&&j.length?c()(c()({},w),{},{subArgs:p(w.subArgs)}):w})},l=s(m);return a(l)},U=function o(m){return m.map(function(s){var a,l;if((a=s.dataType)!==null&&a!==void 0&&a.includes("Array")){var p=$()(s,["subArgs"]);return c()(c()({},p),{},{key:s.key,name:s.name,description:s.description})}return(l=s.subArgs)!==null&&l!==void 0&&l.length?c()(c()({},s),{},{subArgs:o(s.subArgs)}):s})},R=function o(m){return m.map(function(s){var a,l,p=c()(c()({},s),{},{disabled:s.dataType===L.Gi.Object||((a=s.dataType)===null||a===void 0?void 0:a.includes("Array"))||!1});return(l=p.subArgs)!==null&&l!==void 0&&l.length?c()(c()({},p),{},{subArgs:o(p.subArgs)}):p})},g=function o(m,s){var a=r()(m),l;try{for(a.s();!(l=a.n()).done;){var p=l.value;if(p.key===s)return p;if(p.subArgs){var b=o(p.subArgs,s);if(b)return b}}}catch(_){a.e(_)}finally{a.f()}},de=function(m){var s=!0,a=function p(b){return b?.map(function(_){var j;return _.nameRequired=!_.name,_.descRequired=!_.description,s&&(s=!!_.name&&!!_.description),_!=null&&(j=_.subArgs)!==null&&j!==void 0&&j.length?_objectSpread(_objectSpread({},_),{},{subArgs:p(_.subArgs)}):_})},l=a(m);return{list:l,isAllRequired:s}},Z=function o(m){return m?.map(function(s){return s.bindValueType||(s.bindValueType=L.Oy.Input),s.subArgs&&s.subArgs.length>0&&(s.subArgs=o(s.subArgs)),s.children&&s.children.length>0&&(s.children=o(s.children)),s})}}}]);})();
