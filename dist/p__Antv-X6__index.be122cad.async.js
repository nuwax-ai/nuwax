"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[4788],{65173:function(ot,Sn,E){var An=E(15558),G=E.n(An),Q=E(48305),Ve=E.n(Q),He=E(61884),K=E(44689),On=E(62237),q=E(63876),_n=E(12758),h=E(29328),Mn=E(63619),z=E(58176),cn=E(75271),pn=E(87453),Dn=E(15457),F=E(52676),Fe=function(Ie){if(!Ie)return 0;for(var me=0,s=0;s<Ie.length;s++)/[\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef]/.test(Ie[s])?me+=2:me+=1;return me},le=function(Ie,me){if(!Ie)return"";for(var s=0,Ce="",e=0;e<Ie.length;e++){var nn=Ie[e],fn=/[\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef]/.test(nn)?2:1;if(s+fn>me)break;Ce+=nn,s+=fn}return Ce.length<Ie.length&&(Ce+="..."),Ce},Re=function(Ie){var me=Ie.placeholder,s=Ie.form,Ce=Ie.fieldName,e=Ie.style,nn=Ie.isDisabled,fn=nn===void 0?!1:nn,Tn=Ie.referenceType,N=Tn===void 0?"Reference":Tn,Kn=Ie.isLoop,$n=Ie.value,ze=Ie.onChange,un=(0,pn.useModel)("workflow"),Qe=un.referenceList,Gn=un.getValue,Be=un.getLoopValue,se=un.setIsModified,Je=(0,cn.useState)(""),kn=Ve()(Je,2),Ke=kn[0],he=kn[1],Xe=(0,cn.useState)([$n||""]),ke=Ve()(Xe,2),Ye=ke[0],It=ke[1],tn=(0,cn.useState)(300),Xn=Ve()(tn,2),mt=Xn[0],wn=Xn[1];(0,cn.useEffect)(function(){var Ee=function(){var dn=window.innerHeight,Oe=document.querySelector(".input-or-reference");if(Oe){var gn=Oe.getBoundingClientRect(),sn=dn-gn.top-20;wn(Math.min(Math.max(sn,150),400))}};return Ee(),window.addEventListener("resize",Ee),window.addEventListener("scroll",Ee),function(){window.removeEventListener("resize",Ee),window.removeEventListener("scroll",Ee)}},[]);var jn=function(ye,dn){if(Ce&&s){var Oe=Ce.slice(0,-1);if(s.setFieldValue([].concat(G()(Oe),["bindValueType"]),dn),dn==="Reference"){var gn,sn=Qe==null||(gn=Qe.argMap)===null||gn===void 0||(gn=gn[ye])===null||gn===void 0?void 0:gn.dataType;s.setFieldValue([].concat(G()(Oe),["dataType"]),sn||"String"),s.setFieldValue(Ce,ye);var an=s.getFieldValue([].concat(G()(Oe),["name"]));(!an||fn)&&s.setFieldValue([].concat(G()(Oe),["name"]),Qe.argMap[ye].name)}else s.setFieldValue([].concat(G()(Oe),["dataType"]),"String"),s.setFieldValue(Ce,ye)}se(!0)};(0,cn.useEffect)(function(){if(Ce&&s){var Ee=s.getFieldValue(Ce),ye=s.getFieldValue([].concat(G()(Ce.slice(0,-1)),["bindValueType"]));if(ye==="Reference"){var dn=Ee&&Qe.argMap[Ee];he(dn?Kn?Be(Ee):Gn(Ee):"")}else he("")}},[s?.getFieldsValue(),Qe.argMap]);var Mt=function(){var ye;jn("","Input"),he(""),It([""]);var dn=(ye=Ce?.slice(0,-1))!==null&&ye!==void 0?ye:[];s?.setFieldValue([].concat(G()(dn),["name"]),"")},Yn=function(ye){return(0,F.jsxs)("div",{className:"tree-custom-title-style",children:[(0,F.jsx)("span",{title:"",children:ye.name}),(0,F.jsx)(q.Z,{content:ye.description||"\u6682\u65E0\u63CF\u8FF0",children:(0,F.jsx)(K.Z,{title:"",style:{marginLeft:"4px",fontSize:12}})}),(0,F.jsx)(_n.Z,{color:"#C9CDD4",style:{marginLeft:"8px",fontSize:10,lineHeight:"14px"},children:ye.dataType})]})},Hn=function(ye){!ye||!ye.length||(jn(ye[0],"Reference"),he(Gn(ye[0])),It(ye))},Vn=function(ye){if(ye&&ye.length){var dn=!1;return ye.map(function(Oe){var gn=Oe?.outputArgs.some(function(sn){var an,ht;return(sn==null||(an=sn.children)===null||an===void 0?void 0:an.length)&&(sn==null||(ht=sn.children)===null||ht===void 0?void 0:ht.length)>0});return{key:Oe.id,label:Fe(Oe.name)>16?le(Oe.name,16):Oe.name,icon:(0,He.qM)(Oe.type),popupClassName:"inputOrReferencePopup",children:Oe.outputArgs?[{key:"".concat(Oe.id,"-tree-select"),label:(0,F.jsx)("div",{style:{paddingTop:12,paddingRight:12,paddingBottom:8},onClick:function(an){dn||(an.stopPropagation(),an.preventDefault())},children:(0,F.jsx)(h.Z,{onSelect:function(an){Hn(an),dn=!0},defaultExpandAll:!0,treeData:Oe.outputArgs,fieldNames:{title:"name",key:"key",children:"children"},titleRender:Yn,defaultSelectedKeys:Ye,selectedKeys:Ye,blockNode:!0,className:"custom-tree-style ".concat(gn?"":"custom-tree-no-children-style"),style:{maxHeight:"".concat(mt,"px"),overflow:"auto"}})})}]:void 0}})}else return[{key:"no-data",popupClassName:"inputOrReferencePopup",label:(0,F.jsx)("div",{style:{padding:8,color:"red"},children:"\u672A\u6DFB\u52A0\u4E0A\u7EA7\u8282\u70B9\u8FDE\u7EBF\u6216\u4E0A\u7EA7\u8282\u70B9\u65E0\u53C2\u6570"}),disabled:!0}]},lt=function(){return Vn(Kn?Qe.innerPreviousNodes:Qe.previousNodes)};return(0,F.jsxs)("div",{className:"input-or-reference dis-sb",style:e,children:[N==="Reference"||N===null?Ke?(0,F.jsx)(_n.Z,{closable:!0,onClose:Mt,className:"input-or-reference-tag text-ellipsis",color:"#C9CDD4",children:Ke.length>10?(0,F.jsx)(q.Z,{content:Ke,placement:"topRight",children:(0,F.jsx)("span",{className:"tag-text-style",children:Ke})}):(0,F.jsx)("span",{className:"tag-text-style",children:Ke})}):(0,F.jsx)(Mn.Z,{placeholder:me||"\u8BF7\u8F93\u5165\u6216\u5F15\u7528\u53C2\u6570",style:{marginRight:8},size:"small",disabled:fn,onChange:function(ye){ze?.(ye.target.value),jn(ye.target.value,"Input")}}):(0,F.jsx)(Mn.Z,{placeholder:me||"\u8BF7\u8F93\u5165\u6216\u5F15\u7528\u53C2\u6570",style:{marginRight:8},size:"small",disabled:fn,value:$n,onChange:function(ye){ze?.(ye.target.value),jn(ye.target.value,"Input")}}),(0,F.jsx)(z.Z,{menu:{items:lt(),style:{maxHeight:328}},trigger:["click"],overlayStyle:{minWidth:200},placement:"bottomRight",children:(0,F.jsx)(On.Z,{style:{cursor:"pointer"},className:"input-reference-icon-style"})})]})};Sn.Z=Re},45262:function(ot,Sn,E){E.d(Sn,{Q:function(){return Re}});var An=E(26068),G=E.n(An),Q=E(48305),Ve=E.n(Q),He=E(61884),K=E(44689),On=E(86743),q=E(12758),_n=E(14719),h=E(9504),Mn=E(63876),z=E(63619),cn=E(7914),pn=E(75271),Dn=E(43562),F=E(52676),Fe=function(Ie){var me=Ie.params;return(0,F.jsx)(F.Fragment,{children:(me||[]).map(function(s){return(0,F.jsxs)("div",{children:[(0,F.jsxs)("div",{className:"dis-left",children:[(0,F.jsx)("span",{className:"mr-16",children:s.name}),(0,F.jsx)(q.Z,{color:"#C9CDD4",children:s.dataType})]}),(0,F.jsx)("p",{className:"skill-params-description",children:s.description})]},s.name)})})},le=function(Ie){var me,s=Ie.open,Ce=Ie.onCancel,e=Ie.params,nn=Ie.onConfirm,fn=(0,pn.useState)("input"),Tn=Ve()(fn,2),N=Tn[0],Kn=Tn[1],$n=(0,pn.useState)(e),ze=Ve()($n,2),un=ze[0],Qe=ze[1],Gn=function(){nn(un),Ce()};(0,pn.useEffect)(function(){Qe(e)},[e?.inputArgBindConfigs]);var Be=function(Je,kn){Qe(kn==="input"?function(Ke){var he;return G()(G()({},Ke),{},{inputArgBindConfigs:(he=Ke.inputArgBindConfigs)===null||he===void 0?void 0:he.map(function(Xe){return Xe.name===Je.name?Je:Xe})})}:function(Ke){var he;return G()(G()({},Ke),{},{outputArgBindConfigs:(he=Ke.outputArgBindConfigs)===null||he===void 0?void 0:he.map(function(Xe){return Xe.name===Je.name?Je:Xe})})})};return(0,F.jsx)(_n.Z,{keyboard:!1,maskClosable:!1,open:s,centered:!0,onCancel:function(){return Ce()},className:"skill-dispose-modal-style",width:800,footer:function(){return(0,F.jsx)(h.ZP,{onClick:Gn,children:"\u4FDD\u5B58"})},children:(0,F.jsxs)("div",{className:"skill-dispose-container flex ",children:[(0,F.jsxs)("div",{className:"skill-dispose-left",children:[(0,F.jsx)("div",{className:"skill-dispose-left-title",children:"\u8BBE\u7F6E"}),(0,F.jsx)("p",{className:"skill-menu-style ".concat(N==="input"?"select-menu":""),onClick:function(){return Kn("input")},children:"\u914D\u7F6E\u8F93\u5165\u53C2\u6570"})]}),(0,F.jsx)("div",{className:"skill-dispose-right",children:N==="input"&&(0,F.jsxs)("div",{children:[(0,F.jsxs)("div",{className:"dis-sb content-item-style content-title-style",children:[(0,F.jsx)("span",{className:"flex-1",children:"\u53C2\u6570\u540D\u79F0"}),(0,F.jsx)("span",{className:"content-center-item-style",children:"\u9ED8\u8BA4\u503C"}),(0,F.jsxs)("p",{className:"content-right-item-style flex",children:[(0,F.jsx)("span",{children:"\u5F00\u542F"}),(0,F.jsx)(Mn.Z,{content:"\u5F53\u53C2\u6570\u8BBE\u7F6E\u4E3A\u4E0D\u53EF\u89C1\u65F6\uFF0C\u5927\u6A21\u578B\u5C06\u65E0\u6CD5\u770B\u5230\u8BE5\u53C2\u6570\u3002\u5982\u679C\u8BE5\u53C2\u6570\u8BBE\u7F6E\u4E86\u9ED8\u8BA4\u503C\u5E76\u4E14\u4E0D\u53EF\u89C1\uFF0C\u5219\u5728\u8C03\u7528\u63D2\u4EF6\u65F6\uFF0C\u667A\u80FD\u4F53\u4F1A\u9ED8\u8BA4\u53EA\u4F7F\u7528\u8FD9\u4E2A\u8BBE\u5B9A\u503C",styles:{body:{width:"300px"}},children:(0,F.jsx)(K.Z,{className:"ml-12"})})]})]}),un==null||(me=un.outputArgBindConfigs)===null||me===void 0?void 0:me.map(function(se){var Je;return(0,F.jsxs)("div",{className:"dis-sb content-item-style",children:[(0,F.jsx)("div",{className:"flex-1",children:(0,F.jsxs)("p",{className:"flex",children:[(0,F.jsx)("span",{className:"mr-16",children:se.name}),(0,F.jsx)(q.Z,{color:"#C9CDD4",children:se.dataType})]})}),(0,F.jsx)(z.Z,{className:"content-center-item-style",value:(Je=se.bindValue)!==null&&Je!==void 0?Je:"",onChange:function(Ke){Be(G()(G()({},se),{},{bindValue:Ke.target.value}),"input")}}),(0,F.jsx)("p",{className:"content-right-item-style",children:(0,F.jsx)(cn.Z,{size:"small",checked:se.enable,onChange:function(Ke){Be(G()(G()({},se),{},{enable:Ke}),"input")}})})]},se.name)})]})})]})})},Re=function(Ie){var me=Ie.params,s=Ie.disabled,Ce=s===void 0?!1:s,e=Ie.removeItem,nn=Ie.modifyItem,fn=(0,pn.useState)(null),Tn=Ve()(fn,2),N=Tn[0],Kn=Tn[1],$n=(0,pn.useState)(!1),ze=Ve()($n,2),un=ze[0],Qe=ze[1],Gn=(0,pn.useState)(!1),Be=Ve()(Gn,2),se=Be[0],Je=Be[1],kn=function(Xe){e(Xe)},Ke=function(Xe){nn(Xe)};return(0,F.jsxs)("div",{className:"skill-list",children:[me.map(function(he){return(0,F.jsx)("div",{children:(0,F.jsxs)("div",{className:"skill-item-style dis-left",style:{opacity:Ce?.5:1,cursor:Ce?"not-allowed":"pointer"},onMouseEnter:function(){Kn(he),Je(!0)},onMouseLeave:function(){return Je(!1)},children:[(0,F.jsx)("img",{src:he.icon===""?(0,He.Pk)(he.targetType):he.icon,alt:"",className:"skill-item-icon"}),(0,F.jsxs)("div",{className:"skill-item-content-style",children:[(0,F.jsx)("div",{className:"skill-item-title-style",children:he.name}),(0,F.jsx)("div",{className:"skill-item-desc-style",children:he.description})]}),(N?.typeId&&N?.typeId===he?.typeId||N?.knowledgeBaseId&&N?.knowledgeBaseId===he?.knowledgeBaseId)&&se&&(0,F.jsx)("div",{className:"mask-layer-style",children:(0,F.jsxs)("div",{className:"skill-item-dispose-style",style:{color:"#fff",backgroundColor:"transparent"},children:[he.outputArgBindConfigs&&he.outputArgBindConfigs.length&&(0,F.jsx)(Mn.Z,{content:(0,F.jsx)(Fe,{params:he.outputArgBindConfigs}),trigger:"hover",children:(0,F.jsx)(K.Z,{className:"white"})}),!Ce&&(0,F.jsx)(Mn.Z,{content:"\u79FB\u9664",trigger:"hover",children:(0,F.jsx)(On.Z,{className:"ml-12  white",onClick:function(){return kn(he)}})})]})})]})},"skill-".concat(he.type,"-").concat(he.typeId||he.knowledgeBaseId,"-").concat(he.name))}),(0,F.jsx)(le,{open:un,onCancel:function(){return Qe(!1)},params:N,onConfirm:Ke})]})}},76571:function(ot,Sn,E){var An=E(75271),G=function(Ve){var He="drawer-scroll-hidden";if(!document.getElementById("drawer-scroll-style")){var K=document.createElement("style");K.id="drawer-scroll-style",K.innerHTML=`
        .`.concat(He,` {
          overflow-x: hidden !important;
        }
      `),document.head.appendChild(K)}(0,An.useEffect)(function(){Ve?(document.body.classList.add(He),document.documentElement.classList.add(He)):setTimeout(function(){document.body.classList.remove(He),document.documentElement.classList.remove(He)},400)},[Ve])};Sn.Z=G},9633:function(ot,Sn,E){E.r(Sn),E.d(Sn,{default:function(){return no}});var An=E(15558),G=E.n(An),Q=E(67825),Ve=E.n(Q),He=E(90228),K=E.n(He),On=E(87999),q=E.n(On),_n=E(26068),h=E.n(_n),Mn=E(48305),z=E.n(Mn),cn=E(88459),pn=E(75484),Dn=E(14258),F=E(28190),Fe=E(63619),le=E(9504),Re=E(63876),vn=E(70183),Ie=E(94581),me=E.n(Ie),s=E(75271),Ce={"xagi-nav-style2":"xagi-nav-style2___iPIiE",text:"text___eVO4C","page-container":"page-container____YLsd","show-stand":"show-stand___x0v4C",hidden:"hidden___LyPql","stand-header":"stand-header___C7ruv","form-style":"form-style___voUbC","form-item-style":"form-item-style___BoNFn","icon-margin":"icon-margin___Z4x9N",close:"close___yXK9c",desc:"desc___Seg_N","divider-horizontal":"divider-horizontal____jNfi",margin:"margin___VG7KG",empty:"empty___nLARw","title-style":"title-style___Cybj_","icon-box-style":"icon-box-style___cfSXc"},e=E(52676),nn=me().bind(Ce),fn=function(n){var t=n.className,r=n.icon,a=n.title,i=n.description,u=n.visible,o=n.otherAction,y=n.onClose,I=n.lineMargin,x=n.children,m=n.changeFoldWrap,p=n.showNameInput,l=n.backgroundColor,j=u?"":Ce.hidden,T=I?Ce.margin:"",d=r?Ce["icon-margin"]:"",k=(0,s.useState)(!1),g=z()(k,2),f=g[0],c=g[1],S=(0,s.useState)(!1),w=z()(S,2),P=w[0],Z=w[1],D=F.Z.useForm(),V=z()(D,1),L=V[0],R=(0,s.useRef)(null),U=(0,s.useRef)(null);(0,s.useEffect)(function(){L.setFieldsValue({name:a,description:i})},[a,i]),(0,s.useEffect)(function(){f&&R.current&&R.current.focus()},[f]),(0,s.useEffect)(function(){P&&U.current&&U.current.focus()},[P]),(0,s.useEffect)(function(){p&&c(!0)},[p]);var J=function(ne){m?.(ne),c(!1),Z(!1)},X="linear-gradient(to bottom, ".concat(l," 0, white 42px)");return(0,e.jsxs)("div",{className:nn("flex flex-col",Ce["show-stand"],j,t),style:{background:X,paddingTop:"3px"},children:[(0,e.jsx)("div",{className:nn(Ce["stand-header"],"flex","items-center"),style:{height:f?"66px":P?"90px":"66px"},children:(0,e.jsxs)(F.Z,{form:L,onFinish:J,className:Ce["form-style"],children:[(0,e.jsx)(F.Z.Item,{name:"name",className:Ce["form-item-style"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8282\u70B9\u540D\u79F0"}],style:{height:f?"32px":"24px"},children:f?(0,e.jsx)(Fe.Z,{value:a,ref:R,onKeyDown:function(ne){ne.key==="Enter"&&(L.submit(),c(!1))},maxLength:25,onBlur:function(){L.submit(),c(!1)}}):(0,e.jsxs)("div",{className:"dis-sb",style:{color:l},children:[(0,e.jsxs)("div",{className:"dis-sa",onDoubleClick:function(){return c(!0)},children:[(0,e.jsx)("div",{className:Ce["icon-box-style"],children:r}),(0,e.jsx)("span",{className:nn("flex-1 text-ellipsis ",Ce["title-style"],d),children:a})]}),(0,e.jsxs)("div",{className:"dis-left fold-action-style",children:[o,(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Dn.Z,{}),size:"small",onClick:y})]})]})}),(0,e.jsx)(F.Z.Item,{name:"description",className:Ce["form-item-style"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8282\u70B9\u63CF\u8FF0"}],children:P?(0,e.jsx)(Fe.Z.TextArea,{ref:U,value:i,placeholder:i,onKeyDown:function(ne){ne.key==="Enter"&&(L.submit(),Z(!1))},onBlur:function(){L.submit(),Z(!1)},rows:2,style:{marginTop:"10px",resize:"none"}}):(0,e.jsx)(Re.Z,{title:i,styles:{body:{width:"300px"}},trigger:"click",children:(0,e.jsx)("div",{onDoubleClick:function(){return Z(!0)},className:"text-ellipsis cursor-pointer ".concat(Ce.desc),children:i})})})]})}),(0,e.jsx)("div",{className:nn(Ce["divider-horizontal"],T)}),(0,e.jsx)("div",{className:"flex-1 overflow-y",children:x||(0,e.jsx)(vn.Z,{className:nn(Ce.empty),description:"\u6682\u65E0\u5185\u5BB9"})})]})},Tn=fn,N=E(92122),Kn=E(1301),$n=E(32347),ze=E(46219),un=function(n){var t=n.onChange,r=n.testRun,a=n.action,i=n.nodeType,u=ze.Z.useApp(),o=u.modal,y=s.useState(!1),I=z()(y,2),x=I[0],m=I[1],p=i===N.C8.Loop,l=function(d){if(p){o.confirm({title:"\u786E\u5B9A\u8981\u5220\u9664\u5FAA\u73AF\u8282\u70B9\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){t(d),m(!1)}});return}t(d),m(!1)},j=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{onClick:function(){return l("Rename")},className:"cursor-pointer",style:{padding:"3px 0"},children:"\u91CD\u547D\u540D"}),!p&&(0,e.jsx)("p",{onClick:function(){return l("Duplicate")},className:"cursor-pointer",style:{padding:"3px 0"},children:"\u521B\u5EFA\u526F\u672C"}),(0,e.jsx)("p",{onClick:function(){return l("Delete")},className:"cursor-pointer",style:{padding:"3px 0"},children:"\u5220\u9664"})]});return(0,e.jsxs)("div",{className:"dis-left",children:[r&&(0,e.jsx)(Re.Z,{placement:"top",content:"\u6D4B\u8BD5\u8BE5\u8282\u70B9",children:(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Kn.Z,{}),style:{marginRight:"6px",fontSize:"12px"},size:"small",onClick:function(){return l("TestRun")}})}),a&&(0,e.jsx)(Re.Z,{content:j,trigger:"click",open:x,onOpenChange:function(d){return m(d)},children:(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)($n.Z,{}),style:{marginRight:"6px",fontSize:"12px"},size:"small",onClick:function(){return m(!0)}})})]})},Qe=un,Gn=E(56716),Be=E(39373),se=E(61884),Je=E(73813),kn=E(8738),Ke=E(89064),he=E(13528),Xe=E(6844),ke=E(87453),Ye=E(12758),It=E(82092),tn=E.n(It),Xn=E(61265),mt=E(72875),wn=E(45019),jn=E(44953),Mt=E(7980),Yn=E(51249),Hn=E(51430),Vn=E(32699),lt=E.n(Vn),Ee=E(92448),ye=E(34204),dn=["item","loading"],Oe=function(n){var t,r,a,i=n.item,u=n.loading,o=Ve()(n,dn),y=(t=localStorage.getItem(mt.LA))!==null&&t!==void 0?t:"",I=ze.Z.useApp(),x=I.message,m=F.Z.useFormInstance(),p=(0,ke.useModel)("workflow"),l=p.getWorkflow,j=(0,s.useState)(!1),T=z()(j,2),d=T[0],k=T[1],g=(0,s.useState)([]),f=z()(g,2),c=f[0],S=f[1];(0,s.useEffect)(function(){var L,R;k((L=(R=i.dataType)===null||R===void 0?void 0:R.startsWith("Array_"))!==null&&L!==void 0?L:!1)},[i.dataType]);var w=(0,s.useCallback)(function(L){var R=L.fileList.filter(function(U){var J;return U.status===N.KM.done&&!((J=U.response)!==null&&J!==void 0&&J.success)?(x.error("\u4E0A\u4F20\u5931\u8D25"),!1):U.status!==N.KM.removed}).map(function(U){var J,X,ee,ne=U.url||((J=U.response)===null||J===void 0||(J=J.data)===null||J===void 0?void 0:J.url),ie=(X=U.response)===null||X===void 0||(X=X.data)===null||X===void 0?void 0:X.key,de=U.name||((ee=U.response)===null||ee===void 0||(ee=ee.data)===null||ee===void 0?void 0:ee.fileName)||"";return{key:ie||"",status:U.status,uid:U.uid||(0,Ee.Z)(),name:de,url:ne}});return R},[]),P=(0,s.useCallback)(function(L){var R=w(L);if(S(d?R:R.splice(0,1)),L.file.status===N.KM.error){var U;x.warning((U=L.file.response)===null||U===void 0?void 0:U.message)}},[S,d]),Z=(0,s.useCallback)(function(L,R,U){var J,X=R?L:[L];return Array.isArray(X)&&(J=X[0])!==null&&J!==void 0&&J.url?X.map(function(ee){if((0,Vn.isString)(ee)){var ne=l("testRunValues"),ie=ne[U],de=R&&(0,Vn.isString)(ie)?JSON.parse(ie):ie;return Array.isArray(de)?de.find(function(_e){return _e?.url===ee}):de}else if(ee!=null&&ee.url){var ge;return{uid:ee?.uid||(0,Ee.Z)(),name:ee?.name||(ee==null||(ge=ee.url)===null||ge===void 0?void 0:ge.split("/").pop())||ee?.url||"",url:ee?.url,status:N.KM.done}}return ee})||[]:[]},[]);switch((0,s.useEffect)(function(){var L;if((L=i.dataType)!==null&&L!==void 0&&L.includes("File")){var R=m.getFieldsValue(!0)[i.name],U=d&&(0,Vn.isString)(R)?JSON.parse(R):R,J=Z(U,d,i.name);S(J)}},[i.name,i.dataType,d]),(0,s.useEffect)(function(){var L;if((L=i.dataType)!==null&&L!==void 0&&L.includes("File")){var R;R=c.filter(function(U){return U.status===N.KM.done})||[],d||(R=R[0]||{}),m.setFieldValue(i.name,R)}},[c,m,i.dataType,i.name,d]),!0){case((r=i.dataType)===null||r===void 0?void 0:r.includes("File")):{var D,V=h()(h()({},o),{},{maxCount:d?10:1});return delete V.value,(0,e.jsx)(Mt.Z,h()(h()({},V),{},{fileList:c,action:Xn.GI,onChange:function(R){P(R)},multiple:d,headers:{Authorization:y?"Bearer ".concat(y):""},accept:(0,jn.Df)(d?(D=i.dataType)===null||D===void 0?void 0:D.replace("Array_",""):i.dataType),disabled:u,children:(0,e.jsx)(le.ZP,{children:"\u4E0A\u4F20\u6587\u4EF6"})}))}case(i.dataType==="Object"||((a=i.dataType)===null||a===void 0?void 0:a.includes("Array"))):return(0,e.jsx)(ye.Z,{value:m.getFieldValue(i.name)||"",codeLanguage:wn.vQ.JSON,onChange:function(R){m.setFieldsValue(tn()({},i.name,R))},height:"180px"});case i.dataType==="Number":return(0,e.jsx)(Yn.Z,h()(h()({},o),{},{disabled:u}));case i.dataType==="Integer":return(0,e.jsx)(Yn.Z,h()(h()({},o),{},{precision:0,disabled:u}));case i.dataType==="Boolean":return(0,e.jsx)(Hn.ZP.Group,h()(h()({},o),{},{disabled:u,options:[{label:"true",value:"true"},{label:"false",value:"false"}]}));case i.dataType==="String":return(0,e.jsx)(Fe.Z,h()({},o));default:return(0,e.jsx)(Fe.Z,h()(h()({},o),{},{disabled:u}))}},gn=Oe,sn=function(n){var t=n.items,r=n.loading,a=n.options;return(0,e.jsx)(e.Fragment,{children:t.map(function(i,u){if(a!==void 0&&JSON.stringify(a.argMap)!=="{}"){var o=a.argMap[i.bindValue];o&&(i.dataType=o.dataType)}return(0,e.jsx)("div",{children:(0,e.jsx)(F.Z.Item,{name:[i.name],label:(0,e.jsxs)(e.Fragment,{children:[i.name,(0,e.jsx)(Ye.Z,{color:"#C9CDD4",className:"ml-10",children:i.dataType})]}),rules:i.require?[{required:!0,message:"".concat(i.name,"\u662F\u5FC5\u586B\u9879")}]:[],children:(0,e.jsx)(gn,{item:i,loading:r})})},i.key||"".concat(i.name,"-").concat(u))})})},an=sn;function ht(C,n){if(C.length<=n)return C;var t=n-3,r=Math.ceil(t/2),a=Math.floor(t/2);return C.slice(0,r)+"..."+C.slice(C.length-a)}var tr=function(n){var t,r=n.params,a=n.items,i=n.value,u=n.answerType,o=n.onAnswer,y=n.onChange,I=n.onSubmit,x=function(p){o?.(p.data.description)};return(0,e.jsxs)("div",{className:"stop-wait-style dis-col flex-1 overflow-y",children:[(0,e.jsxs)("div",{className:"stop-wait-header dis-center",children:[(0,se.qM)(N.C8.QA),(0,e.jsx)("div",{}),(0,e.jsx)("span",{className:"ml-10",children:"\u95EE\u7B54"}),(0,e.jsx)("span",{className:"ml-10",children:"\u56DE\u590D\u4EE5\u4E0B\u95EE\u9898\u540E\u7EE7\u7EED\u8BD5\u8FD0\u884C"})]}),(0,e.jsx)(kn.Z,{className:"flex-1",avatar:(0,e.jsx)("img",{src:E(47804),className:"bubble-avatar"}),variant:u===N.J4.SELECT?"borderless":"filled",header:(0,e.jsx)("span",{children:"\u673A\u5668\u4EBA"}),content:r!=null&&(t=r.options)!==null&&t!==void 0&&t.length?(0,e.jsx)("div",{className:"qa-question-style",children:(0,e.jsx)(Ke.Z,{title:r?.question,items:a,vertical:!0,onItemClick:x})}):(0,e.jsx)("div",{className:"qa-question-style",children:r?.question})}),(0,e.jsx)(he.Z,{value:i,onChange:y,onSubmit:I})]})},ar=function(n){var t=n.config,r=n.loading,a=n.options,i=t.body,u=t.headers,o=t.queries;return(0,e.jsxs)(e.Fragment,{children:[i&&i.length>0&&(0,e.jsx)(an,{items:i,loading:r,options:a}),u&&u.length>0&&(0,e.jsx)(an,{items:u,loading:r,options:a}),o&&o.length>0&&(0,e.jsx)(an,{items:o,loading:r,options:a}),!(i!=null&&i.length)&&!(u!=null&&u.length)&&!(o!=null&&o.length)&&(0,e.jsx)(vn.Z,{description:"\u672C\u6B21\u8BD5\u8FD0\u884C\u65E0\u9700\u8F93\u5165"})]})},rr=function(n){var t=n.type,r=n.config,a=n.loading,i=n.options,u=r.inputArgs;return(0,e.jsxs)(e.Fragment,{children:[t!==N.C8.HTTPRequest&&(u&&u.length?(0,e.jsx)(an,{items:u,loading:a,options:i}):(0,e.jsx)(vn.Z,{description:"\u672C\u6B21\u8BD5\u8FD0\u884C\u65E0\u9700\u8F93\u5165"})),t===N.C8.HTTPRequest&&(0,e.jsx)(ar,{config:r,loading:a,options:i})]})},ir=function(n){var t=n.form,r=n.value,a=n.config,i=a.inputArgs;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"collapse-title-style dis-left",children:"\u8F93\u5165"}),i?.map(function(u){return(0,e.jsx)(Fe.Z,{prefix:ht(u.name+":",20),value:(0,se.E4)(t.getFieldValue(u.name),u?.dataType||""),disabled:!0,className:"mb-12 override-input-style"},u.name)}),(0,e.jsx)("p",{className:"collapse-title-style dis-left",children:"\u8F93\u51FA"}),(0,e.jsx)("pre",{className:"result-style overflow-y",children:r})]})},sr=function(n){var t=n.node,r=n.run,a=n.loading,i=n.testRunResult,u=n.clearRunResult,o=n.stopWait,y=n.formItemValue,I=n.testRunParams,x=(0,ke.useModel)("model"),m=x.testRun,p=x.setTestRun,l=(0,ke.useModel)("workflow"),j=l.referenceList,T=l.storeWorkflow,d=F.Z.useForm(),k=z()(d,1),g=k[0],f=(0,s.useState)([]),c=z()(f,2),S=c[0],w=c[1],P=function(X){T("testRunValues",(0,Be.Xh)(X));var ee=(0,Be.Xh)(X);if(X&&JSON.stringify(X)!=="{}"){if(t.nodeConfig.inputArgs&&t.nodeConfig.inputArgs.length){var ne=function(De){if(Object.prototype.hasOwnProperty.call(X,De)){var ue,re,te=t.nodeConfig.inputArgs.find(function(Y){return Y.name===De});if(te&&(ue=te.dataType)!==null&&ue!==void 0&&ue.includes("File"))ee[De]=(0,se.wJ)(X[De],te.dataType);else if(te&&(te.dataType==="Object"||(re=te.dataType)!==null&&re!==void 0&&re.includes("Array")))try{ee[De]=JSON.parse(X[De])}catch(Y){console.error("JSON \u89E3\u6790\u5931\u8D25:",Y)}}};for(var ie in X)ne(ie)}else if(t.type===N.C8.HTTPRequest){var de=[].concat(G()(t.nodeConfig.body||[]),G()(t.nodeConfig.queries||[]),G()(t.nodeConfig.headers||[])),ge=function(De){if(Object.prototype.hasOwnProperty.call(X,De)){var ue,re=de?.find(function(te){return te.name===De});if(re&&(re.dataType==="Object"||(ue=re.dataType)!==null&&ue!==void 0&&ue.includes("Array")))try{ee[De]=JSON.parse(X[De])}catch(te){console.error("JSON \u89E3\u6790\u5931\u8D25:",te)}}};for(var _e in X)ge(_e)}r(t.type,ee)}else r(t.type)},Z=[{key:"inputArgs",label:"\u8BD5\u8FD0\u884C\u8F93\u5165",children:(0,e.jsxs)(F.Z,{form:g,layout:"vertical",onFinish:P,className:"test-run-form",children:[(0,e.jsxs)("div",{className:"dis-left",children:[(0,se.qM)(t.type),(0,e.jsx)("span",{style:{marginLeft:"10px"},children:t.name})]}),rr({loading:a,type:t.type,config:t.nodeConfig,options:j})]})}].concat(G()(i?[{key:"outputArgs",label:"\u8FD0\u884C\u7ED3\u679C",children:ir({form:g,config:t.nodeConfig,value:i})}]:[])),D=function(X){r("Start",{answer:X})},V=(0,s.useState)(""),L=z()(V,2),R=L[0],U=L[1];return(0,s.useEffect)(function(){if(o){var J=(I?.options||[]).map(function(X){return{key:X.uuid,description:X.content}});w(J)}},[m,o]),(0,s.useEffect)(function(){var J=JSON.parse(JSON.stringify(y||{}));if(t.type===N.C8.HTTPRequest&&JSON.stringify(J)!=="{}"){for(var X in J)typeof J[X]!="string"&&J[X]!==null&&(J[X]=JSON.stringify(J[X]));g.setFieldsValue(J)}},[y]),m?(0,e.jsx)("div",{className:"test-run-style",style:{display:"flex",paddingTop:"100px"},children:(0,e.jsxs)("div",{className:"test-content-style dis-col ",children:[(0,e.jsxs)("div",{className:"test-run-header dis-sb",children:[(0,e.jsx)("span",{children:"\u8BD5\u8FD0\u884C"}),(0,e.jsx)(Dn.Z,{className:"cursor-pointer",onClick:function(){p(!1),u()}})]}),!o&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"collapse-item-style flex-1 ",children:(0,e.jsx)(Xe.Z,{items:Z,ghost:!0,defaultActiveKey:["inputArgs","outputArgs"]})}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Je.Z,{}),type:"primary",onClick:function(){g.submit()},loading:a,className:"mt-16",children:"\u8FD0\u884C"})]}),o&&(0,e.jsx)(tr,{params:I,items:S,answerType:t.nodeConfig.answerType,onAnswer:D,onChange:function(X){U(X)},onSubmit:function(){D(R),U("")}})]})}):null},or=sr,lr=E(27791),on=E(59934),Ze=E(27687),ur=function(n){(0,s.useEffect)(function(){var t=function(a){var i;(a.ctrlKey||a.metaKey)&&((i=a.key)===null||i===void 0?void 0:i.toLowerCase())==="s"&&(a.preventDefault(),n&&n())};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[n])},dr=ur,cr=E(76571);function ia(C,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.leading,a=r===void 0?!0:r,i=t.trailing,u=i===void 0?!0:i,o=(0,s.useRef)(null),y=(0,s.useCallback)(function(){o.current||(o.current=(0,Vn.throttle)(function(){C.apply(void 0,arguments)},n,{leading:a,trailing:u})),o.current.apply(o,arguments)},[C,n,a,u]);return y}function pr(C){var n=C.run,t=C.doNext,r=C.delay,a=r===void 0?500:r,i=(0,ke.useModel)("workflow"),u=i.isModified,o=i.setUpdateLoading,y=(0,s.useRef)(!1),I=(0,s.useRef)(!0),x=(0,s.useRef)(0),m=(0,s.useCallback)(q()(K()().mark(function l(){var j;return K()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(j=++x.current,console.log("\u{1F504} useModifiedSaveUpdate: \u8282\u6D41\u6267\u884C\u4FDD\u5B58 [\u7B2C".concat(j,"\u6B21]")),I.current){d.next=4;break}return d.abrupt("return");case 4:if(!y.current){d.next=7;break}return console.log("\u23F8\uFE0F useModifiedSaveUpdate: \u4FDD\u5B58\u6B63\u5728\u8FDB\u884C\u4E2D\uFF0C\u8DF3\u8FC7\u672C\u6B21\u8C03\u7528"),d.abrupt("return");case 7:return d.prev=7,y.current=!0,console.log("\u2705 useModifiedSaveUpdate: \u5F00\u59CB\u6267\u884C\u4FDD\u5B58\u64CD\u4F5C"),o(!0),d.next=13,n();case 13:t?.(),console.log("\u{1F389} useModifiedSaveUpdate: \u4FDD\u5B58\u6210\u529F\u5B8C\u6210"),d.next=20;break;case 17:d.prev=17,d.t0=d.catch(7),console.error("\u274C useModifiedSaveUpdate: \u4FDD\u5B58\u5931\u8D25",d.t0);case 20:return d.prev=20,o(!1),y.current=!1,d.finish(20);case 24:case"end":return d.stop()}},l,null,[[7,17,20,24]])})),[n,t,o]),p=ia(function(){return console.log("\u{1F680} useModifiedSaveUpdate: \u8282\u6D41\u51FD\u6570\u88AB\u8C03\u7528"),m()},a,{leading:!0,trailing:!0});(0,s.useEffect)(function(){console.log("\u{1F4DD} useModifiedSaveUpdate: isModified \u72B6\u6001\u53D8\u5316 =",u),u&&I.current&&(console.log("\u26A1 useModifiedSaveUpdate: \u89E6\u53D1\u8282\u6D41\u4FDD\u5B58\u51FD\u6570"),p())},[u,p]),(0,s.useEffect)(function(){return I.current=!0,console.log("\u{1F517} useModifiedSaveUpdate: Hook \u521D\u59CB\u5316\u5B8C\u6210"),function(){console.log("\u{1F9F9} useModifiedSaveUpdate: \u6E05\u7406 Hook \u72B6\u6001"),I.current=!1,y.current=!1}},[])}var qe=E(96861),Se=E(64799),ce=E(9051),sa=E(95468),be=E(74286),vr=function(){var C=q()(K()().mark(function n(t){var r,a,i,u,o,y,I,x,m,p,l,j,T;return K()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(r=t.type,a=t.targetId,i=t.sourceNode,u=t.id,o=t.graphUpdateNode,y=t.graphDeleteEdge,I=t.callback,x=i.nextNodeIds===null?[]:i.nextNodeIds,m=(0,Be.Xh)(x),p=String(i.id),l={nodeId:G()(x),sourceId:Number(i.id)},j=r===ce.I3.created,!j){k.next=14;break}if(!x.includes(Number(a))){k.next=11;break}return k.abrupt("return",!1);case 11:l.nodeId.push(Number(a));case 12:k.next=15;break;case 14:r===ce.I3.deleted&&(l.nodeId=l.nodeId.filter(function(g){return Number(g)!==Number(a)}));case 15:return o(p,h()(h()({},i),{},{nextNodeIds:G()(l.nodeId)})),k.prev=16,k.next=19,qe.ZP.apiAddEdge(l);case 19:if(T=k.sent,T.code===on.ZP.success){k.next=26;break}return o(p,h()(h()({},i),{},{nextNodeIds:m})),j&&y(String(u)),k.abrupt("return",!1);case 26:return I?.(),k.abrupt("return",l.nodeId);case 28:k.next=36;break;case 30:return k.prev=30,k.t0=k.catch(16),console.error("Failed to add edge:",k.t0),o(p,h()(h()({},i),{},{nextNodeIds:m})),j&&y(String(u)),k.abrupt("return",!1);case 36:case"end":return k.stop()}},n,null,[[16,30]])}));return function(t){return C.apply(this,arguments)}}(),ut=E(46534),oa=E(24573),xt=E(41249),la=E(56555),dt=E(73415),Vt=E(3790),St=E(39244),fr=E(67130),zn=E(7010),gr=E(18505),mr=function(n){var t=n.marginRight,r=n.title,a=n.inputFieldName,i=n.placeholder,u=n.visible,o=n.onClose;return(0,e.jsxs)("div",{className:"expand-textarea",style:{display:u?"block":"none",right:t},children:[(0,e.jsxs)("div",{className:"expand-textarea-header dis-sb",children:[(0,e.jsx)("div",{className:"expand-textarea-header-title",children:r}),(0,e.jsx)("div",{className:"dis-left mg",children:(0,e.jsx)(fr.ZP,{button:{className:"gradient-button"},children:(0,e.jsx)(zn.Z,{children:(0,e.jsx)(Dn.Z,{onClick:function(){return o()},className:"cursor-pointer"})})})})]}),(0,e.jsx)(St.h,{children:(0,e.jsx)(gr.l0.Item,{name:a,className:"expand-textarea-pre-style scroll-container",children:(0,e.jsx)(St.g,{className:"prompt-editor-provider",isControled:!0,placeholder:i})})})]})},hr=mr,Ut={"xagi-nav-style2":"xagi-nav-style2___XO2hf",text:"text___w3hNR","page-container":"page-container___Yim7u",container:"container___aZlYy","prompt-editor-provider":"prompt-editor-provider___oL5n3"},ua=me().bind(Ut),xr=function(n){var t=n.title,r=n.inputFieldName,a=n.placeholder,i=n.onExpand,u=n.onOptimize,o=n.onOptimizeClick,y=(0,s.useState)(""),I=z()(y,2),x=I[0],m=I[1],p=(0,ke.useModel)("workflow"),l=p.setExpanded,j=p.expanded;return(0,s.useEffect)(function(){return m((0,Ee.Z)()),function(){m(""),l("")}},[]),(0,e.jsxs)("div",{className:ua(Ut.container),children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style gap-6 flex items-center",children:t}),(0,e.jsxs)("div",{children:[u&&o&&(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(dt.pL,{}),size:"small",style:{marginRight:"6px"},onClick:function(){return o()}}),i&&(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Vt.Z,{}),size:"small",onClick:function(){return l(x)}})]})]}),(0,e.jsx)(St.h,{children:(0,e.jsx)(F.Z.Item,{name:r,children:(0,e.jsx)(St.g,{className:ua(Ut["prompt-editor-provider"],"scroll-container"),isControled:!0,placeholder:a})})}),j&&j===x&&(0,e.jsx)(hr,{title:t,inputFieldName:r,marginRight:370+12*2,placeholder:a,visible:j===x,onClose:function(){return l("")}})]})},Ct=xr,Wt=E(13143),At=E(29328),Cr=function(n){var t=n.showCheck,r=n.isBody;return(0,e.jsxs)("div",{className:"dis-left font-12 mb-6 font-color-gray07",children:[(0,e.jsx)("span",{className:"flex-1 ",children:"\u53D8\u91CF\u540D"}),(0,e.jsx)("span",{style:{width:80+(t?60:50)+(r?62:0)},children:"\u53D8\u91CF\u7C7B\u578B"})]})},yr=Cr,En=E(44689),mn=E(16621),$e=E(17701),Nr=function(n){var t=n.title,r=n.form,a=n.notShowTitle,i=n.showAddButton,u=n.onAddRoot,o=n.onChange;return(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:(0,e.jsx)("span",{children:t})}),(0,e.jsxs)("div",{children:[a&&(0,e.jsx)(F.Z.Item,{name:"outputType",noStyle:!0,children:(0,e.jsx)($e.default,{prefix:(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)(Re.Z,{align:{offset:[-12,-12]},content:(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"\u6587\u672C: \u4F7F\u7528\u666E\u901A\u6587\u672C\u683C\u5F0F\u56DE\u590D"}),(0,e.jsx)("li",{children:"Markdown: \u5C06\u5F15\u5BFC\u6A21\u578B\u4F7F\u7528 Markdown \u683C\u5F0F\u8F93\u51FA\u56DE\u590D"}),(0,e.jsx)("li",{children:"JSON: \u5C06\u5F15\u5BFC\u6A21\u578B\u4F7F\u7528 JSON \u683C\u5F0F\u8F93\u51FA"})]}),children:(0,e.jsx)(En.Z,{})}),(0,e.jsx)("span",{className:"ml-10",children:"\u8F93\u51FA\u683C\u5F0F"})]}),options:[{label:"\u6587\u672C",value:"Text"},{label:"Markdown",value:"Markdown"},{label:"JSON",value:"JSON"}],style:{width:"calc(100% - ".concat(i?34:0,"px)")},onChange:function(I){r.setFieldValue("outputType",I),I!=="JSON"&&(o([{key:(0,Ee.Z)(),name:"output",description:"\u8F93\u51FA\u7ED3\u679C",dataType:N.Gi.String,require:!1,systemVariable:!1,bindValueType:"Input",bindValue:""}]),r.submit())}})}),i&&(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),size:"small",onClick:u,className:"ml-10",type:"text"})]})]})},jr=Nr,Ue=E(48512),_t=E(21514),qn=E(86743),da=E(28246),Qn=E(68108),Kt=E(43898),ca=(0,s.memo)(function(C){var n=C.nodeData,t=C.form,r=C.showCheck,a=C.isNotAdd,i=C.onUpdateField,u=C.onAddChild,o=C.onDelete,y=C.onUpdateRequire,I=[N.Gi.Object,N.Gi.Array_Object].includes(n.dataType),x=(0,jn.n3)(n.dataType||void 0),m=F.Z.useWatch("outputType",{form:t,preserve:!0});return(0,e.jsxs)("div",{className:"dis-left",style:{width:"100%"},children:[(0,e.jsx)("div",{className:"flex-1",style:{position:"relative",marginRight:"6px"},children:(0,e.jsx)(Fe.Z,{defaultValue:n.name,onBlur:function(l){return i(n.key,"name",l.target.value)},disabled:n.systemVariable,placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",className:"tree-form-name flex-1",style:{backgroundColor:n.systemVariable?"#f5f5f5":void 0}},n.key)}),(0,e.jsx)("div",{style:{width:"80px",position:"relative"},children:(0,e.jsx)(da.Z,{allowClear:!1,options:Ue.DJ,defaultValue:x,onChange:function(l){i(n.key,"dataType",(0,jn.$g)(l))},changeOnSelect:!0,disabled:n.systemVariable||!a&&m==="Text"||m==="Markdown"||n.subArgs&&n.subArgs.length>0,placement:"bottomRight",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B",style:{width:"100%",backgroundColor:n.systemVariable?"#f5f5f5":void 0},className:"tree-form-name",size:"small"})}),(0,e.jsxs)("div",{className:"nested-form-icon-button",style:{width:r?60:48},children:[I&&(0,e.jsx)(Qn.Z,{title:"\u65B0\u589E\u5B50\u8282\u70B9",children:(0,e.jsx)(le.ZP,{type:"text",className:"tree-icon-style",onClick:function(l){l.stopPropagation(),u(n.key)},icon:(0,e.jsx)(dt.Em,{})})}),(0,e.jsx)(Re.Z,{content:(0,e.jsx)(Fe.Z.TextArea,{defaultValue:n.description||"",onBlur:function(l){return i(n.key,"description",l.target.value)},rows:3},n.key),trigger:"click",children:(0,e.jsx)(Qn.Z,{title:"\u6DFB\u52A0\u63CF\u8FF0",children:(0,e.jsx)(le.ZP,{type:"text",className:"tree-icon-style",disabled:n.systemVariable,icon:(0,e.jsx)(_t.Z,{})})})}),r&&(0,e.jsx)(Qn.Z,{title:"\u662F\u5426\u5FC5\u987B",children:(0,e.jsx)(Kt.Z,{checked:n.require,onChange:function(l){return y(n,l.target.checked)},disabled:n.systemVariable})}),(0,e.jsx)(Qn.Z,{title:"\u5220\u9664",children:(0,e.jsx)(le.ZP,{type:"text",disabled:n.systemVariable,className:"tree-icon-style",onClick:function(){return o(n.key)},icon:(0,e.jsx)(qn.Z,{})})})]})]})},function(C,n){var t;return((t=n.nodeData.subArgs)===null||t===void 0?void 0:t.length)===0?!1:C.nodeData.key===n.nodeData.key&&C.nodeData.name===n.nodeData.name&&C.nodeData.dataType===n.nodeData.dataType&&C.nodeData.require===n.nodeData.require&&C.nodeData.systemVariable===n.nodeData.systemVariable&&C.nodeData.description===n.nodeData.description&&C.nodeData.subArgs===n.nodeData.subArgs&&C.showCheck===n.showCheck&&C.isNotAdd===n.isNotAdd});ca.displayName="TreeNodeTitle";var Er=ca,Dt=E(62237),br=E(58176),tl=E(15457),Fr=function(n){var t=n.placeholder,r=n.data,a=n.style,i=n.isDisabled,u=i===void 0?!1:i,o=n.referenceType,y=o===void 0?"Reference":o,I=n.value,x=n.onChange,m=(0,ke.useModel)("workflow"),p=m.getValue,l=m.setIsModified,j=(0,s.useState)(""),T=z()(j,2),d=T[0],k=T[1],g=function(D,V,L){x?.(D,V,L),k(D),l(!0)};(0,s.useEffect)(function(){if(y==="Reference"&&I){var Z=I&&r.argMap[I];k(Z?p(I):"")}else k(I||"")},[I,r.argMap,y]);var f=function(){g("","Input",N.Gi.String),k("")},c=function(D){return(0,e.jsxs)("div",{className:"tree-custom-title-style",children:[(0,e.jsx)("span",{title:"",children:D.name}),(0,e.jsx)(Re.Z,{content:D.description||"\u6682\u65E0\u63CF\u8FF0",children:(0,e.jsx)(En.Z,{title:"",style:{marginLeft:"4px"}})}),(0,e.jsx)(Ye.Z,{className:"ml-20",color:"#C9CDD4",children:D.dataType})]})},S=function(D){var V;if(D[0]){var L=D[0].toString(),R=r==null||(V=r.argMap)===null||V===void 0||(V=V[L])===null||V===void 0?void 0:V.dataType;g(L,"Reference",R),k(p(L))}},w=function(D){if(D&&D.length){var V=!1;return D.map(function(L){return{key:L.id,label:L.name.length>8?L.name.slice(0,8)+"...":L.name,icon:(0,se.qM)(L.type),popupClassName:"inputOrReferencePopup",children:L.outputArgs?[{key:"".concat(L.id,"-tree-select"),label:(0,e.jsx)("div",{style:{paddingTop:12,paddingRight:12,paddingBottom:8},onClick:function(U){V||(U.stopPropagation(),U.preventDefault())},children:(0,e.jsx)(At.Z,{onSelect:function(U){S(U),V=!0},defaultExpandAll:!0,treeData:L.outputArgs,fieldNames:{title:"name",key:"key",children:"children"},blockNode:!0,showIcon:!0,titleRender:c,className:"custom-tree-style"})})}]:void 0}})}else return[{key:"no-data",popupClassName:"inputOrReferencePopup",label:(0,e.jsx)("div",{style:{padding:8,color:"red"},children:"\u672A\u6DFB\u52A0\u4E0A\u7EA7\u8282\u70B9\u8FDE\u7EBF\u6216\u4E0A\u7EA7\u8282\u70B9\u65E0\u53C2\u6570"}),disabled:!0}]},P=function(){return w(r.previousNodes)};return(0,e.jsxs)("div",{className:"input-or-reference dis-sb",style:a,children:[y==="Reference"&&d!==""?(0,e.jsx)(Ye.Z,{closable:!0,onClose:f,className:"input-or-reference-tag text-ellipsis",color:"#C9CDD4",children:d.length>10?(0,e.jsx)(Re.Z,{content:d,placement:"topRight",children:(0,e.jsx)("span",{className:"tag-text-style",children:d})}):(0,e.jsx)("span",{className:"tag-text-style",children:d})}):(0,e.jsx)(Fe.Z,{placeholder:t||"\u8BF7\u8F93\u5165\u6216\u5F15\u7528\u53C2\u6570",style:{marginRight:8},size:"small",disabled:u,value:d,onChange:function(D){g(D.target.value,"Input",N.Gi.String)}}),(0,e.jsx)(br.Z,{menu:{items:P()},trigger:["click"],overlayStyle:{minWidth:200},placement:"bottomRight",children:(0,e.jsx)(Dt.Z,{style:{cursor:"pointer"},className:"input-reference-icon-style"})})]})},pa=Fr,va=(0,s.memo)(function(C){var n=C.nodeData,t=C.showCheck,r=C.onUpdateField,a=C.onAddChild,i=C.onDelete,u=C.onUpdateRequire,o=[N.Gi.Object,N.Gi.Array_Object].includes(n.dataType)&&n.bindValueType==="Input"&&!n.bindValue,y=(0,jn.n3)(n.dataType||void 0),I=(0,ke.useModel)("workflow"),x=I.referenceList;return(0,e.jsxs)("div",{className:"dis-left",style:{width:"100%"},children:[(0,e.jsx)("div",{className:"flex-1",style:{position:"relative",marginRight:"6px"},children:(0,e.jsx)(Fe.Z,{defaultValue:n.name,onBlur:function(p){return r(n.key,"name",p.target.value)},disabled:n.systemVariable,placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",className:"tree-form-name flex-1",style:{backgroundColor:n.systemVariable?"#f5f5f5":void 0}},n.key)}),(0,e.jsx)("div",{style:{width:"40px",position:"relative"},children:(0,e.jsx)(da.Z,{allowClear:!1,options:Ue.DJ,value:y,onChange:function(p){r(n.key,"dataType",(0,jn.$g)(p))},changeOnSelect:!0,placement:"bottomRight",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B",style:{width:"100%",backgroundColor:"#f5f5f5"},className:"tree-form-name is-body-cascader",size:"small"})}),(0,e.jsx)("div",{style:{width:"100px",marginLeft:"6px",position:"relative"},children:(0,e.jsx)(pa,{referenceType:n.bindValueType,data:x,value:n.bindValue,onChange:function(p,l){r(n.key,"bindValue",p,l)}})}),(0,e.jsxs)("div",{className:"nested-form-icon-button",style:{width:t?60:48},children:[o&&(0,e.jsx)(Qn.Z,{title:"\u65B0\u589E\u5B50\u8282\u70B9",children:(0,e.jsx)(le.ZP,{type:"text",className:"tree-icon-style",onClick:function(p){p.stopPropagation(),a(n.key)},icon:(0,e.jsx)(dt.Em,{})})}),(0,e.jsx)(Re.Z,{content:(0,e.jsx)(Fe.Z.TextArea,{defaultValue:n.description||"",onBlur:function(p){return r(n.key,"description",p.target.value)},rows:3},n.key),trigger:"click",children:(0,e.jsx)(Qn.Z,{title:"\u6DFB\u52A0\u63CF\u8FF0",children:(0,e.jsx)(le.ZP,{type:"text",className:"tree-icon-style",disabled:n.systemVariable,icon:(0,e.jsx)(_t.Z,{})})})}),t&&(0,e.jsx)(Qn.Z,{title:"\u662F\u5426\u5FC5\u987B",children:(0,e.jsx)(Kt.Z,{checked:n.require,onChange:function(p){return u(n,p.target.checked)},disabled:n.systemVariable})}),(0,e.jsx)(Qn.Z,{title:"\u5220\u9664",children:(0,e.jsx)(le.ZP,{type:"text",disabled:n.systemVariable,className:"tree-icon-style",onClick:function(){return i(n.key)},icon:(0,e.jsx)(qn.Z,{})})})]})]})},function(C,n){var t;return((t=n.nodeData.subArgs)===null||t===void 0?void 0:t.length)===0?!1:C.nodeData.key===n.nodeData.key&&C.nodeData.name===n.nodeData.name&&C.nodeData.dataType===n.nodeData.dataType&&C.nodeData.require===n.nodeData.require&&C.nodeData.systemVariable===n.nodeData.systemVariable&&C.nodeData.bindValue===n.nodeData.bindValue&&C.nodeData.bindValueType===n.nodeData.bindValueType&&C.nodeData.description===n.nodeData.description&&C.nodeData.subArgs===n.nodeData.subArgs&&C.showCheck===n.showCheck});va.displayName="TreeNodeTitleBody";var Ir=va,Sr=E(335),et=E.n(Sr),Ar=function(n,t){var r=(0,ke.useModel)("workflow"),a=r.setIsModified,i=(0,s.useRef)(n),u=(0,s.useCallback)(function(m,p){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],j=et()(m),T;try{for(j.s();!(T=j.n()).done;){var d=T.value,k=[].concat(G()(l),[d]);if(d.key===p)return k;if(d.subArgs){var g=u(d.subArgs,p,k);if(g)return g}}}catch(f){j.e(f)}finally{j.f()}return null},[]),o=(0,s.useCallback)(function(m){var p=h()(h()({},m),{},{require:!1});return m.subArgs&&(p.subArgs=m.subArgs.map(function(l){return o(l)})),p},[]),y=(0,s.useCallback)(function(m,p,l){return l>p.length?m:m.map(function(j){if(j.key===p[l].key){var T=h()(h()({},j),{},{require:!0});return l<p.length-1&&j.subArgs?h()(h()({},T),{},{subArgs:y(j.subArgs,p,l+1)}):T}return j})},[]),I=(0,s.useCallback)(function(m,p){return m.map(function(l){return l.key===p.key?p:l.subArgs?h()(h()({},l),{},{subArgs:I(l.subArgs,p)}):l})},[]),x=(0,s.useCallback)(function(){var m=q()(K()().mark(function p(l,j){var T,d,k;return K()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!j){f.next=7;break}if(d=u(i.current,l.key),d){f.next=4;break}return f.abrupt("return");case 4:T=y(i.current,d,0),f.next=9;break;case 7:k=o(l),T=I(i.current,k);case 9:t(T),a(!0);case 11:case"end":return f.stop()}},p)}));return function(p,l){return m.apply(this,arguments)}}(),[i.current,u,y,o,I,t,a]);return(0,s.useEffect)(function(){return i.current=n,function(){i.current=[]}},[n]),(0,s.useMemo)(function(){return{updateRequireStatus:x}},[x,n,t,a])},Dr=function C(n,t,r,a,i,u){return n.map(function(o){if(o.key===t){var y=h()(h()({},o),{},tn()(tn()({},r,a),"bindValueType",i||o.bindValueType));return u&&(y.dataType=u),y}return o.subArgs?h()(h()({},o),{},{subArgs:C(o.subArgs,t,r,a,i,u)}):o})},Tr=function C(n,t){return n.filter(function(r){return r.key===t?!1:(r.subArgs&&(r.subArgs=C(r.subArgs,t)),!0)})},kr=function C(n,t,r){return n.map(function(a){return a.key===t?h()(h()({},a),{},{subArgs:[].concat(G()(a.subArgs||[]),[r])}):a.subArgs?h()(h()({},a),{},{subArgs:C(a.subArgs,t,r)}):a})},fa=function C(n){return n.map(function(t){var r=h()(h()({},t),{},{key:t.key||(0,Ee.Z)()});return r.subArgs&&r.subArgs.length>0&&(r.subArgs=C(r.subArgs)),r})},wr=function(n,t,r){var a=(0,s.useState)([]),i=z()(a,2),u=i[0],o=i[1],y=(0,s.useState)([]),I=z()(y,2),x=I[0],m=I[1],p=(0,ke.useModel)("workflow"),l=p.setIsModified;(0,s.useEffect)(function(){var P=n?fa((0,Be.Xh)(n)):[];o(P)},[]);var j=(0,s.useCallback)(function(P){return t.setFieldValue(r,P),l(!0),P},[t,r,l]),T=(0,s.useCallback)(function(P,Z){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,V=et()(P),L;try{for(V.s();!(L=V.n()).done;){var R=L.value;if(R.key===Z)return D;if(R.subArgs){var U=T(R.subArgs,Z,D+1);if(U)return U}}}catch(J){V.e(J)}finally{V.f()}return 0},[]),d=(0,s.useCallback)(function(P){var Z=[];return P.forEach(function(D){D.subArgs&&D.subArgs.length>0&&(Z.push(D.key),Z.push.apply(Z,G()(d(D.subArgs))))}),Z},[]),k=(0,s.useCallback)(function(P){var Z=fa(P);o(Z),j(Z)},[j]),g=(0,s.useCallback)(function(){var P={key:(0,Ee.Z)(),name:"",description:"",dataType:N.Gi.String,require:!1,systemVariable:!1,bindValueType:"Input",bindValue:""};o(function(Z){var D=[].concat(G()(Z),[P]);return j(D)})},[j]),f=(0,s.useCallback)(function(P){o(function(Z){var D=T(Z,P);if(D>=4)return Z;var V={key:(0,Ee.Z)(),name:"",description:null,dataType:N.Gi.String,require:!1,systemVariable:!1,bindValueType:"Input",bindValue:""},L=kr(Z,P,V);return j(L)}),m(function(Z){return Array.from(new Set([].concat(G()(Z),[P])))})},[T,j]),c=(0,s.useCallback)(function(P){o(function(Z){var D=Tr(Z,P);return j(D)})},[j]),S=(0,s.useCallback)(function(P,Z,D,V,L){o(function(R){var U=Dr(R,P,Z,D,V,L);return j(U)})},[j]),w=(0,s.useMemo)(function(){return d(u)},[u,d]);return(0,s.useEffect)(function(){m(w)},[w]),(0,s.useMemo)(function(){return{treeData:u,expandedKeys:x,setExpandedKeys:m,addRootNode:g,addChildNode:f,deleteNode:c,updateNodeField:S,getNodeDepth:T,updateTreeData:k}},[u,x,m,g,f,c,S,T,k])},ga=function(n){var t=n.params,r=n.form,a=n.title,i=n.inputItemName,u=i===void 0?"inputArgs":i,o=n.notShowTitle,y=n.showCheck,I=n.isBody,x=n.isNotAdd,m=wr(t,r,u),p=m.treeData,l=m.expandedKeys,j=m.setExpandedKeys,T=m.addRootNode,d=m.addChildNode,k=m.deleteNode,g=m.updateNodeField,f=m.updateTreeData,c=Ar(p,f),S=c.updateRequireStatus,w=(0,s.useCallback)(T,[T]),P=(0,s.useCallback)(function(D,V){return I?(0,e.jsx)(Ir,{nodeData:D,showCheck:y,onUpdateField:g,onAddChild:d,onDelete:k,onUpdateRequire:S}):(0,e.jsx)(Er,{nodeData:D,form:r,showCheck:y,isNotAdd:x,onUpdateField:g,onAddChild:d,onDelete:k,onUpdateRequire:S},"treeNodeTitle-".concat(D.key||V))},[I,y,r,x,g,d,k,S]),Z=!x&&(!o||r.getFieldValue("outputType")==="JSON");return(0,e.jsxs)("div",{children:[(0,e.jsx)(jr,{title:a,form:r,notShowTitle:o,showAddButton:Z,onChange:function(V){return f(V)},onAddRoot:w}),p&&p.length>0&&(0,e.jsx)(yr,{showCheck:y,isBody:I}),(0,e.jsx)(At.Z,{switcherIcon:(0,e.jsx)(Wt.Z,{}),defaultExpandAll:!0,defaultExpandParent:!0,blockNode:!0,expandedKeys:l,treeData:p,fieldNames:{title:"name",key:"key",children:"subArgs"},onExpand:function(V){return j(V)},titleRender:function(V){return P(V,V.key)},className:"".concat(p.find(function(D){return D.subArgs&&D.subArgs.length>0})?"tree-form-style":"tree-form-style-no-child")})]})};ga.displayName="CustomTree";var nt=ga,Rr=function(n){var t=[{label:"OpenAI",options:[]},{label:"Ollama",options:[]}];return n.forEach(function(r){var a=t.find(function(i){return i.label===r.apiProtocol});a&&a.options.push(r)}),t},Br=E(48939),Zr=E(94855),Pr=E(88958),$t=E(63960),Gt=E(44384),hn=E(6619),Lr=function(n){var t=n.item,r=t.icon,a=t.name,i=t.description;return(0,e.jsxs)("div",{className:"dis-left model-list-item-style",children:[(0,e.jsx)("img",{src:r,alt:""}),(0,e.jsxs)("div",{className:"dis-col",children:[(0,e.jsx)("div",{className:"dis-left",children:(0,e.jsx)("span",{className:"model-list-item-label",children:a})}),(0,e.jsx)("span",{className:"model-list-item-desc text-ellipsis-2",children:i})]})]})},Or=Lr,Mr=function(n){var t=n.form,r=n.modelConfig,a=(0,s.useState)([]),i=z()(a,2),u=i[0],o=i[1],y=(0,s.useState)([]),I=z()(y,2),x=I[0],m=I[1],p=(0,s.useState)(!1),l=z()(p,2),j=l[0],T=l[1],d=(0,ke.useParams)(),k=d.spaceId,g=function(){var c=q()(K()().mark(function S(){var w;return K()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,T(!0),Z.next=4,qe.ZP.getModelListByWorkflowId({modelType:"Chat",spaceId:k});case 4:w=Z.sent,o(w.data),m(Rr(w.data)),Z.next=12;break;case 9:Z.prev=9,Z.t0=Z.catch(0),console.error("Failed to fetch graph data:",Z.t0);case 12:return Z.prev=12,T(!1),Z.finish(12);case 15:case"end":return Z.stop()}},S,null,[[0,9,12,15]])}));return function(){return c.apply(this,arguments)}}(),f=function(S){if(t.getFieldValue("modelId")===null)return null;var w=[].concat(G()(u),[r?.id!==void 0?{id:r?.id,name:r?.name}:{}]).find(function(P){return P.id===Number(S.value)});return(0,e.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,e.jsx)("span",{children:w&&w.name||""})})};return(0,s.useEffect)(function(){g()},[]),(0,e.jsx)(F.Z.Item,{name:"modelId",children:(0,e.jsx)($e.default,{placeholder:"\u8BF7\u9009\u62E9\u6A21\u578B",style:{width:"100%",marginTop:"10px"},className:"input-style",labelRender:f,placement:"bottomLeft",popupMatchSelectWidth:!1,loading:j,children:x?.map(function(c,S){return(0,e.jsx)(s.Fragment,{children:c.options.map(function(w,P){return(0,e.jsx)($e.default.Option,{value:w.id,label:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[w.icon&&(0,e.jsx)("img",{src:w.icon,alt:"",style:{width:"20px",height:"20px",marginRight:"8px"}}),(0,e.jsx)("span",{children:w.name})]}),children:(0,e.jsx)(Or,{item:w})},"".concat(S,"-").concat(P))})},"model-options-".concat(S))})})})},Vr=[{label:"\u7CBE\u786E\u6A21\u5F0F",value:"Precision"},{label:"\u5E73\u8861\u6A21\u5F0F",value:"Balanced"},{label:"\u521B\u610F\u6A21\u5F0F",value:"Creative"},{label:"\u81EA\u5B9A\u4E49",value:"Customization"}],ma={Precision:{temperature:.1,topP:.7,maxTokens:1024},Balanced:{temperature:1,topP:.7,maxTokens:1024},Creative:{temperature:1,topP:.8,maxTokens:1024}},Ht=function(n){var t=n.title,r=n.configKey,a=n.content,i=n.min,u=n.max,o=n.step,y=n.form,I=function(m){m!==null&&y.setFieldsValue(tn()(tn()({},r,m),"mode","Customization"))};return(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsxs)("div",{className:"dis-left label-style",children:[(0,e.jsx)("span",{className:"mr-16",children:t}),(0,e.jsx)(hn.Z,{title:a,icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsx)(F.Z.Item,{style:{marginBottom:"0",flex:1},noStyle:!0,children:(0,e.jsxs)(Pr.Z,{gap:"middle",children:[(0,e.jsx)(F.Z.Item,{name:r,noStyle:!0,children:(0,e.jsx)($t.Z,{min:i,max:u,className:"slider-style",step:o,value:y.getFieldValue(r),onChange:I,style:{width:280}})}),(0,e.jsx)(F.Z.Item,{name:r,children:(0,e.jsx)(Yn.Z,{min:i,max:u,step:o,size:"small",style:{margin:"0 16px"},className:"input-style",value:y.getFieldValue(r),onChange:I})})]})})]})},Ur=function(n){var t=n.form,r=(0,s.useState)(!0),a=z()(r,2),i=a[0],u=a[1],o=F.Z.useWatch("mode",t),y=function(d){if(d!=="Customization"&&ma[d]){var k=ma[d],g=k.temperature,f=k.topP,c=k.maxTokens;t.setFieldsValue({temperature:g,topP:f,maxTokens:c,mode:d})}else t.setFieldsValue({mode:"Customization"})},I=(0,s.useState)(4093),x=z()(I,2),m=x[0],p=x[1],l=(0,ke.useParams)(),j=l.spaceId;return(0,s.useEffect)(function(){var T=function(){var d=q()(K()().mark(function k(){var g,f,c,S;return K()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return f=t.getFieldsValue(!0),c=f.modelId,P.next=3,qe.ZP.getModelListByWorkflowId({modelType:"Chat",spaceId:j});case 3:S=P.sent,p(((g=S.data.find(function(Z){return Z.id===c}))===null||g===void 0?void 0:g.maxTokens)||4093);case 5:case"end":return P.stop()}},k)}));return function(){return d.apply(this,arguments)}}();T()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"model-dispose-mode-style",children:[(0,e.jsx)("div",{className:"model-title-style border-bottom",children:"\u6A21\u578B"}),(0,e.jsxs)("div",{className:"dis-sb margin-top-10",children:[(0,e.jsx)("span",{className:"dispose-title-style",children:"\u751F\u6210\u591A\u6837\u6027"}),(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)(F.Z.Item,{name:"mode",style:{marginBottom:0},children:(0,e.jsx)(Hn.ZP.Group,{optionType:"button",className:"radio-button-style",options:Vr,onChange:function(d){return y(d.target.value)},value:o,block:!0})}),(0,e.jsxs)("div",{onClick:function(){return u(!i)},className:"right-content-style",children:[(0,e.jsx)("span",{children:"\u9AD8\u7EA7\u8BBE\u7F6E"}),i?(0,e.jsx)(Br.Z,{}):(0,e.jsx)(Zr.Z,{})]})]})]}),(0,e.jsxs)("div",{style:{display:i?"block":"none"},children:[(0,e.jsx)(Ht,{form:t,min:0,max:1,step:.1,title:"\u751F\u6210\u968F\u673A\u6027",configKey:"temperature",content:"temperature: \u8C03\u9AD8\u6E29\u5EA6\u4F1A\u4F7F\u5F97\u6A21\u578B\u7684\u8F93\u51FA\u66F4\u591A\u6837\u6027\u548C\u521B\u65B0\u6027\uFF0C\u53CD\u4E4B\uFF0C\u964D\u4F4E\u6E29\u5EA6\u4F1A\u4F7F\u8F93\u51FA\u5185\u5BB9\u66F4\u52A0\u9075\u5FAA\u6307\u4EE4\u8981\u6C42\u4F46\u51CF\u5C11\u591A\u6837\u6027\u3002\u5EFA\u8BAE\u4E0D\u8981\u4E0E 'Top p' \u540C\u65F6\u8C03\u6574\u3002"}),(0,e.jsx)(Ht,{form:t,min:0,max:1,step:.1,title:"Top P",configKey:"topP",content:"Top p \u4E3A\u7D2F\u8BA1\u6982\u7387: \u6A21\u578B\u5728\u751F\u6210\u8F93\u51FA\u65F6\u4F1A\u4ECE\u6982\u7387\u6700\u9AD8\u7684\u8BCD\u6C47\u5F00\u59CB\u9009\u62E9\uFF0C\u76F4\u5230\u8FD9\u4E9B\u8BCD\u6C47\u7684\u603B\u6982\u7387\u7D2F\u79EF\u8FBE\u5230 Top p \u503C\u3002\u8FD9\u6837\u53EF\u4EE5\u9650\u5236\u6A21\u578B\u53EA\u9009\u62E9\u8FD9\u4E9B\u9AD8\u6982\u7387\u7684\u8BCD\u6C47\uFF0C\u4ECE\u800C\u63A7\u5236\u8F93\u51FA\u5185\u5BB9\u7684\u591A\u6837\u6027\u3002\u5EFA\u8BAE\u4E0D\u8981\u4E0E '\u751F\u6210\u968F\u673A\u6027' \u540C\u65F6\u8C03\u6574\u3002"})]}),(0,e.jsx)(Gt.Z,{}),(0,e.jsx)("div",{className:"dispose-title-style",children:"\u8F93\u5165\u53CA\u8F93\u51FA\u8BBE\u7F6E"}),(0,e.jsx)(Ht,{form:t,min:5,max:m,step:1,title:"\u6700\u5927\u56DE\u590D\u957F\u5EA6",configKey:"maxTokens",content:"\u63A7\u5236\u6A21\u578B\u8F93\u51FA\u7684 Tokens \u957F\u5EA6\u4E0A\u9650\u3002\u901A\u5E38 100 Tokens \u7EA6\u7B49\u4E8E 150 \u4E2A\u4E2D\u6587\u6C49\u5B57\u3002"})]})})},zt=function(n){var t=n.form,r=n.modelConfig;return(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u6A21\u578B"}),(0,e.jsx)(Re.Z,{content:(0,e.jsx)(Ur,{form:t}),trigger:"click",placement:"left",children:(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Dt.Z,{}),size:"small"})})]}),(0,e.jsx)(Mr,{form:t,modelConfig:r})]})},Wr=E(84720),_r=E(40677),xn={"xagi-nav-style2":"xagi-nav-style2___N4a9l",text:"text___t3rIt","page-container":"page-container___spPC0","skill-list":"skill-list___myZuC","skill-dispose-modal-style":"skill-dispose-modal-style___vhnmJ","ant-modal-header":"ant-modal-header___xYl_z","ant-modal-content":"ant-modal-content___s2QyI","ant-modal-footer":"ant-modal-footer___zkcBw","skill-item-dispose-mask":"skill-item-dispose-mask___UWhqe","skill-item-container":"skill-item-container___suWbg","skill-item-style":"skill-item-style___Yzmv7","skill-item-icon":"skill-item-icon___bOVOI","skill-item-content-style":"skill-item-content-style___hAIJw","skill-item-title-style":"skill-item-title-style___hdurd","skill-item-desc-style":"skill-item-desc-style___s7EZB","mask-layer-style":"mask-layer-style___c42Qv","skill-params-description":"skill-params-description___NiVJd","skill-dispose-container":"skill-dispose-container___lkRrz","skill-dispose-left":"skill-dispose-left___TfYks","skill-dispose-left-title":"skill-dispose-left-title___C0Eun","skill-menu-style":"skill-menu-style___M8lz5","select-menu":"select-menu___ENzUV","skill-dispose-right":"skill-dispose-right___dSXOM","content-title-style":"content-title-style___hwirH","content-item-style":"content-item-style___iS0xn","content-center-item-style":"content-center-item-style___VjZoq","content-right-item-style":"content-right-item-style___r2QbX","output-style":"output-style___K0ods","output-remark-style":"output-remark-style___IOtW4","tree-title-style":"tree-title-style___Jw5lz",white:"white___ZOJgo","skill-tree":"skill-tree____z6Lg","dis-no-wrap":"dis-no-wrap___vOvTN","database-tag-style":"database-tag-style___SAQdi","background-c9":"background-c9___lgoPg"},Tt=E(14719),Kr=E(64807),yt={"xagi-nav-style2":"xagi-nav-style2___kiCQ1",text:"text___tfUd4","page-container":"page-container___xbTTe","modal-container":"modal-container___vk9mh",container:"container___O4FsC",left:"left___UJiFa",right:"right___u_Jgi",close:"close___sIdxz"},kt=me().bind(yt),$r=function(n){var t=n.open,r=n.inputArgBindConfigs,a=n.variables,i=n.onCancel,u=n.onSave,o=function(I){u(I)};return(0,e.jsx)(Tt.Z,{centered:!0,open:t,onCancel:i,className:kt(yt["modal-container"]),modalRender:function(){return(0,e.jsxs)("div",{className:kt(yt.container,"overflow-hide","flex","flex-col"),children:[(0,e.jsx)("div",{className:kt("flex-1",yt.right),children:(0,e.jsx)(Kr.Z,{style:{paddingTop:"48px"},variables:a,inputArgBindConfigs:r,onSaveSet:o})}),(0,e.jsx)(Dn.Z,{className:kt(yt.close,"cursor-pointer"),onClick:i})]})}})},Gr=$r,rn=me().bind(xn),ha=function(n,t){return n.length>t?n.slice(0,t)+"...":n},Hr=function(n){var t=n.params;return(0,e.jsx)("div",{style:{maxWidth:"300px"},children:(t||[]).map(function(r){return(0,e.jsxs)("div",{style:{padding:"3px 0"},children:[(0,e.jsxs)("div",{className:rn("dis-left"),children:[(0,e.jsx)("span",{className:rn("mr-16"),children:ha(r.name,30)}),(0,e.jsx)(Ye.Z,{color:"#C9CDD4",children:r.dataType})]}),(0,e.jsx)("p",{className:rn(xn["skill-params-description"]),children:ha(r.description||"",70)})]},r.name)})})},zr=function(n){var t=n.params,r=n.disabled,a=r===void 0?!1:r,i=n.removeItem,u=n.modifyItem,o=n.variables,y=o===void 0?[]:o,I=n.loading,x=I===void 0?!1:I,m=(0,s.useState)(null),p=z()(m,2),l=p[0],j=p[1],T=(0,s.useState)(!1),d=z()(T,2),k=d[0],g=d[1],f=(0,s.useState)(!1),c=z()(f,2),S=c[0],w=c[1],P=function(U){i(U)},Z=function(U){u(h()(h()({},l),{},{inputArgBindConfigs:U.inputArgBindConfigs})),g(!1),j(null)},D=function(U){var J=U.inputArgBindConfigs,X=(0,_r.T6)(J||[]);j(h()(h()({},U),{},{inputArgBindConfigs:X})),g(!0)},V=function(U){return l?.typeId===U.typeId&&(l?.toolName||"")===(U.toolName||"")},L=(0,s.useCallback)(function(R,U){return"".concat(U,"-").concat(R?.type,"-").concat(R?.typeId,"-").concat(R?.toolName||"")},[]);return(0,e.jsxs)("div",{className:rn(xn["skill-list"],"relative"),children:[t.length&&(0,e.jsx)(la.Z,{spinning:x,delay:200,style:{display:x?"block":"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3}})||null,t.map(function(R,U){return(0,e.jsx)("div",{className:rn(xn["skill-item-container"],U===0&&"margin-top-10"),children:(0,e.jsxs)("div",{className:rn(xn["skill-item-style"],"dis-left"),style:{opacity:a?.5:1,cursor:a?"not-allowed":"pointer"},onMouseEnter:function(){j(R),w(!0)},onMouseLeave:function(){return w(!1)},children:[(0,e.jsx)("img",{src:R.icon||(0,se.Pk)(R.targetType),alt:"",className:rn(xn["skill-item-icon"])}),(0,e.jsxs)("div",{className:rn(xn["skill-item-content-style"]),children:[(0,e.jsx)("div",{className:rn(xn["skill-item-title-style"]),children:R.name}),(0,e.jsx)("div",{className:rn(xn["skill-item-desc-style"]),children:R.description})]}),V(R)&&S&&(0,e.jsx)("div",{className:rn(xn["mask-layer-style"]),children:(0,e.jsxs)("div",{className:rn(xn["skill-item-dispose-style"],xn["skill-item-dispose-mask"]),children:[R.inputArgBindConfigs&&R.inputArgBindConfigs.length&&(0,e.jsx)(Re.Z,{content:(0,e.jsx)(Hr,{params:R.inputArgBindConfigs}),placement:"right",trigger:"hover",children:(0,e.jsx)(En.Z,{className:rn("white")})}),(0,e.jsx)(Re.Z,{content:"\u7F16\u8F91\u53C2\u6570",trigger:"hover",children:(0,e.jsx)(Dt.Z,{className:rn("ml-12 cursor-pointer white"),onClick:function(){D(R),g(!0)}})}),!a&&(0,e.jsx)(Re.Z,{content:"\u79FB\u9664",trigger:"hover",children:(0,e.jsx)(qn.Z,{className:rn("ml-12  white"),onClick:function(){return P(R)}})})]})})]})},L(R,"skill"))}),(0,e.jsx)(Gr,{open:k,variables:y,inputArgBindConfigs:l?.inputArgBindConfigs,onSave:Z,onCancel:function(){return g(!1)}},L(l,"setting"))]})},Qt=E(63136),Nt=E(20860),wt=E(65173),ln=function(n){var t=n.title,r=n.fieldConfigs,a=n.form,i=n.inputItemName,u=i===void 0?"inputArgs":i,o=n.showCopy,y=o===void 0?!1:o,I=n.disabledAdd,x=n.disabledDelete,m=n.disabledInput,p=n.isLoop,l=(0,ke.useModel)("workflow"),j=l.volid,T=r.reduce(function(d,k){return d[k.name]=null,d},{});return(0,s.useEffect)(function(){j&&a.validateFields()},[j]),(0,e.jsx)("div",{className:"form-list-style",children:(0,e.jsx)(F.Z.List,{name:u,children:function(k,g){var f=g.add,c=g.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"dis-sb ",children:[(0,e.jsx)("span",{className:"node-title-style gap-6 flex items-center",children:t}),!I&&(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),onClick:function(){return f(T)},size:"small",type:"text"})]}),k.map(function(S,w){var P=a.getFieldValue([u,S.name,"bindValueType"]);return(0,e.jsxs)("div",{children:[w===0&&(0,e.jsxs)("div",{className:"font-color-gray07 font-12 mt-6",children:[(0,e.jsx)("span",{children:"\u53C2\u6570\u540D"}),(0,e.jsx)("span",{style:{marginLeft:"22%"},children:"\u53D8\u91CF\u503C"})]}),(0,e.jsx)(F.Z.Item,{children:(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)(F.Z.Item,{label:"\u53C2\u6570\u540D",name:[S.name,"name"],noStyle:!0,children:(0,e.jsx)(Fe.Z,{size:"small",style:{width:"30%",marginRight:"10px"},placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D",disabled:m})}),(0,e.jsx)(F.Z.Item,{name:[S.name,"bindValue"],noStyle:!0,children:(0,e.jsx)(wt.Z,{form:a,fieldName:[u,S.name,"bindValue"],style:{flex:1,marginRight:"10px"},referenceType:P,isLoop:p})}),(0,e.jsx)(F.Z.Item,{name:[S.name,"bindType"],noStyle:!0,hidden:!0,children:(0,e.jsx)(Fe.Z,{type:"hidden"})}),y&&(0,e.jsx)(Re.Z,{content:(0,e.jsx)(F.Z.Item,{name:[S.name,"description"],noStyle:!0,children:(0,e.jsx)(Fe.Z.TextArea,{autoSize:{minRows:3,maxRows:5}})}),trigger:"click",children:(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(_t.Z,{}),className:"margin-right",size:"small",type:"text"})}),!x&&(0,e.jsx)(F.Z.Item,{name:[S.name,"require"],noStyle:!0,children:(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(qn.Z,{}),size:"small",type:"text",onClick:function(){return c(S.name)}})})]})},S.key)]},S.name)})]})}})})},Qr=function(n){var t=n.title,r=n.inputItemName,a=r===void 0?"conditionArgs":r,i=n.disabledAdd,u=n.disabledDelete,o=n.disabledInput;return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.Z.List,{name:a,children:function(I,x){var m=x.add,p=x.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:t}),!i&&(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),size:"small",type:"text",onClick:function(){return m({key:(0,Ee.Z)(),name:"",bindValue:"",dataType:N.Gi.String})}})]}),I.map(function(l,j){return(0,e.jsxs)("div",{children:[j===0&&(0,e.jsxs)("div",{className:"font-color-gray07",children:[(0,e.jsx)("span",{children:"\u53C2\u6570\u540D"}),(0,e.jsx)("span",{style:{marginLeft:"20%"},children:"\u53D8\u91CF\u503C"})]}),(0,e.jsx)(F.Z.Item,{children:(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)(F.Z.Item,{label:"\u53C2\u6570\u540D",name:[l.name,"name"],noStyle:!0,children:(0,e.jsx)(Fe.Z,{size:"small",style:{width:"30%",marginRight:"10px"},placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D",disabled:o})}),(0,e.jsx)(F.Z.Item,{label:"\u53D8\u91CF\u540D",name:[l.name,"bindValue"],noStyle:!0,children:(0,e.jsx)(Fe.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u503C",size:"small",style:{width:"55%",marginRight:"10px"}})}),!u&&(0,e.jsx)(F.Z.Item,{noStyle:!0,children:(0,e.jsx)(qn.Z,{onClick:function(){return p(l.name)}})})]})},l.key)]},l.key)})]})}})})},tt=function(n){var t=n.treeData,r=(0,s.useState)([]),a=z()(r,2),i=a[0],u=a[1];(0,s.useEffect)(function(){var y=function I(x){var m=[];return x.forEach(function(p){p.subArgs&&p.subArgs.length>0&&(m.push(p.key),m.push.apply(m,G()(I(p.subArgs))))}),m};u(y(t))},[t]);var o=function y(I){return I.map(function(x){return h()(h()({},x),{},{title:(0,e.jsxs)("span",{children:[x.name," ",(0,e.jsx)(Ye.Z,{color:"#C9CDD4",style:{marginLeft:"5px"},children:Xn.zx[x.dataType]})]}),children:x.subArgs?y(x.subArgs):void 0})})};return(0,e.jsx)(At.Z,{showLine:!0,expandedKeys:i,onExpand:function(I){return u(I)},switcherIcon:(0,e.jsx)(Wt.Z,{}),treeData:o(t),defaultExpandAll:!0})},al=function(n){var t=n.options,r=n.placeholder,a=n.onChange,i=function(y){a&&a(y)},u=function(y){return _jsx(Select.Option,{value:y.value,children:_jsxs("span",{className:"option-container",children:[_jsx(Checkbox,{}),_jsx("span",{children:y.label})]})},y.value)};return _jsx(Select,{mode:"multiple",showSearch:!0,placeholder:r,optionLabelProp:"label",onChange:i,filterOption:function(y,I){var x;return I==null||(x=I.props.children)===null||x===void 0?void 0:x.toString().toLowerCase().includes(y?.toLowerCase())},popupRender:function(y){return _jsx("div",{className:"custom-dropdown",children:React.cloneElement(y,{className:"".concat(y.props.className," custom-menu")})})},tokenSeparators:[","],style:{width:"100%"},children:t.map(u)})},xa=function(n){var t=n.form,r=n.title,a=n.field,i=n.inputItemName,u=i===void 0?"inputArgs":i,o=n.showIndex,y=n.limitAddLength,I=y===void 0?-1:y,x=(0,s.useState)(!1),m=z()(x,2),p=m[0],l=m[1],j=F.Z.useWatch(u,{form:t,preserve:!0});return(0,s.useEffect)(function(){I>-1&&l((j?.length||0)>=I)},[j,t,I]),(0,e.jsx)(F.Z.List,{name:u,children:function(d,k){var g=k.add,f=k.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:r}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),size:"small",type:"text",disabled:p,onClick:function(){var S=t.getFieldValue(u)||[],w=Math.max(0,S.length-1);g(tn()(tn()(tn()(tn()({},a,""),"index",S.length),"nextNodeIds",[]),"uuid",(0,Ee.Z)()),w),t.submit()}})]}),d.map(function(c,S){var w=!1;return t.getFieldValue([u,c.name,"intentType"])==="OTHER"&&(w=!0),t.getFieldValue([u,c.name,"content"])==="\u6B64\u9009\u9879\u7528\u6237\u4E0D\u53EF\u89C1\uFF0C\u7528\u6237\u56DE\u590D\u65E0\u5173\u5185\u5BB9\u65F6\u8D70\u6B64\u5206\u652F"&&(w=!0),(0,e.jsx)(F.Z.Item,{children:(0,e.jsxs)("div",{className:"dis-left",children:[o&&(0,e.jsx)(F.Z.Item,{noStyle:!0,name:[c.name,"index"],children:(0,e.jsx)("span",{className:"mr-16",children:Ze.bQ[S]})}),(0,e.jsx)(F.Z.Item,{name:[c.name,a],className:"flex-1",children:(0,e.jsx)(Fe.Z,{disabled:w,onBlur:function(){t.submit()}})}),!w&&d.length>2&&(0,e.jsx)(F.Z.Item,{noStyle:!0,children:(0,e.jsx)(qn.Z,{className:"ml-10",onClick:function(){f(c.name),t.submit()}})})]})},c.name+"_"+Ze.bQ[S])})]})}})},rl=function(n){var t=n.form,r=n.title,a=n.inputItemName;return _jsx(_Fragment,{children:_jsx(Form.List,{name:a,children:function(u){return _jsxs(_Fragment,{children:[_jsx("span",{className:"node-title-style",children:r}),u.map(function(o,y){var I=t.getFieldValue([a,o.name,"bindValueType"]);return _jsxs("div",{children:[y===0&&_jsxs(_Fragment,{children:[_jsx("span",{children:"\u53C2\u6570\u540D"}),_jsx("span",{style:{marginLeft:"25%"},children:"\u53C2\u6570\u503C"})]}),_jsx(Form.Item,{children:_jsxs("div",{className:"dis-left",children:[_jsx(Form.Item,{noStyle:!0,name:[o.name,"bindValue"],children:_jsxs("div",{className:"dis-left node-form-label-style",children:[_jsx("span",{className:"margin-right-6 font-12 form-name-style",children:t.getFieldValue([a,o.name,"name"])}),_jsx(Popover,{placement:"right",content:t.getFieldValue([a,o.name,"description"]),children:_jsx(InfoCircleOutlined,{className:"margin-right-6 font-12"})})]})}),_jsx(Form.Item,{name:[o.name,"bindValue"],noStyle:!0,children:_jsx(InputOrReference,{form:t,fieldName:[a,o.name,"bindValue"],style:{width:"65%"},referenceType:I})})]})},o.key)]},o.name)})]})}})})},Jr=[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"}],Xr=[{label:"\u65E0",value:N.lT.OTHER,style:{marginTop:3,marginBottom:3}},{label:"form-data",value:N.lT.FORM_DATA,style:{marginTop:3,marginBottom:3}},{label:"json",value:N.lT.JSON,style:{marginTop:3,marginBottom:3}},{label:"x-www-form-urlencoded",value:N.lT.X_WWW_FORM_URLENCODED,style:{marginTop:3,marginBottom:3}}],Yr=Xn.Ne.filter(function(C){return[Se.qR.Plugin,Se.qR.Workflow,Se.qR.MCP].includes(C.key)}),qr=function(n){var t=n.form,r=n.id,a=n.nodeConfig,i=n.type,u=(0,s.useState)(!1),o=z()(u,2),y=o[0],I=o[1],x=(0,s.useState)(!1),m=z()(x,2),p=m[0],l=m[1],j=(0,s.useState)([]),T=z()(j,2),d=T[0],k=T[1],g=(0,s.useState)(!1),f=z()(g,2),c=f[0],S=f[1],w=(0,s.useRef)(),P=(0,ke.useModel)("workflow"),Z=P.setSkillChange,D=P.setIsModified,V=P.skillChange,L=(0,s.useState)(!1),R=z()(L,2),U=R[0],J=R[1],X=function(re,te){var Y=re?.map(function(ae){return{type:ae.type,targetId:Number(ae.typeId),status:te(ae),toolName:ae.toolName||""}})||[];k(Y)},ee=function(re){var te=t.getFieldValue(Ze.Fw)||[];re.type=re.targetType,re.typeId=re.targetId,t.setFieldValue(Ze.Fw,te.concat([re])),D(!0),t.submit(),S(!0)};(0,s.useEffect)(function(){return V?w.current=setTimeout(function(){J(!0)},300):(clearTimeout(w.current),J(!1)),function(){clearTimeout(w.current)}},[V]);var ne=function(re){var te=t.getFieldValue(Ze.Fw);if(te){var Y=te.filter(function(ae){return!(ae.typeId===re.typeId&&(ae.toolName||"")===(re.toolName||""))});t.setFieldValue(Ze.Fw,Y),D(!0),Z(!0)}},ie=function(re){var te=t.getFieldValue(Ze.Fw);if(te){var Y=te.map(function(ae){return ae.typeId===re.typeId&&(ae.toolName||"")===(re.toolName||"")?re:ae});t.setFieldValue(Ze.Fw,Y),D(!0),Z(!0)}},de=function(){I(!0)},ge=t.getFieldValue(Ze.Fw);(0,s.useEffect)(function(){X(ge,function(){return Se.BQ.Added})},[ge]);var _e=(F.Z.useWatch(ce.dy.inputArgs,{form:t,preserve:!0})||[]).filter(function(ue){return!["",null,void 0].includes(ue.name)}),Cn=(0,s.useCallback)(function(){I(!1),c&&(S(!1),Z(!0),D(!0),t.submit())},[c,t,Z,S,I]),De=t.getFieldValue(Ze.Fw);return(0,e.jsxs)("div",{className:"model-node-style",children:[(0,e.jsx)(zt,{form:t,modelConfig:a?.modelConfig}),(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u6280\u80FD"}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),size:"small",onClick:de,type:"text"})]}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return De?(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(zr,{params:De,skillName:Ze.Fw,variables:_e,form:t,removeItem:ne,modifyItem:ie,loading:U})}):(0,e.jsx)(vn.Z,{})}}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Ct,{title:(0,e.jsxs)(e.Fragment,{children:["\u7CFB\u7EDF\u63D0\u793A\u8BCD",(0,e.jsx)(hn.Z,{title:"\u4E3A\u5BF9\u8BDD\u63D0\u4F9B\u7CFB\u7EDF\u7EA7\u6307\u5BFC\uFF0C\u5982\u8BBE\u5B9A\u4EBA\u8BBE\u548C\u56DE\u590D\u903B\u8F91\u3002",icon:(0,e.jsx)(Nt.Z,{})})]}),inputFieldName:"systemPrompt",onExpand:!0,onOptimize:!0,onOptimizeClick:function(){return l(!0)},placeholder:"\u7CFB\u7EDF\u63D0\u793A\u8BCD\uFF0C\u53EF\u4EE5\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u3001{{\u53D8\u91CF\u540D.\u5B50\u53D8\u91CF\u540D}}\u3001 {{\u53D8\u91CF\u540D[\u6570\u7EC4\u7D22\u5F15]}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u5165\u53C2\u6570\u4E2D\u7684\u53D8\u91CF"})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Ct,{title:(0,e.jsxs)(e.Fragment,{children:["\u7528\u6237\u63D0\u793A\u8BCD",(0,e.jsx)(hn.Z,{title:"\u5411\u6A21\u578B\u63D0\u4F9B\u7528\u6237\u6307\u4EE4\uFF0C\u5982\u67E5\u8BE2\u6216\u4EFB\u4F55\u57FA\u4E8E\u6587\u672C\u8F93\u5165\u7684\u63D0\u95EE\u3002",icon:(0,e.jsx)(Nt.Z,{})})]}),inputFieldName:"userPrompt",onExpand:!0,placeholder:"\u7528\u6237\u63D0\u793A\u8BCD\uFF0C\u53EF\u4EE5\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u3001{{\u53D8\u91CF\u540D.\u5B50\u53D8\u91CF\u540D}}\u3001 {{\u53D8\u91CF\u540D[\u6570\u7EC4\u7D22\u5F15]}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u5165\u53C2\u6570\u4E2D\u7684\u53D8\u91CF"})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,name:"outputArgs",children:(0,e.jsx)(nt,{title:"\u8F93\u51FA",notShowTitle:!0,form:t,params:a?.outputArgs||[],inputItemName:"outputArgs"},"".concat(i,"-").concat(r,"-outputArgs"))}),(0,e.jsx)(cn.Z,{checkTag:Se.qR.Plugin,onAdded:ee,open:y,addSkillLoading:U,onCancel:Cn,addComponents:d,tabs:Yr}),(0,e.jsx)(Wr.Z,{title:"\u63D0\u793A\u8BCD\u4F18\u5316",open:p,onCancel:function(){l(!1)},defaultValue:t.getFieldValue("systemPrompt")||"",onReplace:function(re){if(re){var te=re;te.includes("```")&&(te=te.replace(/```/g,"")),t.setFieldsValue({systemPrompt:te||""}),D(!0),l(!1)}},targetId:r,type:Qt.U.WORKFLOW_LLM_NODE})]})},ei=function(n){var t=n.form;return(0,e.jsxs)("div",{className:"model-node-style",children:[(0,e.jsx)(F.Z.Item,{noStyle:!0,children:(0,e.jsx)(zt,{form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(xa,{title:"\u610F\u56FE\u5339\u914D",form:t,field:"intent",hasUuid:!0,showIndex:!0,limitAddLength:26,inputItemName:ce.dy.intentConfigs})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Ct,{title:"\u8865\u5145\u63D0\u793A\u8BCD",inputFieldName:"systemPrompt",onExpand:!0,placeholder:"\u652F\u6301\u989D\u5916\u7684\u7CFB\u7EDF\u63D0\u793A\u8BCD\uFF0C\u5982\u5BF9\u610F\u56FE\u9009\u9879\u505A\u66F4\u8BE6\u7EC6\u7684\u4F8B\u5B50\u4EE5\u589E \u5F3A\u7528\u6237\u8F93\u51FA\u4E0E\u610F\u56FE\u5339\u914D\u7684\u6210\u529F\u7387\u3002"})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("outputArgs")})]})}})]})},ni=function(n){var t=n.form,r=n.nodeConfig,a=n.type,i=n.id,u=function(y){var I=t.getFieldValue("options");if(y==="SELECT"&&(!I||!I.length)&&(I=[{uuid:(0,Ee.Z)(),index:0,content:"",nextNodeIds:[]},{uuid:(0,Ee.Z)(),index:1,content:"\u6B64\u9009\u9879\u7528\u6237\u4E0D\u53EF\u89C1\uFF0C\u7528\u6237\u56DE\u590D\u65E0\u5173\u5185\u5BB9\u65F6\u8D70\u6B64\u5206\u652F",nextNodeIds:[]}]),console.log("bb",y,t.getFieldValue("answerType")),y==="TEXT"){var x;I=(x=I)===null||x===void 0?void 0:x.map(function(m){return h()(h()({},m),{},{nextNodeIds:[]})})}t.setFieldsValue({answerType:y,options:I}),t.submit()};return(0,e.jsxs)("div",{className:"node-title-style",children:[(0,e.jsx)(zt,{form:t}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Ct,{title:"\u63D0\u95EE\u95EE\u9898",inputFieldName:"question",onExpand:!0,placeholder:"\u53EF\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u5165\u53C2\u6570\u4E2D\u7684\u53D8\u91CF"})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(F.Z.Item,{label:"\u56DE\u7B54\u7C7B\u578B",name:"answerType",children:(0,e.jsx)(Hn.ZP.Group,{onChange:function(y){return u(y.target.value)},children:(0,e.jsxs)(zn.Z,{direction:"vertical",children:[(0,e.jsx)(Hn.ZP,{value:"TEXT",children:"\u76F4\u63A5\u56DE\u7B54"}),(0,e.jsx)(Hn.ZP,{value:"SELECT",children:"\u9009\u9879\u56DE\u7B54"})]})})})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return t.getFieldValue("answerType")==="TEXT"?(0,e.jsx)(nt,{title:"\u8F93\u51FA",form:t,params:r?.outputArgs||[],inputItemName:"outputArgs",showCheck:!0},"".concat(a,"-").concat(i,"-outputArgs")):null}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return t.getFieldValue("answerType")==="SELECT"?(0,e.jsx)(xa,{title:"\u8BBE\u7F6E\u9009\u9879\u5185\u5BB9",form:t,field:"content",inputItemName:ce.dy.options,hasUuid:!0,showIndex:!0}):null}})]})},ti=function(n){var t=n.form,r=n.nodeConfig,a=n.type,i=n.id,u=r?.body||[],o=r?.outputArgs||[];return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(F.Z.Item,{label:"\u8BF7\u6C42\u65B9\u6CD5\u4E0E\u8DEF\u5F84",children:(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsx)(F.Z.Item,{name:"method",noStyle:!0,children:(0,e.jsx)($e.default,{style:{width:"30%",marginRight:"10px"},options:Jr,placeholder:"\u8BF7\u6C42\u65B9\u6CD5"})}),(0,e.jsx)(F.Z.Item,{name:"url",noStyle:!0,children:(0,e.jsx)(Fe.Z,{placeholder:"\u8BF7\u8F93\u5165url\u5730\u5740"})})]})})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(F.Z.Item,{name:"contentType",label:"\u8BF7\u6C42\u5185\u5BB9\u683C\u5F0F",children:(0,e.jsx)(Hn.ZP.Group,{className:"margin-bottom",options:Xr})})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(F.Z.Item,{label:"\u8BF7\u6C42\u8D85\u65F6\u914D\u7F6E",name:"timeout",children:(0,e.jsx)(Fe.Z,{placeholder:"\u8BF7\u8F93\u5165\u8D85\u65F6\u914D\u7F6E\u65F6\u957F",addonAfter:"s"})})}),(0,e.jsxs)("div",{className:"has-child-node",children:[(0,e.jsx)("p",{className:"node-title-bold-style",children:"\u5165\u53C2"}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"Header",fieldConfigs:Ue.x8,inputItemName:ce.dy.headers,form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"Query",form:t,fieldConfigs:Ue.x8,inputItemName:ce.dy.queries})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(nt,{title:"Body",form:t,inputItemName:"body",isBody:!0,params:u},"".concat(a,"-").concat(i,"-body"))})]}),(0,e.jsx)(F.Z.Item,{name:"outputArgs",children:(0,e.jsx)(nt,{title:"\u51FA\u53C2",form:t,inputItemName:"outputArgs",params:o},"".concat(a,"-").concat(i,"-outputArgs"))})]})},Rt={ModelNode:qr,IntentionNode:ei,QuestionsNode:ni,HttpToolNode:ti},Jt=E(33797),Xt=E(41295),ai=function(n){var t=n.form,r=function(i){if(i.destination){var u=t.getFieldValue("conditionBranchConfigs"),o=u.length-2;if(!(i.destination.index>o)){var y=u.splice(i.source.index,1),I=z()(y,1),x=I[0];u.splice(i.destination.index,0,x);var m=u.map(function(p,l){return h()(h()({},p),{},{branchType:l===0?"IF":l===u.length-1?"ELSE":"ELSE_IF"})});t.setFieldsValue({conditionBranchConfigs:m}),t.submit()}}};return(0,e.jsx)(Xt.Z5,{onDragEnd:r,children:(0,e.jsx)(F.Z.List,{name:"conditionBranchConfigs",children:function(i,u){var o=u.add,y=u.remove;return(0,e.jsx)(Xt.bK,{droppableId:"conditionBranches",children:function(x){return(0,e.jsxs)("div",h()(h()({},x.droppableProps),{},{ref:x.innerRef,children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u6761\u4EF6\u5206\u652F"}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),type:"text",onClick:function(){var p=t.getFieldValue("conditionBranchConfigs")||[],l=Math.max(0,p.length-1);o({uuid:(0,Ee.Z)(),conditionType:"AND",conditionArgs:[{compareType:"EQUAL",firstArg:{bindValue:""},secondArg:{bindValue:""}}],nextNodeIds:[],branchType:"ELSE_IF"},l),t.submit()}})]}),i.map(function(m,p){var l=p===i.length-1;if(!l){var j=t.getFieldValue(["conditionBranchConfigs",m.name]);return(0,e.jsx)(Xt._l,{draggableId:j.uuid,index:p,children:function(d){return(0,e.jsxs)("div",h()(h()({ref:d.innerRef},d.draggableProps),{},{className:"condition-card-style",children:[(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsxs)("div",h()(h()({className:"dis-left"},d.dragHandleProps),{},{style:{cursor:"grab",width:"100%"},children:[(0,e.jsx)("span",{className:"margin-right",children:Ze.Vy[j.branchType]}),(0,e.jsxs)(Ye.Z,{color:"#C9CDD4",children:["\u4F18\u5148\u7EA7",p+1]})]})),i.length>2&&(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Jt.Z,{}),type:"text",onClick:function(){if(y(m.name),m.name===0){var g=t.getFieldValue("conditionBranchConfigs")||[],f=g.map(function(c,S){return h()(h()({},c),{},{branchType:S===0?"IF":S===g.length-1?"ELSE":"ELSE_IF"})});t.setFieldsValue({conditionBranchConfigs:f})}t.submit()}})]}),(0,e.jsxs)(zn.Z,{children:[j.conditionArgs.length>1&&(0,e.jsx)(F.Z.Item,{noStyle:!0,shouldUpdate:function(g,f){var c,S;return((c=g.conditionBranchConfigs)===null||c===void 0||(c=c[m.name])===null||c===void 0?void 0:c.conditionArgs)!==((S=f.conditionBranchConfigs)===null||S===void 0||(S=S[m.name])===null||S===void 0?void 0:S.conditionArgs)},children:function(g){var f=g.getFieldValue,c=f(["conditionBranchConfigs",m.name,"conditionArgs"]);return c?.length>1&&(0,e.jsx)(F.Z.Item,{name:[m.name,"conditionType"],style:{marginTop:"-26px"},children:(0,e.jsx)($e.default,{style:{marginRight:"4px",width:54},options:[{label:"\u4E14",value:"AND"},{label:"\u6216",value:"OR"}]})})}}),p!==i.length-1&&(0,e.jsx)(F.Z.List,{name:[m.name,"conditionArgs"],children:function(g,f){return(0,e.jsxs)("div",{className:"position-relative",children:[(0,e.jsx)("div",{className:"dis-left",children:(0,e.jsx)("div",{className:"dis-col",children:g.map(function(c){var S=t.getFieldValue(["conditionBranchConfigs",m.name,"conditionArgs",c.name,"secondArg","bindValueType"]);return(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsx)(F.Z.Item,{name:[c.name,"compareType"],noStyle:!0,children:(0,e.jsx)($e.default,{popupMatchSelectWidth:!1,options:Ue.YM,optionLabelProp:"displayValue",style:{marginRight:"10px",width:54}})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(F.Z.Item,{name:[c.name,"firstArg","bindValue"],children:(0,e.jsx)(wt.Z,{isDisabled:!0,form:t,fieldName:["conditionBranchConfigs",m.name,"conditionArgs",c.name,"firstArg","bindValue"],placeholder:"\u8BF7\u5F15\u7528\u53C2\u6570",style:{width:g.length>1?150:180}})}),(0,e.jsx)(F.Z.Item,{name:[c.name,"secondArg","bindValue"],children:(0,e.jsx)(wt.Z,{form:t,referenceType:S,style:{width:g.length>1?150:180},fieldName:["conditionBranchConfigs",m.name,"conditionArgs",c.name,"secondArg","bindValue"]})})]}),g.length>1&&(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Jt.Z,{}),onClick:function(){f.remove(c.name)}})]},c.name)})})}),(0,e.jsx)(le.ZP,{type:"primary",onClick:function(){f.add({compareType:"EQUAL",firstArg:null,secondArg:null})},icon:(0,e.jsx)(mn.Z,{}),children:"\u65B0\u589E"})]})}})]})]}))}},j.uuid)}return(0,e.jsx)("div",{className:"condition-card-style",children:"\u5426\u5219"},m.name)}),x.placeholder]}))}})}})})},ri=ai,ii=function(n){var t=n.form,r=n.title,a=n.params,i=n.options,u=n.showAdd,o=n.showDelete,y=n.descText,I=y===void 0?"\u53D8\u91CF\u7C7B\u578B":y,x=n.nameText,m=x===void 0?"\u53D8\u91CF\u540D":x,p=(0,s.useState)(a||[]),l=z()(p,2),j=l[0],T=l[1],d=(0,ke.useModel)("workflow"),k=d.setIsModified,g=d.referenceList;(0,s.useEffect)(function(){a&&!lt().isEqual(a,j)&&T(a)},[a]);var f=function(V){T(V),t.setFieldValue("inputArgs",V),k(!0)},c=function(V,L,R){var U=function X(ee){return ee.map(function(ne){return ne.key===V?h()(h()({},ne),{},{bindValue:L,bindValueType:R}):ne.subArgs?h()(h()({},ne),{},{subArgs:X(ne.subArgs)}):ne})},J=U(j);f(J)},S=function(V){T(function(L){var R=[].concat(G()(L),[V]);return f(R),R})},w=function(V){var L=j.filter(function(R){return R.key!==V});f(L),k(!0)},P=(0,e.jsx)(e.Fragment,{children:i?.filter(function(D){return!j.some(function(V){return V.name===D.key})&&!D.systemVariable}).map(function(D){return(0,e.jsxs)("div",{className:"dis-sb cursor-pointer mb-6",onClick:function(){return S(D)},style:{width:220},children:[(0,e.jsx)("span",{children:D.name}),(0,e.jsx)(Ye.Z,{color:"#C9CDD4",children:D.dataType})]},D.key)})}),Z=function(V){return(0,e.jsxs)("div",{className:"dis-sb",style:{width:"100%"},children:[(0,e.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,e.jsx)("span",{className:"margin-right-6 font-12 ",children:V.name}),(0,e.jsx)(hn.Z,{title:V.description||"\u6682\u65E0\u63CF\u8FF0",icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsx)("div",{style:{width:"175px"},children:(0,e.jsx)(pa,{data:g,referenceType:V.bindValueType||"Input",onChange:function(R,U){c(V.key,R,U)},value:V.bindValue})}),o&&(0,e.jsx)(qn.Z,{style:{marginLeft:"6px"},onClick:function(){return w(V.key)}})]})};return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:r}),u&&(0,e.jsx)(Re.Z,{content:P,trigger:"click",children:(0,e.jsx)(le.ZP,{type:"text",size:"small",icon:(0,e.jsx)(mn.Z,{})})})]}),j&&j.length>0&&(0,e.jsxs)("div",{className:"dis-left font-12 mb-6 font-color-gray07",children:[(0,e.jsx)("span",{style:{marginLeft:"1%"},children:m}),(0,e.jsx)("span",{style:{marginLeft:o?"30%":"35%"},children:I})]}),(0,e.jsx)(At.Z,{treeData:j,defaultExpandAll:!0,fieldNames:{title:"name",key:"key",children:"subArgs"},titleRender:Z,switcherIcon:null,showIcon:!1,className:"tree-input-style"})]})},Yt=ii,il=E(43562),si=function(n){var t=n.icon,r=n.name,a=n.description,i=n.showParams,u=n.params,o=(0,s.useState)(!1),y=z()(o,2),I=y[0],x=y[1];return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"skill-item-style background-c9 dis-sb",children:(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("img",{src:!t||t===""?(0,se.Pk)(Se.qR.Table):t,alt:"",className:"skill-item-icon"}),(0,e.jsxs)("div",{className:"skill-item-content-style",children:[(0,e.jsx)("div",{className:"skill-item-title-style",children:r}),(0,e.jsx)("div",{className:"skill-item-desc-style",children:a})]})]})}),i&&u&&(0,e.jsx)("div",{children:I?(0,e.jsxs)("div",{className:"dis-wrap-sa margin-bottom",children:[u?.map(function(m){return(0,e.jsx)("div",{className:"database-tag-style",children:m},m)}),(0,e.jsx)("div",{onClick:function(){return x(!1)},className:"database-tag-style cursor-pointer",children:"\u6536\u8D77"})]}):(0,e.jsxs)("div",{className:"dis-left margin-bottom",children:[(0,e.jsx)("div",{className:"flex-1 dis-left dis-no-wrap ",children:u?.map(function(m){return(0,e.jsx)("div",{className:"database-tag-style",children:m},m)})}),(0,e.jsx)("div",{onClick:function(){return x(!0)},className:"database-tag-style cursor-pointer",children:"..."})]})})]})},oi=si,li=E(35044),ui=E(19979),Un={"xagi-nav-style2":"xagi-nav-style2___k1HI0",text:"text___MhtOa","page-container":"page-container___uMiaa",btn:"btn___Us0pI","chat-wrapper":"chat-wrapper___uSZyL","replace-btn":"replace-btn___SHOm4",footer:"footer____WBeJ","chat-input":"chat-input___nZ16_",input:"input___Gcyqk","icon-box":"icon-box___b3mce","send-image":"send-image___QdGwv"},at=me().bind(Un),di=function(n){var t,r,a=n.open,i=n.onCancel,u=n.onReplace,o=n.title,y=n.tableId,I=n.inputArgs,x=(0,s.useState)(""),m=z()(x,2),p=m[0],l=m[1],j=(0,ke.useModel)("assistantOptimize"),T=j.messageList,d=j.setMessageList,k=j.onMessageSend,g=j.messageViewRef,f=j.allowAutoScrollRef,c=j.resetInit,S=(0,s.useState)(""),w=z()(S,2),P=w[0],Z=w[1];(0,s.useEffect)(function(){return Z((0,Ee.Z)()),function(){c()}},[]),(0,s.useEffect)(function(){var L=g.current;if(L){var R=function(){var J=L.scrollTop,X=L.scrollHeight,ee=L.clientHeight;J+ee<X?f.current=!1:f.current=!0};return L.addEventListener("scroll",R),function(){L.removeEventListener("scroll",R)}}},[]);var D=function(){var L=q()(K()().mark(function R(U){var J;return K()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:d([]),l(""),J={requestId:P,prompt:U||p,tableId:y,inputArgs:I},k(J,Qt.L.sql);case 4:case"end":return ee.stop()}},R)}));return function(U){return L.apply(this,arguments)}}(),V=function(R){R.preventDefault();var U=R.target,J=U.value,X=U.selectionStart,ee=U.selectionEnd;if(R.nativeEvent.keyCode===13&&(R.nativeEvent.shiftKey||R.nativeEvent.ctrlKey)){var ne=J.slice(0,X)+`
`+J.slice(ee);l(ne)}else if(R.nativeEvent.keyCode===13&&J.trim()){var ie={requestId:P,prompt:p,tableId:y,inputArgs:I};k(ie,Qt.L.sql),l("")}};return(0,e.jsxs)(Tt.Z,{title:o,open:a,onCancel:function(R){d([]),i?.(R)},maskClosable:!1,footer:null,children:[(0,e.jsx)("div",{ref:g,className:at(Un["chat-wrapper"],"flex-1"),children:T?.length>0&&(0,e.jsx)(e.Fragment,{children:T?.map(function(L,R){return(0,e.jsx)(ui.Z,{ifShowReplace:!0,onReplace:u,messageInfo:L},R)})})}),T?.length>0&&(0,e.jsxs)("div",{className:at("flex"),children:[(0,e.jsx)(le.ZP,{className:at(Un["replace-btn"],Un.btn),loading:(T==null||(t=T[T?.length-1])===null||t===void 0?void 0:t.status)!=="complete",disabled:(T==null||(r=T[T?.length-1])===null||r===void 0?void 0:r.status)!=="complete",onClick:function(){var R;return u?.(T==null||(R=T[T?.length-1])===null||R===void 0?void 0:R.text)},children:"\u66FF\u6362"}),(0,e.jsx)(le.ZP,{onClick:function(R){d([]),i?.(R)},className:at(Un.btn,"ml-10 "),children:"\u9000\u51FA"})]}),(0,e.jsx)("div",{className:at(Un.footer,"flex","items-center"),children:(0,e.jsxs)("div",{className:at(Un["chat-input"],"flex","items-center","w-full"),children:[(0,e.jsx)(Fe.Z.TextArea,{value:p,onChange:function(R){return l(R.target.value)},rootClassName:Un.input,onPressEnter:V,placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684SQL\u67E5\u8BE2\u9700\u6C42\uFF0C\u903B\u8F91\u5C3D\u91CF\u63CF\u8FF0\u8BE6\u7EC6",autoSize:{minRows:1,maxRows:3}}),(0,e.jsx)("img",{onClick:function(){return D()},className:at(Un["send-image"],"cursor-pointer"),src:li,alt:""})]})})]})},ci=di,pi=function(n){var t=n.form,r=n.type,a=n.nodeConfig,i=n.id,u=(0,s.useState)(!1),o=z()(u,2),y=o[0],I=o[1],x=(0,ke.useModel)("workflow"),m=x.setIsModified,p=[{firstArg:{bindValue:null,bindValueType:null},secondArg:{bindValue:null,bindValueType:null},compareType:null},{firstArg:{bindValue:null,bindValueType:null},secondArg:{bindValue:null,bindValueType:null},compareType:null}],l=function(){I(!0)};return(0,s.useEffect)(function(){t.getFieldValue("conditionType")||t.setFieldValue("conditionType","AND")},[t.getFieldValue("conditionType")]),(0,e.jsxs)("div",{children:[r==="TableSQL"&&(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),r!=="TableDataAdd"&&r!=="TableSQL"&&(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsx)("p",{className:"node-title-style",children:r==="TableDataDelete"?"\u5220\u9664\u6761\u4EF6":r==="TableDataUpdate"?"\u66F4\u65B0\u6761\u4EF6":"\u67E5\u8BE2\u6761\u4EF6"}),(0,e.jsx)(F.Z.Item,{children:(0,e.jsxs)(zn.Z,{children:[(0,e.jsx)(F.Z.Item,{noStyle:!0,shouldUpdate:function(T,d){return T.conditionArgs!==d.conditionArgs},children:function(T){var d=T.getFieldValue,k=d("conditionArgs");return k?.length>1&&(0,e.jsx)(F.Z.Item,{name:"conditionType",style:{marginTop:"-26px"},initialValue:"AND",children:(0,e.jsx)($e.default,{style:{marginRight:"4px",width:54},options:[{label:"\u4E14",value:"AND"},{label:"\u6216",value:"OR"}]})})}}),(0,e.jsx)(F.Z.List,{name:"conditionArgs",initialValue:p,children:function(T,d){return(0,e.jsxs)("div",{className:"position-relative",children:[T.length>=1?(0,e.jsx)("div",{className:"dis-left",children:(0,e.jsx)("div",{className:"dis-col",children:T.map(function(k){var g=t.getFieldValue(["conditionArgs",k.name,"secondArg","bindValueType"]);return(0,e.jsxs)("div",{className:"dis-sb",children:[(0,e.jsx)(F.Z.Item,{name:[k.name,"compareType"],noStyle:!0,children:(0,e.jsx)($e.default,{popupMatchSelectWidth:!1,options:Ue.b9,optionLabelProp:"displayValue",style:{marginRight:"10px",width:54}})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(F.Z.Item,{name:[k.name,"firstArg","bindValue"],children:(0,e.jsx)($e.default,{placeholder:"\u8BF7\u9009\u62E9",options:t.getFieldValue("tableFields"),fieldNames:{label:"name",value:"key"},style:{width:T.length>1?150:180}})}),(0,e.jsx)(F.Z.Item,{name:[k.name,"secondArg","bindValue"],children:(0,e.jsx)(wt.Z,{form:t,referenceType:g,style:{width:T.length>1?150:180},fieldName:["conditionArgs",k.name,"secondArg","bindValue"]})})]}),(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Jt.Z,{}),onClick:function(){d.remove(k.name)}})]},k.name)})})}):(0,e.jsx)(vn.Z,{description:"\u5F53\u524D\u67E5\u8BE2\u6570\u636E\u4E3A\u7A7A"}),(0,e.jsx)(le.ZP,{type:"primary",onClick:function(){d.add({compareType:"EQUAL",firstArg:null,secondArg:null})},icon:(0,e.jsx)(mn.Z,{}),children:"\u6DFB\u52A0\u6761\u4EF6"})]})}})]})})]}),(r==="TableDataAdd"||r==="TableDataUpdate")&&(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Yt,{title:r==="TableDataAdd"?"\u8F93\u5165":"\u9009\u62E9\u66F4\u65B0\u5B57\u6BB5",form:t,options:t.getFieldValue("tableFields")||[],showAdd:r==="TableDataUpdate",params:t.getFieldValue("inputArgs")||[],showDelete:r==="TableDataUpdate",descText:"\u53D8\u91CF\u503C"})}),r==="TableDataQuery"&&(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsx)("div",{className:" margin-bottom",children:(0,e.jsx)("span",{className:"node-title-style ",children:"\u67E5\u8BE2\u4E0A\u9650"})}),(0,e.jsx)(F.Z.Item,{name:"limit",children:(0,e.jsx)(Yn.Z,{min:1,max:1e3,placeholder:"\u8BF7\u8F93\u5165\u67E5\u8BE2\u4E0A\u9650"})})]}),(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsx)("div",{className:"dis-sb margin-bottom ",children:(0,e.jsx)("span",{className:"node-title-style",children:"\u6570\u636E\u8868"})}),t.getFieldValue("tableId")?(0,e.jsx)(oi,{icon:t.getFieldValue("icon"),name:t.getFieldValue("name"),description:t.getFieldValue("description"),params:t.getFieldValue("tableFields").map(function(j){return j.name})||[],showParams:r==="TableSQL"}):null]}),r==="TableSQL"&&(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Ct,{title:"SQL",inputFieldName:"sql",onExpand:!0,onOptimize:!0,onOptimizeClick:l,placeholder:"\u53EF\u4EE5\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u3001{{\u53D8\u91CF\u540D.\u5B50\u53D8\u91CF\u540D}}\u3001 {{\u53D8\u91CF\u540D[\u6570\u7EC4\u7D22\u5F15]}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u51FA\u53C2\u6570\u4E2D\u7684\u53D8\u91CF"})}),r==="TableSQL"||r==="TableDataQuery"?(0,e.jsx)(F.Z.Item,{name:"inputArgs",children:(0,e.jsx)(nt,{title:"\u8F93\u51FA",inputItemName:"outputArgs",params:a?.outputArgs||[],form:t,showCheck:!0,isNotAdd:!0},"".concat(r,"-").concat(i,"-outputArgs"))}):(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("outputArgs")})]})}}),(0,e.jsx)(ci,{title:"\u751F\u6210sql\u8BED\u53E5",open:y,onCancel:function(){I(!1)},onReplace:function(T){if(T){var d=T;d.includes("```")&&(d=d.replace(/```/g,""));var k=d.startsWith("sql")?d.replace("sql","").trim():d.trim();t.setFieldsValue({sql:k||""}),m(!0)}},tableId:t.getFieldValue("tableId"),inputArgs:t.getFieldValue("inputArgs")})]})},vi=pi,fi=wn.vQ.JavaScript,gi=[{value:wn.vQ.JavaScript,label:"JavaScript"},{value:wn.vQ.Python,label:"Python"}],mi=function(n){var t=n.visible,r=n.onClose,a=n.value,i=n.language,u=n.onChange,o=n.disabledSwitchLanguage,y=o===void 0?!1:o,I=(0,s.useState)(i||fi),x=z()(I,2),m=x[0],p=x[1],l=(0,s.useState)(a||""),j=z()(l,2),T=j[0],d=j[1];(0,s.useEffect)(function(){d(a||"")},[a]);var k=function(c){d(c),u?.({code:c,language:m})},g=function(c){p(c),u?.({code:T,language:c})};return(0,e.jsx)(e.Fragment,{children:t&&(0,e.jsxs)("div",{className:"monaco-container",children:[(0,e.jsxs)("div",{className:"monaco-header dis-sb margin-bottom",children:[(0,e.jsxs)(zn.Z,{align:"center",wrap:!0,className:"dis-left",style:{flex:1},children:[(0,e.jsx)(dt.HF,{}),(0,e.jsx)("span",{className:"mr-16",style:{height:28,lineHeight:"20px",paddingBottom:8,display:"inline-block"},children:"\u4EE3\u7801"}),!y&&(0,e.jsx)($e.default,{style:{width:120},value:m,onChange:g,options:gi,size:"small",placeholder:"\u8BF7\u9009\u62E9\u8BED\u8A00"})]}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Dn.Z,{}),size:"small",type:"text",onClick:r})]}),(0,e.jsx)("div",{className:"monaco-editor-content",children:(0,e.jsx)(ye.Z,{value:T,onChange:k,codeLanguage:m,minimap:!0,height:"790px",codeOptimizeVisible:!1})})]})})},hi=mi,xi=function C(n){var t={};if(!n||!n.length)return t;var r=n.filter(function(a){return!(!a.name||!a.dataType)});return r.forEach(function(a){a.dataType===N.Gi.Array_Object?t[a.name]=[C(a.subArgs||[])]:a.dataType===N.Gi.Object?t[a.name]=C(a.subArgs||[]):a.dataType.startsWith("Array_")?t[a.name]=[]:t[a.name]=""}),t};function qt(C,n){if(lt().isArray(C))return C.map(function(a,i){return qt(a,lt().get(n,i))});if(lt().isPlainObject(C)){var t={};for(var r in C)C.hasOwnProperty(r)&&(t[r]=qt(C[r],n?.[r]));return t}else return n!==void 0?n:C}var Ci=function(n){var t=n.watchField,r=n.fieldName,a=n.specificContent,i=F.Z.useFormInstance(),u=F.Z.useWatch(t,{form:i,preserve:!0}),o=F.Z.useWatch(r,{form:i,preserve:!0})||{},y=(0,s.useMemo)(function(){var I=(0,be.Dt)(o.specificContent||a)||"{}";try{if(!u)return"";var x=xi(u),m=qt(x,JSON.parse(I));return m}catch{return""}},[u,o.specificContent,o.exceptionHandleType,a]);return y},We={"xagi-nav-style2":"xagi-nav-style2___HNLzm",text:"text___LqaZE","page-container":"page-container___wzbcy",exceptionItem:"exceptionItem___wEeCK",exceptionItemHeader:"exceptionItemHeader___ZtLj2",exceptionItemTitle:"exceptionItemTitle___YcVJ6",exceptionItemTip:"exceptionItemTip___sjJe1",exceptionItemForm:"exceptionItemForm___hv2kO",exceptionItemRow:"exceptionItemRow___iFWTr",exceptionItemFormItem:"exceptionItemFormItem___a8VSi","ant-form-item-required":"ant-form-item-required___i46Xn",timeoutItem:"timeoutItem___BmVM1",retryItem:"retryItem___bjEZP",handleTypeItem:"handleTypeItem___I9kSy",exceptionContentItem:"exceptionContentItem___vz_sL",exceptionItemInput:"exceptionItemInput___k4K5d",exceptionItemSelect:"exceptionItemSelect___tu1p8","ant-select-selection-item":"ant-select-selection-item___RIMSR","ant-select-selection-placeholder":"ant-select-selection-placeholder___d3l1y",disabled:"disabled___fCiKY",exceptionItemContentWrapper:"exceptionItemContentWrapper___ynh5L",exceptionItemContentLabel:"exceptionItemContentLabel___N4UMG",editorWrapper:"editorWrapper___Z7JbG"},yi="",Ni=(0,s.memo)(function(C){var n=C.name,t=C.timeout,r=t===void 0?180:t,a=C.retryCount,i=a===void 0?0:a,u=C.exceptionHandleType,o=u===void 0?N.Xy.INTERRUPT:u,y=C.disabled,I=y===void 0?!1:y,x=C.specificContent,m=C.exceptionHandleNodeIds,p=(0,ke.useModel)("workflow"),l=p.setIsModified,j=F.Z.useFormInstance(),T=(0,s.useMemo)(function(){return Ze.vp},[]),d=(0,s.useMemo)(function(){return Ze.cN},[]),k=(0,s.useState)(o),g=z()(k,2),f=g[0],c=g[1],S=(0,s.useState)((0,be.Dt)(x)||yi),w=z()(S,2),P=w[0],Z=w[1],D=(0,s.useState)(!1),V=z()(D,2),L=V[0],R=V[1];(0,s.useEffect)(function(){if(j){var ie=h()(h()({timeout:r,retryCount:i,exceptionHandleType:o},o===N.Xy.SPECIFIC_CONTENT&&{specificContent:(0,be.Dt)(x)}),o===N.Xy.EXECUTE_EXCEPTION_FLOW&&{exceptionHandleNodeIds:m});j.setFieldsValue(tn()({},n,ie))}},[j,n,r,i,o,x,m]);var U=Ci({specificContent:j.getFieldValue([n,"specificContent"])||"",fieldName:n,watchField:"outputArgs"});(0,s.useEffect)(function(){Z((0,be.Dt)(U))},[U]),(0,s.useEffect)(function(){j&&(c(o),o!==N.Xy.EXECUTE_EXCEPTION_FLOW&&j.setFieldValue([n,"exceptionHandleNodeIds"],[]))},[j,n,o]),(0,s.useEffect)(function(){j&&f!==N.Xy.EXECUTE_EXCEPTION_FLOW&&j.setFieldValue([n,"exceptionHandleNodeIds"],[])},[j,n,f]);var J=(0,s.useCallback)((0,Vn.debounce)(function(){l(!0)},100),[]),X=function(de){j.setFieldValue([n,"specificContent"],de),J()},ee=function(de){if(c(de),de===N.Xy.SPECIFIC_CONTENT)try{X(x||"")}catch{}else X("")},ne=function(de){if(j)try{JSON.parse(de),X(de)}catch{}};return(0,e.jsxs)("div",{className:me()(We.exceptionItem),children:[(0,e.jsxs)("div",{className:me()(We.exceptionItemHeader),children:[(0,e.jsx)("span",{className:me()(We.exceptionItemTitle),children:"\u5F02\u5E38\u5904\u7406"}),(0,e.jsx)(hn.Z,{title:"\u53EF\u8BBE\u7F6E\u5F02\u5E38\u5904\u7406\uFF0C\u5305\u62EC\u8D85\u65F6\u3001\u91CD\u8BD5\u3001\u5F02\u5E38\u5904\u7406\u65B9\u5F0F\u3002\u5F00\u542F\u6D41\u5F0F\u8F93\u51FA\u540E\uFF0C\u4E00\u65E6\u5F00\u59CB\u8F93\u51FA\u6570\u636E\uFF0C\u5373\u4F7F\u51FA\u73B0\u5F02\u5E38\u4E5F\u65E0\u6CD5\u91CD\u8BD5\u6216\u8005\u8DF3\u8F6C\u5F02\u5E38\u5206\u652F\u3002",icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsxs)("div",{className:me()(We.exceptionItemForm),children:[(0,e.jsxs)("div",{className:me()(We.exceptionItemRow),children:[(0,e.jsx)(F.Z.Item,{name:[n,"timeout"],label:(0,e.jsxs)("span",{className:"flex items-center",children:["\u8D85\u65F6\u65F6\u95F4",(0,e.jsx)(hn.Z,{title:"\u8BBE\u7F6E\u8282\u70B9\u6267\u884C\u7684\u6700\u5927\u7B49\u5F85\u65F6\u95F4",icon:(0,e.jsx)(En.Z,{})})]}),className:me()(We.exceptionItemFormItem,We.timeoutItem),rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D85\u65F6\u65F6\u95F4"}],children:(0,e.jsx)(Fe.Z,{size:"small",suffix:"s",type:"number",className:me()(We.exceptionItemInput)})}),(0,e.jsx)(F.Z.Item,{name:[n,"retryCount"],label:"\u91CD\u8BD5\u6B21\u6570",className:me()(We.exceptionItemFormItem,We.retryItem),children:(0,e.jsx)($e.default,{size:"small",options:d,className:me()(We.exceptionItemSelect,tn()({},We.disabled,I)),disabled:I,placeholder:"\u4E0D\u91CD\u8BD5"})}),(0,e.jsx)(F.Z.Item,{name:[n,"exceptionHandleType"],label:"\u5F02\u5E38\u5904\u7406\u65B9\u5F0F",className:me()(We.exceptionItemFormItem,We.handleTypeItem),children:(0,e.jsx)($e.default,{size:"small",options:T,className:me()(We.exceptionItemSelect,tn()({},We.disabled,I)),disabled:I,placeholder:"\u4E2D\u65AD\u6D41\u7A0B",onChange:ee})})]}),f===N.Xy.SPECIFIC_CONTENT&&(0,e.jsxs)("div",{className:me()(We.exceptionItemContentWrapper),children:[(0,e.jsxs)("div",{className:me()(We.exceptionItemContentLabel),children:[(0,e.jsx)("span",{children:"\u81EA\u5B9A\u4E49\u8FD4\u56DE\u5185\u5BB9"}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Vt.Z,{}),size:"small",type:"text",onClick:function(){return R(!0)}})]}),(0,e.jsx)(F.Z.Item,{name:[n,"specificContent"],className:me()(We.exceptionItemFormItem,We.exceptionContentItem),rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u81EA\u5B9A\u4E49\u8FD4\u56DE\u5185\u5BB9"},{validator:function(de,ge){if(!ge)return Promise.resolve();try{return JSON.parse(ge),Promise.resolve()}catch{return Promise.reject(new Error("\u8BF7\u8F93\u5165\u6709\u6548\u7684JSON\u683C\u5F0F"))}}}],children:(0,e.jsx)("div",{className:me()(We.editorWrapper),children:(0,e.jsx)(ye.Z,{codeLanguage:wn.vQ.JSON,height:"150px",value:P,codeOptimizeVisible:!1,onChange:ne})})})]}),(0,e.jsx)(hi,{disabledSwitchLanguage:!0,value:P,language:wn.vQ.JSON,visible:L,onClose:function(){return R(!1)},onChange:function(de){var ge=de.code;ne(ge)}})]})]})},function(C,n){return(0,be.Vb)(C,n)}),ji=E(45262),Ei="\u68C0\u7D22\u5173\u952E\u8BCD",Rn="knowledgeBaseConfigs",Ca="inputArgs",bi=function(n){var t=n.form,r=n.type,a=n.id,i=(0,s.useState)(!1),u=z()(i,2),o=u[0],y=u[1],I=(0,ke.useModel)("workflow"),x=I.setIsModified,m=(0,s.useState)([]),p=z()(m,2),l=p[0],j=p[1],T=function(){y(!0)},d=function(w){var P=t.getFieldValue(Rn)||[];w.type=w.targetType,w.knowledgeBaseId=w.targetId,t.setFieldValue(Rn,P.concat(w)),x(!0),y(!1),j([].concat(G()(l),[{type:w.targetType,targetId:w.targetId,status:Se.BQ.Added}]))},k=function(w){var P=t.getFieldValue(Rn);if(P){var Z=P.filter(function(D){return D.knowledgeBaseId!==w.knowledgeBaseId});t.setFieldValue(Rn,Z),x(!0)}},g=function(w){x(!0);var P=t.getFieldValue(Rn);if(P){var Z=P.map(function(D){return D.knowledgeBaseId===w.knowledgeBaseId?w:D});t.setFieldValue(Rn,Z)}},f=t.getFieldValue(Rn);(0,s.useEffect)(function(){var S=f?.map(function(w){return{type:w.type,targetId:w.knowledgeBaseId,status:Se.BQ.Added}})||[];j(S)},[f]);var c=(t?.getFieldValue(Ca)||[]).map(function(S){return h()(h()({},S),{},{description:S.description||Ei})});return(0,e.jsxs)("div",{className:"knowledge-node",children:[(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Yt,{title:"\u8F93\u5165",form:t,params:c},"".concat(r,"-").concat(a,"-").concat(Ca))}),(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u77E5\u8BC6\u5E93"}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(mn.Z,{}),size:"small",onClick:T})]}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return t.getFieldValue(Rn)?(0,e.jsx)(ji.Q,{skillName:Rn,params:t.getFieldValue(Rn),form:t,modifyItem:g,removeItem:k}):(0,e.jsx)(vn.Z,{})}})]}),(0,e.jsxs)("div",{className:"knowledge-node-box node-item-style",children:[(0,e.jsxs)("div",{className:"dis-sb mb-16",children:[(0,e.jsxs)("div",{className:"knowlegenow-left-title flex items-center",children:[(0,e.jsx)("span",{children:"\u641C\u7D22\u7B56\u7565"}),(0,e.jsx)(hn.Z,{title:"\u4ECE\u77E5\u8BC6\u5E93\u4E2D\u83B7\u53D6\u77E5\u8BC6\u7684\u68C0\u7D22\u65B9\u5F0F\uFF0C\u4E0D\u540C\u7684\u68C0\u7D22\u7B56\u7565\u53EF\u4EE5\u66F4\u6709\u6548\u5730\u627E\u5230\u6B63\u786E\u7684\u4FE1\u606F\uFF0C\u63D0\u9AD8\u5176\u751F\u6210\u7684\u7B54\u6848\u7684\u51C6\u786E\u6027\u548C\u53EF\u7528\u6027",icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsx)(F.Z.Item,{name:["searchStrategy"],noStyle:!0,children:(0,e.jsx)($e.default,{className:"flex-1",options:[{label:"\u8BED\u4E49",value:"SEMANTIC"},{label:"\u6DF7\u5408",value:"MIXED"},{label:"\u5168\u6587",value:"FULL_TEXT"}]})})]}),(0,e.jsxs)("div",{className:"dis-sb mb-16",children:[(0,e.jsxs)("div",{className:"knowlegenow-left-title flex items-center",children:[(0,e.jsx)("span",{children:"\u6700\u5927\u53EC\u56DE\u6570\u91CF"}),(0,e.jsx)(hn.Z,{title:"\u4ECE\u77E5\u8BC6\u5E93\u4E2D\u8FD4\u56DE\u7ED9\u5927\u6A21\u578B\u7684\u6700\u5927\u6BB5\u843D\u6570\uFF0C\u6570\u503C\u8D8A\u5927\u8FD4\u56DE\u7684\u5185\u5BB9\u8D8A\u591A",icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsx)(F.Z.Item,{name:["maxRecallCount"],noStyle:!0,children:(0,e.jsx)($t.Z,{min:1,max:20,step:1,marks:{1:1,20:20},className:"flex-1"})})]}),(0,e.jsxs)("div",{className:"dis-sb ",children:[(0,e.jsxs)("div",{className:"knowlegenow-left-title flex items-center",children:[(0,e.jsx)("span",{children:"\u6700\u5C0F\u5339\u914D\u5EA6"}),(0,e.jsx)(hn.Z,{title:"\u6839\u636E\u8BBE\u7F6E\u7684\u5339\u914D\u5EA6\u9009\u53D6\u6BB5\u843D\u8FD4\u56DE\u7ED9\u5927\u6A21\u578B\uFF0C\u4F4E\u4E8E\u8BBE\u5B9A\u5339\u914D\u5EA6\u7684\u5185\u5BB9\u4E0D\u4F1A\u88AB\u53EC\u56DE",icon:(0,e.jsx)(En.Z,{})})]}),(0,e.jsx)(F.Z.Item,{name:"matchingDegree",noStyle:!0,children:(0,e.jsx)($t.Z,{min:.01,max:.99,step:.01,marks:{.01:.01,.99:.99},className:"flex-1"})})]})]}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("outputArgs")})]})}}),(0,e.jsx)(cn.Z,{checkTag:Se.qR.Knowledge,onAdded:d,open:o,onCancel:function(){return y(!1)},addComponents:l,hideTop:[Se.qR.Table,Se.qR.Plugin,Se.qR.Workflow,Se.qR.MCP]})]})},Fi={KnowledgeNode:bi},Ii=function(n){var t=n.form,r=n.isShow,a=n.close;return(0,e.jsx)(e.Fragment,{children:r&&(0,e.jsxs)("div",{className:"monaco-container",children:[(0,e.jsxs)("div",{className:"monaco-header dis-sb margin-bottom",children:[(0,e.jsxs)(zn.Z,{align:"center",wrap:!0,className:"dis-left",style:{flex:1},children:[(0,e.jsx)(dt.HF,{}),(0,e.jsx)("span",{className:"mr-16",style:{height:28,lineHeight:"20px",paddingBottom:8,display:"inline-block"},children:"\u4EE3\u7801"}),(0,e.jsx)(F.Z.Item,{name:"codeLanguage",children:(0,e.jsx)($e.default,{style:{width:120},options:[{value:"JavaScript",label:"JavaScript"},{value:"Python",label:"Python"}],size:"small",placeholder:"\u8BF7\u9009\u62E9\u8BED\u8A00"})})]}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Dn.Z,{}),size:"small",type:"text",onClick:a})]}),(0,e.jsx)("div",{className:"monaco-editor-content",children:(0,e.jsx)(F.Z.Item,{noStyle:!0,name:t.getFieldValue("codeLanguage")==="JavaScript"?"codeJavaScript":"codePython",children:(0,e.jsx)(ye.Z,{value:t.getFieldValue(t.getFieldValue("codeLanguage")==="JavaScript"?"codeJavaScript":"codePython"),onChange:function(u){t.setFieldValue(t.getFieldValue("codeLanguage")==="JavaScript"?"codeJavaScript":"codePython",u)},codeLanguage:t.getFieldValue("codeLanguage")||"JavaScript",minimap:!0,height:"790px"})})})]})})},Si=Ii,ea=E(73981),Ai=function(n){var t=n.form,r=n.nodeConfig,a=n.id,i=n.type;return(0,e.jsx)(F.Z.Item,{name:"inputArgs",children:(0,e.jsx)(nt,{title:"\u8F93\u5165",inputItemName:"inputArgs",params:r?.inputArgs||[],form:t,showCheck:!0},"".concat(i,"-").concat(a,"-inputArgs"))})},Di=function(n){var t=n.form;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t,disabledAdd:!0,disabledDelete:!0,disabledInput:!0})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("outputArgs")})]})}})]})},Ti=function(n){var t=n.form,r=n.type,a=[{label:"\u8FD4\u56DE\u53D8\u91CF",value:"VARIABLE"},{label:"\u8FD4\u56DE\u6587\u672C",value:"TEXT"}];return(0,e.jsxs)(e.Fragment,{children:[r==="End"&&(0,e.jsx)("div",{className:"dis-center",children:(0,e.jsx)(F.Z.Item,{name:"returnType",children:(0,e.jsx)(ea.Z,{options:a,style:{marginBottom:"10px"}})})}),(0,e.jsx)("div",{className:t.getFieldValue("returnType")!=="VARIABLE"?"node-item-style":"",children:(0,e.jsx)(ln,{title:"\u8F93\u51FA\u53D8\u91CF",form:t,fieldConfigs:Ue.x8,showCopy:!0,inputItemName:ce.dy.outputArgs})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("returnType")!=="VARIABLE"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"dis-sb margin-bottom",children:(0,e.jsxs)("span",{className:"node-title-style gap-6 flex items-center",children:["\u8F93\u51FA\u5185\u5BB9",(0,e.jsx)(hn.Z,{title:"\u53EF\u4EE5\u5728\u4EE5\u4E0B\u8F93\u5165\u6846\u4E2D\u91CD\u65B0\u7EC4\u7EC7\u8F93\u51FA\u5185\u5BB9\uFF0C\u5927\u6A21\u578B\u5C06\u4F18\u5148\u4F7F\u7528\u8F93\u5165\u6846\u4E2D\u7684\u5185\u5BB9\u3002",icon:(0,e.jsx)(Nt.Z,{})})]})}),(0,e.jsx)(F.Z.Item,{name:"content",children:(0,e.jsx)(Fe.Z.TextArea,{placeholder:"\u53EF\u4EE5\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u3001{{\u53D8\u91CF\u540D.\u5B50\u53D8\u91CF\u540D}}\u3001{{\u53D8\u91CF\u540D[\u6570\u7EC4 \u7D22\u5F15]}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u51FA\u53C2\u6570\u4E2D\u7684\u53D8\u91CF",autoSize:{minRows:3,maxRows:5},style:{marginBottom:"10px"}})})]})}})]})},ki=function(n){var t=n.form;return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsxs)("span",{className:"node-title-style margin-bottom gap-6 flex items-center",children:["\u5FAA\u73AF\u8BBE\u7F6E",(0,e.jsx)(hn.Z,{title:"\u5982\u679C\u5F15\u7528\u6570\u7EC4\uFF0C\u5FAA\u73AF\u6B21\u6570\u4E3A\u6570\u7EC4\u7684\u957F\u5EA6\uFF1B\u5982\u679C\u6307\u5B9A\u6B21\u6570\uFF0C\u5FAA\u73AF\u6B21\u6570\u4E3A\u6307\u5B9A\u7684\u6B21\u6570\uFF1B\u5982\u679C\u9009\u62E9\u65E0\u9650\u5FAA\u73AF\uFF0C\u9700\u914D\u5408\u201C\u7EC8\u6B62\u5FAA\u73AF\u201D\u8282\u70B9\u5B8C\u6210\u5FAA\u73AF\u6D41\u7A0B\u3002",icon:(0,e.jsx)(Nt.Z,{})})]}),(0,e.jsx)(F.Z.Item,{name:"loopType",children:(0,e.jsx)($e.default,{options:Ue.RY,style:{width:"100%",marginBottom:"10px"}})})]}),(0,e.jsx)(F.Z.Item,{noStyle:!0,shouldUpdate:function(a,i){return a.loopType!==i.loopType},children:function(){var a=t.getFieldValue("loopType");return a==="SPECIFY_TIMES_LOOP"?(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u5FAA\u73AF\u6B21\u6570"}),(0,e.jsx)(F.Z.Item,{name:"loopTimes",children:(0,e.jsx)(Yn.Z,{size:"small",style:{width:"100%",marginBottom:"10px"},placeholder:"\u8BF7\u8F93\u5165\u5FAA\u73AF\u6B21\u6570\uFF0C\u5E76\u4E14\u503C\u4E3A\u6B63\u6574\u6570",min:1,precision:0})})]}):a==="ARRAY_LOOP"?(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u5FAA\u73AF\u6570\u7EC4",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}):null}}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:(0,e.jsxs)(e.Fragment,{children:["\u4E2D\u95F4\u53D8\u91CF",(0,e.jsx)(hn.Z,{title:"\u53D8\u91CF\u53EF\u5728\u591A\u6B21\u5FAA\u73AF\u4E2D\u5B9E\u73B0\u5171\u4EAB\uFF0C\u53EF\u7528\u4E8E\u5728\u591A\u6B21\u5FAA\u73AF\u4E2D\u4F20\u9012\u53D8\u91CF\u3002",icon:(0,e.jsx)(Nt.Z,{})})]}),fieldConfigs:Ue.x8,inputItemName:ce.dy.variableArgs,form:t,isVariable:!0})}),(0,e.jsx)(ln,{title:"\u8F93\u51FA",fieldConfigs:Ue.x8,inputItemName:ce.dy.outputArgs,form:t,isLoop:!0})]})},wi=function(n){var t=n.form,r=Ze.mH,a=t.getFieldValue("configType"),i=a===ce.Do.SET_VARIABLE;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z.Item,{name:"configType",style:{display:"flex",justifyContent:"center"},children:(0,e.jsx)(ea.Z,{options:r})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return i?(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8BBE\u7F6E\u53D8\u91CF",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}):null}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return i?null:(0,e.jsx)(Qr,{title:"\u8F93\u51FA\u53D8\u91CF",fieldConfigs:Ue.x8,inputItemName:ce.dy.outputArgs,form:t})}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:[{name:"isSuccess",dataType:N.Gi.Boolean,description:"",require:!0,systemVariable:!1,bindValue:"",key:"outputArray"}]})]}):null}})]})},Ri=function(n){var t=n.form,r=[{label:"\u5B57\u7B26\u4E32\u62FC\u63A5",value:"CONCAT"},{label:"\u5B57\u7B26\u4E32\u5206\u5272",value:"SPLIT"}],a=(0,s.useState)([{value:"\\n",label:"\u6362\u884C (\\n)"},{value:"\\t",label:"\u5236\u8868\u7B26 (\\t)"},{value:"\u3002",label:"\u53E5\u53F7 (\u3002)"},{value:",",label:"\u9017\u53F7 (,)"},{value:";",label:"\u5206\u53F7 (;)"},{value:"&nbsp;",label:"\u7A7A\u683C ( )"}]),i=z()(a,2),u=i[0],o=i[1],y=(0,s.useState)({label:"",value:""}),I=z()(y,2),x=I[0],m=I[1],p=function(j){if(j.preventDefault(),!(x.label===""||x.value==="")){var T={label:"".concat(x.label,"(").concat(x.value,")"),value:x.value};o([].concat(G()(u),[T])),m({label:"",value:""}),localStorage.setItem("arrayLinkSetting",JSON.stringify([].concat(G()(u),[T])))}};return(0,s.useEffect)(function(){var l=localStorage.getItem("arrayLinkSetting");l&&o(JSON.parse(l))},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z.Item,{name:"textHandleType",style:{display:"flex",justifyContent:"center"},children:(0,e.jsx)(ea.Z,{options:r})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return t.getFieldValue("textHandleType")==="CONCAT"?(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u5B57\u7B26\u4E32\u62FC\u63A5"}),(0,e.jsx)(Re.Z,{placement:"topRight",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"node-title-style",children:"\u6570\u7EC4\u8FDE\u63A5\u7B26\u8BBE\u7F6E"}),(0,e.jsx)("p",{children:"\u4F7F\u7528\u4EE5\u4E0B\u7B26\u53F7\u6765\u81EA\u52A8\u8FDE\u63A5\u6570\u7EC4\u4E2D\u7684\u6BCF\u4E2A\u9879\u76EE"}),(0,e.jsx)("p",{className:"array-link-setting-select-label",children:"\u8FDE\u63A5\u7B26"}),(0,e.jsx)(F.Z.Item,{name:"join",children:(0,e.jsx)($e.default,{options:u,allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u8FDE\u63A5\u7B26\u53F7",popupRender:function(T){return(0,e.jsxs)(e.Fragment,{children:[T,(0,e.jsx)(Gt.Z,{style:{margin:"8px 0"}}),(0,e.jsx)("div",{style:{padding:"8px"},className:"dis-sb",children:(0,e.jsxs)(zn.Z,{children:[(0,e.jsx)(Fe.Z,{value:x.label,placeholder:"\u9009\u9879\u540D\u79F0",onChange:function(k){return m({value:x.value,label:k.target.value})},onKeyDown:function(k){return k.stopPropagation()}}),(0,e.jsx)(Fe.Z,{value:x.value,placeholder:"\u9009\u9879\u503C",onChange:function(k){return m({label:x.label,value:k.target.value})},onKeyDown:function(k){return k.stopPropagation()}}),(0,e.jsx)(le.ZP,{type:"primary",onClick:p,children:"\u6DFB\u52A0"})]})})]})},style:{width:"100%",marginBottom:"10px"}})})]}),trigger:"click",children:(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Dt.Z,{}),size:"small"})})]}),(0,e.jsx)(F.Z.Item,{name:"text",children:(0,e.jsx)(Fe.Z.TextArea,{placeholder:"\u53EF\u4EE5\u4F7F\u7528{{\u53D8\u91CF\u540D}}\u7684\u65B9\u5F0F\u5F15\u7528\u8F93\u5165\u53C2\u6570\u4E2D\u7684\u53D8\u91CF",autoSize:{minRows:3,maxRows:5}})})]}):null}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){return t.getFieldValue("textHandleType")==="SPLIT"?(0,e.jsxs)("div",{className:"node-item-style",children:[(0,e.jsx)("span",{className:"node-title-style",children:"\u5206\u9694\u7B26"}),(0,e.jsx)(F.Z.Item,{name:"splits",children:(0,e.jsx)($e.default,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u5206\u5272\u7B26\u53F7",mode:"multiple",maxTagCount:3,popupRender:function(T){return(0,e.jsxs)(e.Fragment,{children:[T,(0,e.jsx)(Gt.Z,{style:{margin:"8px 0"}}),(0,e.jsx)("div",{style:{padding:"8px"},className:"dis-sb",children:(0,e.jsxs)(zn.Z,{children:[(0,e.jsx)(Fe.Z,{value:x.label,placeholder:"\u9009\u9879\u540D\u79F0",onChange:function(k){return m({value:x.value,label:k.target.value})},onKeyDown:function(k){return k.stopPropagation()}}),(0,e.jsx)(Fe.Z,{value:x.value,placeholder:"\u9009\u9879\u503C",onChange:function(k){return m({label:x.label,value:k.target.value})},onKeyDown:function(k){return k.stopPropagation()}}),(0,e.jsx)(le.ZP,{type:"primary",onClick:p,children:"\u6DFB\u52A0"})]})})]})},options:u})})]}):null}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("textHandleType")==="CONCAT"?[{name:"output",dataType:N.Gi.String,description:"",require:!0,systemVariable:!1,bindValue:"",key:"outputArray"}]:[{name:"output",dataType:N.Gi.Array_String,description:"",require:!0,systemVariable:!1,bindValue:"",key:"outputString"}]})]})}})]})},Bi=function(n){var t=n.form,r=n.nodeConfig,a=n.type,i=n.id,u=(0,s.useState)(!1),o=z()(u,2),y=o[0],I=o[1],x=(0,ke.useModel)("workflow"),m=x.setIsModified,p=t.getFieldValue("codeLanguage")===wn.vQ.JavaScript?"codeJavaScript":"codePython",l=t.getFieldValue("codeLanguage")||wn.vQ.JavaScript;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(ln,{title:"\u8F93\u5165",fieldConfigs:Ue.x8,inputItemName:ce.dy.inputArgs,form:t})}),(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"dis-sb margin-bottom",children:[(0,e.jsx)("span",{className:"node-title-style ",children:"\u4EE3\u7801"}),(0,e.jsx)(le.ZP,{icon:(0,e.jsx)(Vt.Z,{}),size:"small",type:"text",onClick:function(){return I(!0)}})]}),(0,e.jsx)(ye.Z,{form:t,value:t.getFieldValue(p),onChange:function(T){t.setFieldValue(p,T),m(!0)},codeLanguage:l,height:"180px"})]})}),(0,e.jsx)(nt,{title:"\u8F93\u51FA",params:r?.outputArgs||[],form:t,inputItemName:"outputArgs"},"".concat(a,"-").concat(i,"-outputArgs")),(0,e.jsx)(Si,{form:t,isShow:y,close:function(){return I(!1)}})]})},rt={StartNode:Ai,EndNode:Ti,CycleNode:ki,VariableNode:wi,CodeNode:Bi,TextProcessingNode:Ri,DocumentExtractionNode:Di},Zi=function(n){var t=n.form;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("inputArgs")&&(0,e.jsx)("div",{className:"node-item-style",children:(0,e.jsx)(Yt,{form:t,title:"\u8F93\u5165",params:t.getFieldValue("inputArgs")})})}}),(0,e.jsx)(F.Z.Item,{shouldUpdate:!0,children:function(){return t.getFieldValue("outputArgs")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"node-title-style margin-bottom",children:"\u8F93\u51FA"}),(0,e.jsx)(tt,{treeData:t.getFieldValue("outputArgs")})]})}})]})},Pi={PluginInNode:Zi},Li=rt.StartNode,Oi=rt.EndNode,Mi=rt.CycleNode,Vi=rt.VariableNode,Ui=rt.TextProcessingNode,Wi=rt.CodeNode,_i=rt.DocumentExtractionNode,Ki=Rt.ModelNode,$i=Rt.IntentionNode,Gi=Rt.QuestionsNode,Hi=Rt.HttpToolNode,zi=Pi.PluginInNode,Qi=Fi.KnowledgeNode,Ji=function(){return(0,e.jsx)("div",{className:"node-title-style",children:"\u7528\u4E8E\u7EC8\u6B62\u5F53\u524D\u5FAA\u73AF\uFF0C\u6267\u884C\u4E0B\u6B21\u5FAA\u73AF"})},Xi=function(){return(0,e.jsx)("div",{className:"node-title-style",children:"\u7528\u4E8E\u7ACB\u5373\u7EC8\u6B62\u5F53\u524D\u6240\u5728\u7684\u5FAA\u73AF\uFF0C\u8DF3\u51FA\u5FAA\u73AF\u4F53"})},Yi=function(n,t){var r=n.type,a={type:n.type,id:n.id,form:t,nodeConfig:n.nodeConfig};switch(r){case N.C8.Start:return(0,e.jsx)(Li,h()({},a));case N.C8.DocumentExtraction:return(0,e.jsx)(_i,h()({},a));case N.C8.End:case N.C8.Output:return(0,e.jsx)(Oi,h()({},a));case N.C8.Loop:return(0,e.jsx)(Mi,h()({},a));case N.C8.Variable:return(0,e.jsx)(Vi,h()({},a));case N.C8.TextProcessing:return(0,e.jsx)(Ui,h()({},a));case N.C8.LLM:return(0,e.jsx)(Ki,h()({},a));case N.C8.Plugin:case N.C8.Workflow:case N.C8.LongTermMemory:case N.C8.MCP:return(0,e.jsx)(zi,h()({},a));case N.C8.Code:return(0,e.jsx)(Wi,h()({},a));case N.C8.QA:return(0,e.jsx)(Gi,h()({},a));case N.C8.HTTPRequest:return(0,e.jsx)(Hi,h()({},a));case N.C8.Knowledge:return(0,e.jsx)(Qi,h()({},a));case N.C8.Condition:return(0,e.jsx)(ri,h()({},a));case N.C8.IntentRecognition:return(0,e.jsx)($i,h()({},a));case N.C8.LoopBreak:return(0,e.jsx)(Xi,{});case N.C8.LoopContinue:return(0,e.jsx)(Ji,{});case N.C8.TableDataAdd:case N.C8.TableDataDelete:case N.C8.TableDataUpdate:case N.C8.TableDataQuery:case N.C8.TableSQL:return(0,e.jsx)(vi,h()({},a));default:return(0,e.jsx)(e.Fragment,{})}},qi=function(n){var t=n.data,r=(0,s.useMemo)(function(){return{exceptionHandleType:N.Xy.INTERRUPT,timeout:180,retryCount:0,name:"exceptionHandleConfig"}},[]),a=(0,s.useState)(r),i=z()(a,2),u=i[0],o=i[1];return(0,s.useEffect)(function(){return o(function(y){return h()(h()({},y),t||{})}),function(){o(r)}},[]),(0,e.jsx)(Ni,h()({},u))};function es(C){var n,t=C.params,r=F.Z.useFormInstance(),a=(0,be.g_)(t);return(0,e.jsxs)(e.Fragment,{children:[Yi(t,r),a&&(0,e.jsx)(qi,{data:(n=t.nodeConfig)===null||n===void 0?void 0:n.exceptionHandleConfig})]})}var ns=function(n){var t=n.data,r=n.onRefresh,a=n.onClose,i=(0,s.useState)(null),u=z()(i,2),o=u[0],y=u[1],I=(0,s.useState)(!1),x=z()(I,2),m=x[0],p=x[1],l=function(){var j=q()(K()().mark(function T(d){var k;return K()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,p(!0),f.next=4,qe.ZP.apiRestoreWorkflowVersion(d.id);case 4:k=f.sent,k.code===on.ZP.success&&(xt.ZP.success("\u8FD8\u539F\u6210\u529F"),p(!1),r(),a()),f.next=11;break;case 8:f.prev=8,f.t0=f.catch(0),p(!1);case 11:case"end":return f.stop()}},T,null,[[0,8]])}));return function(d){return j.apply(this,arguments)}}();return(0,e.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",right:0,top:0,zIndex:1e3},onMouseEnter:function(){y(t.id)},onMouseLeave:function(){y(null)},children:t.id===o&&(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",height:"100%"},children:(0,e.jsx)(le.ZP,{variant:"outlined",loading:m,onClick:function(){return l(t)},children:"\u8FD8\u539F"})})},t.id)},ts=ns,as=E(21862),rs=E(62849),is=E(92126),ss=function(n){return(0,e.jsx)("div",{className:"icon-box-style",style:h()({width:"20px",height:"20px",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",backgroundPosition:"center"},n&&{backgroundImage:'url("'.concat(n,'")')})})},os=function(n){var t=n.dragChild,r=n.isLoop,a=r===void 0?!1:r,i=function(o,y){t(o,y)};return(0,e.jsxs)("div",{className:"stencil-content",children:[(0,e.jsx)("p",{className:"stencil-title",children:"\u8282\u70B9\u9009\u62E9"}),(0,e.jsx)("div",{className:"stencil-list-style",children:Ue.iE.map(function(u){return(0,e.jsxs)("div",{className:"stencil-list-item",children:[u.name&&(0,e.jsx)("p",{className:"stencil-list-title",children:u.name}),(0,e.jsx)("div",{className:"stencil-list-content",children:u.children.filter(function(o){return a?o.type!==N.C8.Loop:!0}).map(function(o){var y=[N.C8.LoopBreak,N.C8.LoopContinue].includes(o?.type||""),I=y?a:!0;return I&&(0,e.jsxs)("div",{className:"child-content dis-left",draggable:"true",onDragEnd:function(m){return i(o,m)},onClick:function(){return i(o)},children:[ss(o.bgIcon||""),(0,e.jsx)("span",{children:o.name})]},o.type)})})]},u.name)})})]})},ya=os,ls=[{label:"\u653E\u5927 10%",value:"+"},{label:"\u7F29\u5C0F 10%",value:"-"},{label:"\u7F29\u653E\u5230\u9002\u914D\u753B\u5E03",value:-1},{label:(0,e.jsx)("div",{style:{borderTop:"1px solid #d9d9d9",marginTop:"15px",height:0,width:"90%",marginLeft:"5%"}}),value:"divider",disabled:!0,style:{padding:0,cursor:"default"}},{label:"\u7F29\u653E\u5230 50%",value:.5},{label:"\u7F29\u653E\u5230 100%",value:1},{label:"\u7F29\u653E\u5230 150%",value:1.5},{label:"\u7F29\u653E\u5230 200%",value:2}],us=function(n){var t=n.zoomSize,r=t===void 0?1:t,a=n.dragChild,i=n.handleTestRun,u=n.changeGraph,o=n.foldWrapItem,y=n.testRunLoading,I=(0,s.useState)(!1),x=z()(I,2),m=x[0],p=x[1],l=(0,s.useState)(0),j=z()(l,2),T=j[0],d=j[1],k=function(f){p(f),d(0)};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"absolute-box",children:[(0,e.jsxs)("div",{className:"action-section",children:[(0,e.jsx)(le.ZP,{type:"text",style:{marginRight:2},icon:(0,e.jsx)(as.Z,{}),onClick:function(){var f=-10,c=Math.round(r*100),S=c+f,w=Math.max(20,Math.min(300,S)),P=w/100;u(Number(P))}}),(0,e.jsx)($e.default,{options:ls,value:"".concat(Math.round(r*100),"%"),onChange:function(f){var c;if(typeof f=="string"&&["+","-"].includes(f)){var S=f==="+"?10:-10,w=Math.round(r*100),P=w+S,Z=Math.max(20,Math.min(300,P));c=Z/100}else c=f;u(Number(c))},style:{width:80,marginRight:2,height:28},popupMatchSelectWidth:!1,optionLabelProp:"displayValue",size:"small"}),(0,e.jsx)(le.ZP,{type:"text",style:{marginRight:12},icon:(0,e.jsx)(mn.Z,{}),onClick:function(){var f=10,c=Math.round(r*100),S=c+f,w=Math.max(20,Math.min(300,S)),P=w/100;u(Number(P))}}),(0,e.jsx)(Re.Z,{content:"\u7F29\u653E\u5230\u9002\u914D\u753B\u5E03",trigger:["hover"],mouseEnterDelay:1,children:(0,e.jsx)(le.ZP,{type:"text",style:{marginRight:12},icon:(0,e.jsx)(rs.Z,{}),onClick:function(){return u(-1)}})}),(0,e.jsx)(Re.Z,{content:(0,e.jsx)(ya,{isLoop:o.type===N.C8.Loop,dragChild:function(f,c){d(T+1),a(f,c,T)}}),trigger:["click"],open:m,onOpenChange:k,children:(0,e.jsx)(le.ZP,{onMouseEnter:function(){return p(!0)},icon:(0,e.jsx)(mn.Z,{}),type:"primary",onClick:function(){return p(!0)},children:"\u6DFB\u52A0\u8282\u70B9"})})]}),(0,e.jsxs)("div",{className:"action-section",style:{marginLeft:18},children:[(0,e.jsx)(is.Z,{title:"\u8C03\u8BD5",style:{paddingRight:12,paddingLeft:12}}),(0,e.jsx)(le.ZP,{loading:y,icon:(0,e.jsx)(Je.Z,{}),variant:"solid",color:"green",onClick:i,children:"\u8BD5\u8FD0\u884C"})]})]})})},ds=us,Na=500,cs=function(n){return(n||"").length>Na?n.slice(0,Na)+"...":n},ps=function(n){var t=n.visible,r=n.errorList,a=n.show,i=n.onClose,u=n.onClickItem,o=n.nodeList,y=(0,ke.useModel)("workflow"),I=y.setVolid;return(0,e.jsxs)("div",{style:{right:t?"388px":"10px",display:a?"flex":"none",flexDirection:"column"},className:"error-list-style dis-col",children:[(0,e.jsxs)("div",{className:"dis-sb error-list-header",style:{height:"48px"},children:[(0,e.jsx)("span",{children:"\u9519\u8BEF\u5217\u8868"}),(0,e.jsx)(le.ZP,{type:"text",icon:(0,e.jsx)(Dn.Z,{}),onClick:function(){i(),I(!1)}})]}),r&&(0,e.jsx)("div",{className:"error-list-content",children:r.map(function(x){if(x&&x.nodeId){var m=o.find(function(p){return p.id===x.nodeId});return m?(0,e.jsxs)("div",{className:"dis-left error-list-item hover-box",onClick:function(){u(m),I(!0)},children:[(0,e.jsx)("div",{className:"image-div-style",children:(0,se.qM)(m.type)}),(0,e.jsxs)("div",{className:"content-error-item-width",children:[(0,e.jsx)("p",{className:"error-node-name",children:m.name||"\u6682\u65E0"}),x.error.length>110?(0,e.jsx)(Re.Z,{content:(0,e.jsx)("p",{children:cs(x.error)}),trigger:"hover",mouseEnterDelay:.5,placement:"top",open:void 0,children:(0,e.jsx)("p",{className:"error-text",children:x.error})}):(0,e.jsx)("p",{className:"error-text",children:x.error})]})]},x.nodeId):null}else return x?(0,e.jsx)("div",{className:"dis-left error-list-item",children:x.error.length>3e3?(0,e.jsx)(Re.Z,{content:(0,e.jsx)("p",{children:x.error}),trigger:"hover",mouseEnterDelay:.5,placement:"top",open:void 0,children:(0,e.jsx)("p",{className:"error-text",children:x.error})}):(0,e.jsx)("p",{className:"error-text",children:x.error})},x.error):null})})]})},vs=ps,fs=[N.C8.Start,N.C8.End,N.C8.LoopStart,N.C8.LoopEnd],gs=function(n){var t=n.graph,r=n.changeEdgeConfigWithRefresh,a=n.copyNode,i=n.changeNodeConfigWithRefresh,u=n.removeNode,o=n.modal,y=n.message;t.bindKey(["meta+c","ctrl+c"],function(){var m=t.getSelectedCells();return m.length&&t.copy(m),!1}),t.bindKey(["meta+v","ctrl+v"],function(){if(!t.isClipboardEmpty()){var m=t.getSelectedCells();if(m&&m.length>0){var p=m[0].getData();if(p.type===N.C8.LoopStart||p.type===N.C8.LoopEnd||p.type===N.C8.Loop){y.error("\u4E0D\u80FD\u7C98\u8D34\u5FAA\u73AF\u8282\u70B9");return}if(p.type===N.C8.Start){y.error("\u4E0D\u80FD\u7C98\u8D34\u5F00\u59CB\u8282\u70B9");return}if(p.type===N.C8.End){y.error("\u4E0D\u80FD\u7C98\u8D34\u7ED3\u675F\u8282\u70B9");return}a(p)}t.cleanSelection()}return!1});var I=function(p){var l,j,T=p[0],d=(l=T.getTargetNode())===null||l===void 0?void 0:l.id,k=(j=T.getSourceNode())===null||j===void 0?void 0:j.getData(),g=T.getSourcePortId(),f=JSON.parse(JSON.stringify(k));if(k.type===N.C8.Condition){var c=et()(f.nodeConfig.conditionBranchConfigs),S;try{for(c.s();!(S=c.n()).done;){var w=S.value;g.includes(w.uuid)&&(w.nextNodeIds=w.nextNodeIds.filter(function(U){return U!==Number(d)}))}}catch(U){c.e(U)}finally{c.f()}}else if(k.type===N.C8.QA)if(f.nodeConfig.answerType===N.J4.SELECT){var P=et()(f.nodeConfig.options),Z;try{for(P.s();!(Z=P.n()).done;){var D=Z.value;g.includes(D.uuid)&&(D.nextNodeIds=D.nextNodeIds.filter(function(U){return U!==Number(d)}))}}catch(U){P.e(U)}finally{P.f()}}else{r({type:ce.I3.deleted,targetId:d,sourceNode:k,id:"0"}),t.removeCells(p);return}else{var V=et()(f.nodeConfig.intentConfigs),L;try{for(V.s();!(L=V.n()).done;){var R=L.value;g.includes(R.uuid)&&(R.nextNodeIds=R.nextNodeIds.filter(function(U){return U!==Number(d)}))}}catch(U){V.e(U)}finally{V.f()}}i({nodeData:f,targetNodeId:d?.toString()})},x=function(p,l){var j,T,d=p.getSourcePortId(),k=(j=p.getSourceNode())===null||j===void 0?void 0:j.getData(),g=(T=p.getTargetNode())===null||T===void 0?void 0:T.getData(),f=(0,be.y1)(p.getSourceNode(),d);if((0,be.Fm)(k,f)){var c,S,w=(0,Be.Xh)(k),P=((c=w.nodeConfig)===null||c===void 0?void 0:c.exceptionHandleConfig)||{},Z=P.exceptionHandleNodeIds,D=Z===void 0?[]:Z,V=D.filter(function(R){return R!==Number(g.id)}),L=h()(h()({},((S=w.nodeConfig)===null||S===void 0?void 0:S.exceptionHandleConfig)||{}),{},{exceptionHandleNodeIds:V});return w.nodeConfig.exceptionHandleConfig=L,l(w),!0}return!1};return t.bindKey(["delete","backspace"],function(){var m=t.getSelectedCells();if(m.length){var p=m[0];if(p.isEdge()){var l,j,T,d=(l=p.getSourceNode())===null||l===void 0?void 0:l.getData(),k=(j=p.getTargetNode())===null||j===void 0?void 0:j.getData(),g=(T=p.getTargetNode())===null||T===void 0?void 0:T.id;if(!(0,be.DU)(d,k)){y.warning("\u4E0D\u80FD\u5220\u9664\u5FAA\u73AF\u8282\u70B9\u8FDE\u7EBF");return}var f=x(p,function(c){t.removeCells([p]),i({nodeData:c,targetNodeId:k.id.toString()})});if(f)return;if(d.type===N.C8.Loop||k.type===N.C8.Loop){if(d.type===N.C8.Loop&&k.loopNodeId&&k.loopNodeId===d.id){d.innerStartNodeId=-1,i({nodeData:d,targetNodeId:g?.toString()}),t.removeCells([p]);return}if(k.type===N.C8.Loop&&d.loopNodeId&&d.loopNodeId===k.id){k.innerEndNodeId=-1,i({nodeData:k,targetNodeId:k.id.toString()}),t.removeCells([p]);return}}d.type===N.C8.Condition||d.type===N.C8.IntentRecognition||d.type===N.C8.QA?I(m):r({type:ce.I3.deleted,targetId:g,sourceNode:d,id:"0"})}else{if(fs.includes(p.getData().type)){y.warning("\u4E0D\u80FD\u5220\u9664\u5F00\u59CB\u8282\u70B9\u548C\u7ED3\u675F\u8282\u70B9");return}if(p.getData().loopNodeId||p.getData().type===N.C8.Loop){if(p.getData().type===N.C8.Loop){o.confirm({title:"\u786E\u5B9A\u8981\u5220\u9664\u5FAA\u73AF\u8282\u70B9\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){u(p.id,p.getData()),t.removeCells(m)},onCancel:function(){return!1}});return}u(p.id,p.getData())}else u(p.id)}t.removeCells(m)}return!1}),function(){}},ms=gs,hs=E(31759),ja=E.n(hs),ct=E(51196),xs=E(54231),Cs=E(81376),ys=E(61943),Ns=E(90541),js=E(66508),Es=E(67552),na={clickableElement:"clickableElement___p1WCl",editableTitleInput:"editableTitleInput___kZ3s9"},Ea=me().bind(na),bs=(0,s.memo)(function(C){var n=C.value,t=C.disabled,r=C.onChange,a=C.onSave,i=C.onEditingStatusChange,u=C.dataId,o=(0,s.useRef)(null),y=(0,s.useState)(n),I=z()(y,2),x=I[0],m=I[1],p=(0,s.useState)(!1),l=z()(p,2),j=l[0],T=l[1];(0,s.useEffect)(function(){m(n)},[n]),(0,s.useEffect)(function(){i?.(j)},[j]);var d=function(){var S=q()(K()().mark(function w(P){var Z;return K()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:Z=P.target.value,m(Z),r?.(n);case 3:case"end":return V.stop()}},w)}));return function(P){return S.apply(this,arguments)}}(),k=function(){var S=q()(K()().mark(function w(){var P;return K()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(x!==n){D.next=3;break}return T(!1),D.abrupt("return",!1);case 3:return D.next=5,a?.(x);case 5:if(D.t0=D.sent,D.t0){D.next=8;break}D.t0=!0;case 8:return P=D.t0,P&&T(!1),D.abrupt("return",P);case 11:case"end":return D.stop()}},w)}));return function(){return S.apply(this,arguments)}}(),g=function(){x!==n&&m(n),T(!1)},f=function(w){w.key==="Escape"&&g()},c=(0,s.useCallback)(function(){T(!0)},[]);return(0,s.useEffect)(function(){if(!t)return o.current&&o.current.addEventListener("onEditTitle",c),function(){o.current&&o.current.removeEventListener("onEditTitle",c)}},[o.current]),(0,e.jsx)("div",{className:"node-editable-title-text","data-id":u,ref:o,style:{width:"calc(100% - 26px)",maxWidth:300},children:j?(0,e.jsx)(Fe.Z,{size:"small",className:Ea(na.editableTitleInput),autoFocus:j,value:x,onChange:d,onBlur:k,onPressEnter:k,onKeyDown:f}):(0,e.jsx)("div",{className:Ea(na.clickableElement),children:x})})},function(C,n){return C.value===n.value&&C.disabled===n.disabled&&C.dataId===n.dataId}),ba=bs,Fs=function(n){var t=n.graph,r=n.nodeId,a=(0,s.useState)(!1),i=z()(a,2),u=i[0],o=i[1];return(0,s.useEffect)(function(){if(t){var y=function(p){var l,j=p.node;(j==null||(l=j.getData())===null||l===void 0?void 0:l.id)===r&&o(!1)},I=function(p){var l,j=p.node;(j==null||(l=j.getData())===null||l===void 0?void 0:l.id)===r&&o(!0)};t.on("node:unselected",y),t.on("node:selected",I);var x=t.getCellById(r.toString());return o(t.isSelected(x)),function(){t.off("node:unselected",y),t.off("node:selected",I)}}},[t,r]),u},Fa=Fs,Ia=E(35477),Sa=E(15470),Aa=E(4692),Is=E(75434),Ss=E(84896),we={"xagi-nav-style2":"xagi-nav-style2___L56Sx",text:"text___bvYdz","page-container":"page-container___zBB1w",runResultContainer:"runResultContainer___peKfn",runResultHeader:"runResultHeader___Cfxpf",runResultStatus:"runResultStatus___qwys5",statusIcon:"statusIcon___GrXnz",success:"success___E4sQV",error:"error___ka9Ph",statusText:"statusText___jtf9r",runTime:"runTime___M8Jwd",collapseIcon:"collapseIcon___kXdVO",runResultBody:"runResultBody___liKCK",runResultInfo:"runResultInfo___jjjjQ",totalCount:"totalCount___iqje0",runResultPagination:"runResultPagination___C1AgQ",runResultPaginationPages:"runResultPaginationPages___yWWts",runResultPageItem:"runResultPageItem___YHKvA",active:"active___duVga",runResultPageSelect:"runResultPageSelect___vcCo2",selectArrow:"selectArrow___t89U_",onlyErrorCheckbox:"onlyErrorCheckbox___oqk2N",runResultBatch:"runResultBatch___EJ6wb",runResultBatchHeader:"runResultBatchHeader___rxC1F",runResultBatchContent:"runResultBatchContent___H70IQ",runResultSection:"runResultSection___UOHNI",runResultSectionHeader:"runResultSectionHeader___a7NiU",runResultSectionContent:"runResultSectionContent___FsJ3w",keyValueItem:"keyValueItem___Y0WRE",key:"key___tiO80",value:"value___jlGfv",runResultPageSelectRoot:"runResultPageSelectRoot___na4kg"},Le=me().bind(we),Da=5,As=function(n){var t=n.success,r=t===void 0?!0:t,a=n.loading,i=a===void 0?!1:a,u=n.time,o=u===void 0?"0.001s":u,y=n.total,I=y===void 0?10:y,x=n.current,m=x===void 0?1:x,p=n.onlyError,l=p===void 0?!1:p,j=n.onPageChange,T=n.onOnlyErrorChange,d=n.batchVariables,k=d===void 0?{}:d,g=n.inputParams,f=g===void 0?{}:g,c=n.outputResult,S=c===void 0?{}:c,w=n.collapsible,P=w===void 0?!0:w,Z=n.expanded,D=Z===void 0?!1:Z,V=n.title,L=V===void 0?"":V,R=n.onExpandChange,U=(0,s.useRef)(null),J=(0,s.useState)(!D),X=z()(J,2),ee=X[0],ne=X[1],ie=function(){var ue=!ee;ne(ue),R?.(!ue)},de=function(ue){j?.(ue)},ge=function(ue){T?.(ue.target.checked)},_e=function(){for(var ue=[],re=Math.min(Da,I),te=function(pe){ue.push((0,e.jsx)("span",{className:Le(we.runResultPageItem,tn()({},we.active,m===pe)),onClick:function(){return de(pe)},children:pe},pe))},Y=1;Y<=re;Y++)te(Y);return(0,e.jsxs)("div",{className:Le(we.runResultPagination),children:[(0,e.jsx)("div",{className:Le(we.runResultPaginationPages),children:ue}),(0,e.jsx)("div",{className:Le(we.runResultPageSelect),children:I>Da&&(0,e.jsx)($e.default,{value:m,onChange:de,options:Array.from({length:I},function(ae,pe){return{value:pe+1,label:pe+1}}),listHeight:100,className:we.runResultPageSelectRoot,size:"small",getPopupContainer:function(){return U.current}})})]})},Cn=function(ue,re){return(0,e.jsxs)("div",{className:Le(we.runResultSection),children:[(0,e.jsxs)("div",{className:Le(we.runResultSectionHeader),children:[(0,e.jsx)("span",{children:re}),(0,e.jsx)(Sa.Z,{data:ue,jsonSpace:2,tooltipTitle:"\u590D\u5236"})]}),(0,e.jsx)("div",{className:Le(we.runResultSectionContent,"overflow-y"),children:(0,e.jsx)("code",{children:JSON.stringify(ue,null,2)})})]})};return(0,e.jsxs)("div",{ref:U,className:Le(we.runResultContainer),onClick:function(ue){ue.stopPropagation()},children:[(0,e.jsxs)("div",{className:Le(we.runResultHeader),children:[(0,e.jsxs)("div",{className:Le(we.runResultStatus),children:[i?(0,e.jsx)(oa.Z,{className:Le(we.statusIcon)}):r?(0,e.jsx)(Aa.Z,{className:Le(we.statusIcon,we.success)}):(0,e.jsx)(Is.Z,{className:Le(we.statusIcon,we.error)}),(0,e.jsx)("span",{className:Le(we.statusText),children:L||(i?"\u8FD0\u884C\u4E2D":r?"\u8FD0\u884C\u6210\u529F":"\u8FD0\u884C\u5931\u8D25")}),!i&&(0,e.jsx)("span",{className:Le(we.runTime),children:o})]}),P&&(0,e.jsx)("div",{className:Le(we.collapseIcon),onClick:ie,children:ee?(0,e.jsx)(Wt.Z,{}):(0,e.jsx)(Ss.Z,{})})]}),!ee&&(0,e.jsxs)("div",{className:Le(we.runResultBody),children:[(0,e.jsxs)("div",{className:Le(we.runResultInfo),children:[(0,e.jsxs)("div",{className:Le(we.totalCount),children:["\u603B\u6570: ",I]}),I>1&&!r&&(0,e.jsx)("div",{className:Le(we.onlyErrorCheckbox),children:(0,e.jsx)(Kt.Z,{checked:l,onChange:ge,children:"\u53EA\u770B\u9519\u8BEF"})})]}),I>1&&_e()||null,Object.keys(k).length>0&&(0,e.jsxs)("div",{className:Le(we.runResultBatch),children:[(0,e.jsxs)("div",{className:Le(we.runResultBatchHeader),children:[(0,e.jsx)("span",{children:"\u672C\u6B21\u6279\u5904\u7406\u53D8\u91CF"}),(0,e.jsx)(Sa.Z,{data:k,jsonSpace:2,tooltipTitle:"\u590D\u5236"})]}),(0,e.jsx)("div",{className:Le(we.runResultSectionContent,"overflow-y"),children:(0,e.jsx)("pre",{children:JSON.stringify(k,null,2)})})]}),Cn(f,"\u8F93\u5165"),Cn(S,"\u8F93\u51FA")]})]})},Ds=As,Ts=function(n){var t=n.data,r=t.nodeConfig.conditionBranchConfigs;return(0,e.jsx)("div",{className:"condition-node-content-style",children:r?.map(function(a){var i,u,o,y,I=a.conditionArgs?(i=a.conditionArgs[0])===null||i===void 0||(i=i.firstArg)===null||i===void 0?void 0:i.name:"",x=((u=a.conditionArgs[0])===null||u===void 0||(u=u.secondArg)===null||u===void 0?void 0:u.name)||((o=a.conditionArgs[0])===null||o===void 0||(o=o.secondArg)===null||o===void 0?void 0:o.bindValue)||"";return(0,e.jsxs)("div",{className:"dis-left condition-item-style",children:[(0,e.jsx)("span",{className:"condition-title-sytle",children:Ze.Vy[a.branchType||ce.F0.ELSE_IF]}),(0,e.jsx)("div",{className:"flex-1 condition-node-left-input",children:I}),a.conditionArgs&&a.conditionArgs.length>0&&(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("span",{className:"condition-node-compare-type",children:(y=a.conditionArgs[0])!==null&&y!==void 0&&y.compareType?Ze.cr[a.conditionArgs[0].compareType]:""}),(0,e.jsx)("div",{className:"condition-node-right-input",children:x})]})]},a.uuid)})})},ks=function(n){var t,r=n.data,a=r.nodeConfig.inputArgs,i=r.nodeConfig.question,u=r.nodeConfig.answerType;return(0,e.jsxs)("div",{className:"qa-node-content-style",children:[(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("span",{className:"text-right qa-title-style",children:"\u8F93\u5165"}),a?.slice(0,2).map(function(o,y){return(0,e.jsx)(Ye.Z,{children:o.name},"inputArgs-".concat(o.name,"-").concat(y))}),a&&a.length>2&&(0,e.jsxs)(Ye.Z,{children:["+",a.length-2]}),!a&&(0,e.jsx)("span",{children:"\u672A\u914D\u7F6E\u8F93\u5165\u5185\u5BB9"})]}),(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("span",{className:"text-right qa-title-style",children:"\u63D0\u95EE\u5185\u5BB9"}),(0,e.jsx)("span",{className:"question-content-style",children:i||"\u672A\u914D\u7F6E\u63D0\u95EE\u5185\u5BB9"})]}),(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("span",{className:"text-right qa-title-style",children:"\u95EE\u7B54\u7C7B\u578B"}),(0,e.jsx)("span",{children:Ze.X6[u]})]}),u===N.J4.SELECT&&((t=r.nodeConfig.options)===null||t===void 0?void 0:t.map(function(o,y){return(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("span",{className:"text-right qa-title-style"}),(0,e.jsx)(Ye.Z,{children:Ze.bQ[y]}),(0,e.jsx)("span",{className:"qa-content-style",children:o.content||"\u672A\u914D\u7F6E\u5185\u5BB9"})]},"options-".concat(o.uuid||Ze.bQ[y],"-").concat(y))}))]})},ws=function(n){var t=n.data,r=t.nodeConfig.intentConfigs;return(0,e.jsx)("div",{className:"qa-node-content-style",children:r?.map(function(a,i){return(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsxs)("span",{className:"qa-title-style",children:["\u9009\u9879",i+1]}),(0,e.jsx)("span",{className:"qa-content-style",children:a.intent||"\u672A\u914D\u7F6E\u610F\u56FE"})]},i)})})},Rs=[N.C8.LoopStart,N.C8.LoopEnd,N.C8.Start,N.C8.End],Ta=function(n){var t,r,a=n.data,i=((a?.reduce(function(ne,ie){var de,ge;return ne+(((ie==null||(de=ie.options)===null||de===void 0?void 0:de.endTime)||0)-((ie==null||(ge=ie.options)===null||ge===void 0?void 0:ge.startTime)||0))},0)||0)/1e3).toFixed(3),u=a?.length||0,o=(0,s.useState)(u),y=z()(o,2),I=y[0],x=y[1],m=(0,s.useState)(1),p=z()(m,2),l=p[0],j=p[1],T=(0,s.useState)(!1),d=z()(T,2),k=d[0],g=d[1],f=(0,s.useState)(!1),c=z()(f,2),S=c[0],w=c[1],P=(0,s.useState)([]),Z=z()(P,2),D=Z[0],V=Z[1],L=a.every(function(ne){return ne?.status===N.Ss.FINISHED}),R=a.some(function(ne){return ne?.status===N.Ss.EXECUTING||ne?.status===N.Ss.STOP_WAIT_ANSWER}),U=function(ie){console.log("\u9875\u7801\u53D8\u5316\uFF1A",ie),j(ie)},J=function(ie){console.log("\u53EA\u770B\u9519\u8BEF\u53D8\u5316\uFF1A",ie),g(ie)},X=function(ie){console.log("\u5C55\u5F00/\u6536\u8D77\u53D8\u5316\uFF1A",ie),w(ie)};(0,s.useEffect)(function(){V(a)},[a]),(0,s.useEffect)(function(){if(k&&!L){var ne=a.filter(function(ie){return ie?.status===N.Ss.FAILED});V(ne.length>0?ne:[])}else V(a)},[k,L]),(0,s.useEffect)(function(){x(D.length),j(1)},[D]);var ee=(0,s.useCallback)(function(){var ne=a.map(function(ie){return ie?.status});switch(!0){case ne.some(function(ie){return ie===N.Ss.STOP_WAIT_ANSWER}):return"\u8BF7\u7B54\u590D\u95EE\u9898";case ne.some(function(ie){return ie===N.Ss.EXECUTING}):return"\u8FD0\u884C\u4E2D";case ne.some(function(ie){return ie===N.Ss.FAILED}):return"\u8FD0\u884C\u5931\u8D25";case ne.every(function(ie){return ie===N.Ss.FINISHED}):return"\u8FD0\u884C\u6210\u529F";default:return"\u8FD0\u884C\u5931\u8D25"}},[a]);return a?.length===0?null:(0,e.jsx)(Ds,{success:L,title:ee(),loading:R,collapsible:!R,time:"".concat(i,"s"),total:I,current:l,onlyError:k,onPageChange:U,onOnlyErrorChange:J,expanded:S,onExpandChange:X,inputParams:((t=D[l-1])===null||t===void 0||(t=t.options)===null||t===void 0?void 0:t.input)||{},outputResult:((r=D[l-1])===null||r===void 0||(r=r.options)===null||r===void 0?void 0:r.data)||{}})},Bs=function(n){var t,r=n.data;return(0,e.jsxs)("div",{className:"exception-handle-style",children:[(0,e.jsx)("span",{className:"exception-handle-title",children:"\u5F02\u5E38\u65F6"}),(0,e.jsx)("p",{className:"exception-handle-content",children:(t=Ze.vp.find(function(a){return a.value===r?.exceptionHandleType}))===null||t===void 0?void 0:t.label})]})},Zs=function(n){var t=n.node,r=n.graph,a=t.getData(),i=Fa({graph:r,nodeId:a?.id}),u=(0,s.useState)(a?.name||""),o=z()(u,2),y=o[0],I=o[1];if((0,s.useEffect)(function(){I(a?.name||"")},[a?.name]),!a)return null;var x="linear-gradient(to bottom, ".concat((0,se.ys)(a.type)," 0%, white 100%)"),m=[N.C8.QA,N.C8.Condition,N.C8.IntentRecognition].includes(a.type),p=m?"10px":"0",l=function(c){t.setData({enableMove:!c})},j=function(c){return I(c),r.trigger("node:custom:save",{data:t.getData(),payload:{name:c}}),!0},T=Rs.includes(a.type),d=a.runResults||[],k=[N.C8.LoopStart,N.C8.LoopEnd].includes(a.type)?!1:!!d.length,g=(0,be.g_)(a);return a?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"general-node ".concat(i?"selected-general-node":""),children:[(0,e.jsxs)("div",{className:"general-node-header",style:{background:x,marginBottom:p},children:[(0,e.jsx)("div",{className:"dis-left general-node-header-image",children:(0,se.qM)(a.type)}),(0,e.jsx)(ba,{dataId:a.id.toString(),value:y,onSave:j,disabled:T,onEditingStatusChange:l},a.id.toString())]}),a.type===N.C8.Condition&&(0,e.jsx)(Ts,{data:a}),a.type===N.C8.QA&&(0,e.jsx)(ks,{data:a}),a.type===N.C8.IntentRecognition&&(0,e.jsx)(ws,{data:a}),g&&(0,e.jsx)(Bs,{data:a.nodeConfig.exceptionHandleConfig})]}),k&&(0,e.jsx)(Ta,{data:d})]}):null},Ps=function(n){var t=n.node,r=n.graph,a=t.getData(),i=(0,s.useState)(a?.name||""),u=z()(i,2),o=u[0],y=u[1],I=Fa({graph:r,nodeId:a?.id}),x="linear-gradient(to bottom, ".concat((0,se.ys)(a.type)," 0%, white 42px)");(0,s.useEffect)(function(){y(a?.name||"")},[a?.name]);var m=function(d){t.setData({enableMove:!d})},p=function(d){return y(d),r.trigger("node:custom:save",{data:t.getData(),payload:{name:d}}),!0},l=a.runResults||[],j=!!l.length;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"loop-node-style general-node ".concat(I?"selected-general-node":""),style:{background:x},children:[(0,e.jsxs)("div",{className:"loop-node-title-style dis-left",children:[(0,e.jsx)(dt.ZX,{style:{marginRight:"6px"}}),(0,e.jsx)(ba,{value:o,dataId:a.id.toString(),onEditingStatusChange:m,onSave:p},a.id.toString())]}),(0,e.jsx)("div",{className:"loop-node-content"})]}),j&&(0,e.jsx)(Ta,{data:l})]})};function Ls(){(0,Ia.z2)({shape:N.K$.General,component:Zs}),(0,Ia.z2)({shape:N.K$.Loop,component:Ps,resizable:!0,draggable:!0})}var Os=function(n,t){var r=2,a=2,i=Math.abs(t.x-n.x),u=Math.floor(i/3*2),o=n.x<t.x?n.x+r:n.x-r,y=t.x>n.x?t.x-a:t.x+a,I=n.y,x=t.y,m={x:o+u,y:I},p={x:y-u,y:x};return ct.y$.normalize("M ".concat(o," ").concat(I,`
     L `).concat(o+(n.x<t.x?r:-r)," ").concat(I,`
     C `).concat(m.x," ").concat(m.y," ").concat(p.x," ").concat(p.y," ").concat(y," ").concat(x,`
     L `).concat(y," ").concat(x,`
    `))},Ms=function(n){var t=n.containerId,r=n.changeDrawer,a=n.changeCondition,i=n.changeEdgeConfigWithRefresh,u=n.changeNodeConfigWithRefresh,o=n.changeZoom,y=n.createNodeByPortOrEdge,I=n.onSaveNode,x=n.onClickBlank,m=document.getElementById(t);if(!m)throw new Error("Container not found");ct.kJ.registerConnector("curveConnector",Os,!0),ct.kS.config({markup:[{tagName:"path",selector:"wrap"},{tagName:"path",selector:"line"}],connector:{name:"curveConnector"},attrs:{wrap:{connection:!0,strokeWidth:10,strokeLinejoin:"round",cursor:"pointer",pointerEvents:"none"},line:{connection:!0,strokeWidth:1,pointerEvents:"none",targetMarker:{name:"classic",size:6}}}});var p=function(f,c,S,w,P,Z){var D=c.target.getBoundingClientRect(),V=D.left+D.width/2,L=D.top+D.height/2,R=f.clientToLocal({x:V,y:L}),U=function(ne){y({child:ne,sourceNode:S,portId:w,position:R,targetNode:P,edgeId:Z})},J=!!(S!=null&&S.loopNodeId),X=(0,e.jsx)("div",{className:"confirm-popover",children:(0,e.jsx)(ya,{dragChild:function(ne){U(ne),Tt.Z.destroyAll()},isLoop:J})});Tt.Z.confirm({content:X,footer:null,icon:null,width:260,maskClosable:!0,getContainer:function(){return document.body},style:{position:"fixed",left:V}})},l=new ct.kJ({container:m,grid:{visible:!0,type:"dot",size:22,args:{color:"#606060",thickness:1}},autoResize:!0,panning:!0,mousewheel:{enabled:!0,zoomAtMousePosition:!0,minScale:.2,maxScale:3,modifiers:["ctrl","meta"]},background:{color:"#f2f2f2"},connecting:{router:"manhattan",connector:"curveConnector",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,allowNode:!1,allowLoop:!1,allowEdge:!1,highlight:!0,snap:{radius:22,anchor:"bbox"},createEdge:function(){return new ct.bn.kS({attrs:{line:{strokeDasharray:"5 5",strokeWidth:1,targetMarker:null,zIndex:1,style:{animation:"ant-line 30s infinite linear"}}}})},validateConnection:function(f){var c=f.sourceMagnet,S=f.targetMagnet,w=f.sourceCell,P=f.targetCell;if(!c||!S||!w||!P||w===P)return!1;var Z=S.closest(".x6-port-body"),D=c.getAttribute("port-group")||"",V=Z.getAttribute("port-group")||"",L=c.getAttribute("port"),R=Z.getAttribute("port");if(!L||!R)return!1;var U=l.getEdges(),J=U.some(function(ie){var de=ie.getSource(),ge=ie.getTarget();return ja()(de)==="object"&&"cell"in de&&"port"in de&&ja()(ge)==="object"&&"cell"in ge&&"port"in ge?de.cell===w.id&&de.port===L&&ge.cell===P.id&&ge.port===R:!1});if(J)return!1;var X=P.getData(),ee=w.getData();if(ee.type===N.C8.LoopBreak&&X.type!==N.C8.LoopEnd)return!1;var ne=function(de){var ge;return((ge=de.getData())===null||ge===void 0?void 0:ge.type)==="Loop"};return!ne(w)&&!ne(P)?(D===ce.TG.out||D===ce.TG.special||D===ce.TG.exception)&&V===ce.TG.in:(ne(w)||ne(P),!0)}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5147FF",stroke:"#5147FF"}}}},embedding:{enabled:!1},interacting:{nodeMovable:function(f){var c=f.cell,S=c.getData(),w=S.enableMove;return w}}}),j=function(){l.getNodes().forEach(function(f){var c=f.getPorts(),S=c.map(function(w){return h()(h()({},w),{},{attrs:h()(h()({},w.attrs),{},{circle:{r:3},pointerEvents:"all",event:"mouseenter"})})});f.prop("ports/items",S)})},T=function(f){var c=l.getNodes();c.forEach(function(Z){Z.prop("zIndex",4)});var S=c.filter(function(Z){var D=Z.getData();return D.type==="Loop"});if(S.forEach(function(Z){Z.prop("zIndex",5);var D=Z.getChildren();D?.forEach(function(V){V.prop("zIndex",8)})}),f){var w=f.getData();if(w.type==="Loop"){var P=f.getChildren();P?.forEach(function(Z){Z.isEdge()?Z.prop("zIndex",15):Z.prop("zIndex",20)}),f.prop("zIndex",10)}else f.prop("zIndex",99)}};l.use(new js.H).use(new ys.N).use(new xs.T).use(new Cs.A).use(new Ns.Y({}));var d=function(f){var c,S,w,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"active",Z=arguments.length>2?arguments[2]:void 0,D=h()(h()({},f),{},{attrs:h()(h()({},f.attrs),{},{circle:h()(h()({},((c=f.attrs)===null||c===void 0?void 0:c.circle)||{}),{},{stroke:Z||"#5147FF",fill:Z||"#5147FF"})})}),V={normal:h()(h()({},D),{},{attrs:h()(h()({},D.attrs),{},{circle:h()(h()({},D.attrs.circle),{},{r:3}),icon:h()(h()({},((S=f.attrs)===null||S===void 0?void 0:S.icon)||{}),{},{width:0,height:0,opacity:0}),hoverCircle:{pointerEvents:"visiblePainted"}})}),active:h()(h()({},D),{},{attrs:h()(h()({},D.attrs),{},{circle:h()(h()({},D.attrs.circle),{},{r:8}),icon:h()(h()({},((w=f.attrs)===null||w===void 0?void 0:w.icon)||{}),{},{width:10,height:10,x:-5,y:-5,opacity:1}),hoverCircle:{pointerEvents:"none"}})})};return V[P]};l.on("node:mouseenter",function(g){var f,c,S=g.node,w=S.getPorts(),P={in:"active",out:"active"};((f=S.getData())===null||f===void 0?void 0:f.type)==="LoopStart"&&(P.in="normal"),((c=S.getData())===null||c===void 0?void 0:c.type)==="LoopEnd"&&(P.out="normal");var Z=w.map(function(D){var V,L=d(D,P[D.group||"in"],(V=D.attrs)===null||V===void 0||(V=V.circle)===null||V===void 0?void 0:V.fill);return L});S.prop("ports/items",Z)}),l.on("node:mouseleave",function(g){var f=g.node,c=f.getPorts(),S=c.map(function(w){var P;return d(w,"normal",(P=w.attrs)===null||P===void 0||(P=P.circle)===null||P===void 0?void 0:P.fill)});f.prop("ports/items",S)}),l.on("node:port:click",function(g){var f,c=g.node,S=g.port,w=g.e,P=(f=c.getData())===null||f===void 0?void 0:f.loopNodeId;if(P){var Z,D,V,L=S?.includes("in"),R=(Z=c.getParent())===null||Z===void 0?void 0:Z.getData(),U=((D=c.getData())===null||D===void 0?void 0:D.id)===R.innerStartNodeId,J=((V=c.getData())===null||V===void 0?void 0:V.id)===R.innerEndNodeId;if(U&&L||J&&!L){xt.ZP.warning("\u5FAA\u73AF\u8282\u70B9\u7684\u5F00\u59CB\u548C\u7ED3\u675F\u8282\u70B9\u4E0D\u80FD\u5FEB\u6377\u6DFB\u52A0\u5176\u4ED6\u8282\u70B9");return}}p(l,w,c.getData(),S),l.select(c)}),l.on("edge:mouseenter",function(g){var f,c,S=g.edge,w=(f=S.getSourceCell())===null||f===void 0?void 0:f.getData(),P=(c=S.getTargetCell())===null||c===void 0?void 0:c.getData();w.type==="Loop"&&P.loopNodeId||w.loopNodeId&&P?.type==="Loop"||S.addTools([{name:"button",args:{markup:[{tagName:"circle",selector:"button",attrs:{r:8,stroke:"#5147FF",strokeWidth:1,fill:"#5147FF",cursor:"pointer"}},{tagName:"image",selector:"icon",attrs:{href:Es.Z,width:10,height:10,x:-5,y:-5,pointerEvents:"none"}}],distance:"50%",offset:{x:0,y:0},onClick:function(D){var V,L,R=D.e,U=(V=S.getSourceCell())===null||V===void 0?void 0:V.getData(),J=(L=S.getTargetCell())===null||L===void 0?void 0:L.getData(),X=S.getSourcePortId();!U||!J||(p(l,R,U,X,J,S.id),x?.(),l.cleanSelection())}}}])}),l.on("edge:mouseleave",function(g){var f=g.edge;f.removeTools()}),l.on("node:moved",function(g){var f=g.node,c=g.e;c.stopPropagation();var S=f.getPosition(),w=S.x,P=S.y,Z=f.getData();if(Z.nodeConfig&&Z.nodeConfig.extension?(Z.nodeConfig.extension.x=w,Z.nodeConfig.extension.y=P):Z.nodeConfig.extension={x:w,y:P},Z.loopNodeId){var D=l.getCellById(Z.loopNodeId),V=D.getPosition(),L=D.getChildren();if(L&&L.length){var R=et()(L),U;try{for(R.s();!(U=R.n()).done;){var J=U.value;if(J.isNode()){var X=J.getData();X.id===Z.id&&(X.nodeConfig.extension.x=w,X.nodeConfig.extension.y=P,a({nodeData:X,update:ce.Yi.moved}))}}}catch(ue){R.e(ue)}finally{R.f()}}var ee=D.getSize(),ne=D.getData();ne&&(ne.nodeConfig.extension.width=ee.width,ne.nodeConfig.extension.height=ee.height,ne.nodeConfig.extension.x=V.x,ne.nodeConfig.extension.y=V.y,L&&L.length&&(ne.innerNodes=L.filter(function(ue){return ue?.isNode()}).map(function(ue){return ue.getData()})),a({nodeData:ne,update:ce.Yi.moved}));return}if(Z.type===N.C8.Loop){var ie=f.getChildren(),de=Z.innerNodes||[];if(ie&&ie.length){var ge=et()(ie),_e;try{var Cn=function(){var re=_e.value;if(re.isNode()){var te=re.getPosition(),Y=re.getData();if(Y.nodeConfig.extension.x=te.x,Y.nodeConfig.extension.y=te.y,!de.find(function(pe){return pe.id===Y.id}))de.push(Y);else{var ae=de.findIndex(function(pe){return pe.id===Y.id});de[ae]=Y}}};for(ge.s();!(_e=ge.n()).done;)Cn()}catch(ue){ge.e(ue)}finally{ge.f()}}Z.innerNodes=de,Z.nodeConfig.extension.x=w,Z.nodeConfig.extension.y=P;var De=f.getSize();Z.nodeConfig.extension.width=De.width,Z.nodeConfig.extension.height=De.height,a({nodeData:Z,update:ce.Yi.moved});return}a({nodeData:Z,update:ce.Yi.moved}),T(f)}),l.on("node:mouseleave",function(){j()}),l.on("edge:removed",function(){j(),(0,be.$3)(l)}),l.on("blank:click",function(){var g=l.getSelectedCells();l.unselect(g),l.cleanSelection(),x?.()}),l.on("edge:click",function(g){var f=g.edge;f.attr("line/stroke","#37D0FF"),x?.()}),l.on("edge:unselected",function(g){var f=g.edge;f.attr("line/stroke","#5147FF")}),l.on("node:change:data",function(){for(var g=arguments.length,f=new Array(g),c=0;c<g;c++)f[c]=arguments[c];console.log("node:change:data",f)}),l.on("node:custom:save",function(g){var f=g.data,c=g.payload;I(f,c)}),l.on("node:selected",function(g){var f=g.node;T(f);var c=f.getData();if(!c.isFocus){var S=h()(h()({},c),{},{id:f.id});r(S)}}),l.on("node:mousedown",function(g){var f=g.node,c=f.getData();if(c.isFocus){f.updateData({isFocus:!1}),l.cleanSelection(),l.select(f);return}});var k=function(f,c){var S,w,P=f.getSourcePortId(),Z=(S=f.getSourceNode())===null||S===void 0?void 0:S.getData(),D=(w=f.getTargetNode())===null||w===void 0?void 0:w.getData(),V=(0,be.y1)(f.getSourceNode(),P);if((0,be.Fm)(Z,V)){var L,R,U=(0,Be.Xh)(Z),J=((L=U.nodeConfig)===null||L===void 0?void 0:L.exceptionHandleConfig)||{},X=J.exceptionHandleNodeIds,ee=X===void 0?[]:X;if(ee.includes(D.id))return!0;ee.push(D.id);var ne=h()(h()({},((R=U.nodeConfig)===null||R===void 0?void 0:R.exceptionHandleConfig)||{}),{},{exceptionHandleNodeIds:ee});return U.nodeConfig.exceptionHandleConfig=ne,c(U),!0}return!1};return l.on("edge:mousedown",function(){l.cleanSelection(),x?.()}),l.on("edge:connected",function(g){var f,c,S=g.isNew,w=g.edge;if(j(),w.setRouter("manhattan"),!!S){var P=l.getEdges(),Z=w.getTargetCellId(),D=w.getSourcePortId(),V=w.getTargetPortId(),L=(f=w.getSourceNode())===null||f===void 0?void 0:f.getData(),R=(c=w.getTargetNode())===null||c===void 0?void 0:c.getData();if(!(!L||!R||!D||!V)){var U=(0,be.Uj)(w,P);if(U!==!1){w.remove(),U&&typeof U=="string"&&xt.ZP.warning(U);return}var J=k(w,function(ne){u({nodeData:ne,targetNodeId:R.id.toString()}),l.addEdge(w),(0,be.qf)(w),w.toFront(),(0,be.$3)(l)});if(!J){if(L.type==="Loop"||R.type==="Loop"){console.log(D);var X=(0,be.Ob)(L,R);if(X&&typeof X!="string"){u({nodeData:X,targetNodeId:R.id.toString()}),l.addEdge(w),(0,be.qf)(w),w.toFront();return}}if(L.type===N.C8.Condition||L.type===N.C8.IntentRecognition||L.type===N.C8.QA&&L.nodeConfig.answerType===N.J4.SELECT){var ee=(0,be.i6)(L,R,D);u({nodeData:ee,targetNodeId:R.id.toString()})}else i({type:ce.I3.created,targetId:Z,sourceNode:L,id:w.id});l.addEdge(w),(0,be.qf)(w),setTimeout(function(){L.loopNodeId||R.loopNodeId?w.prop("zIndex",15):w.prop("zIndex",1),(0,be.$3)(l)},0)}}}}),l.on("scale",function(g){var f=g.sx;o(f)}),l.on("node:change:size",function(g){var f=g.node,c=f.getChildren();c&&c.length&&f.prop("originSize",f.getSize())}),l.on("node:change:position",function(g){var f,c=g.node;c.getData().type!=="Loop"&&c.toFront();var S=c.getParent(),w=c.getData();if(!S&&w.loopNodeId){var P=l.getCellById(w.loopNodeId);P&&P.isNode()&&(S=P,S instanceof ct.NB&&(0,be.HP)(S))}S&&S.isNode()&&((f=S.getData())===null||f===void 0?void 0:f.type)==="Loop"&&(0,be.HP)(S)}),(0,be.JM)({graph:l,changeZIndex:T}),l},Vs=Ms,Us=["nodeConfig"],ta="graph-container",Ws=(0,s.forwardRef)(function(C,n){var t=C.graphParams,r=C.changeDrawer,a=C.changeEdge,i=C.changeCondition,u=C.copyNode,o=C.removeNode,y=C.changeZoom,I=C.createNodeByPortOrEdge,x=C.onSaveNode,m=C.onClickBlank,p=C.onInit,l=C.onRefresh,j=ze.Z.useApp(),T=j.modal,d=j.message;Ls();var k=(0,s.useRef)(null),g=(0,s.useRef)(null),f=(0,s.useRef)(!1);function c(){var re=k.current;if(re){var te=document.createElement("div");te.id=ta,re?.appendChild(te)}}var S=function(te){var Y=g.current.getNodes().filter(function(ae){var pe=ae.getData();return te(pe)});return Y.length&&Y.forEach(function(ae){var pe;ae.prop("zIndex",4);var xe=ae.getData();(pe=xe.innerNodes)!==null&&pe!==void 0&&pe.length&&xe.innerNodes.forEach(function(en){var bn=(0,se.Tw)(xe.id,en),Bn=g.current.addNode(bn);ae.addChild(Bn)})}),Y},w=function(te){var Y=te.map(function(ae){return(0,se.jN)(ae)}).filter(Boolean);g.current.addEdges(Y),(0,be.$3)(g.current)},P=function(te,Y){var ae=g.current.clientToGraph(te.x,te.y),pe=(0,ut.KW)(Y),xe=pe.width,en=pe.height,bn=g.current.addNode({shape:Y.shape,id:Y.id,x:ae.x,y:ae.y,width:xe,height:en,data:h()({},Y),resizable:!0,zIndex:99,ports:(0,se.Dw)(Y)});if(g.current.addNode(bn),Y.loopNodeId){var Bn=g.current.getCellById(bn.id),Zn=g.current.getCellById(Y.loopNodeId);Zn.addChild(Bn),(0,be.HP)(Zn);var Jn=Zn.getSize(),it=Zn.getPosition(),Fn=Zn.getData();Fn.nodeConfig.extension=h()(h()({},Fn.nodeConfig.extension),{},{width:Jn.width,height:Jn.height,x:it.x,y:it.y}),i({nodeData:Fn})}},Z=function(te,Y){if(g.current){P(te,Y);var ae=S(function(xe){return xe.id===Y.id&&xe.type==="Loop"});if(ae.length){var pe=[];ae.forEach(function(xe){var en=xe.getData();pe=pe.concat((0,se.W8)([en],!1)),en.innerNodes&&en.innerNodes.length>0&&(pe=pe.concat((0,se.W8)(en.innerNodes,!1)))}),w(pe)}}},D=function(te,Y){if(!(!g.current||!Y)){var ae=g.current.getCellById(te);if(ae&&ae.isNode()){var pe=ae.getPosition();if(pe&&(Y.nodeConfig||(Y.nodeConfig={extension:{}}),Y.nodeConfig.extension=h()(h()({},Y.nodeConfig.extension),{},{x:pe.x,y:pe.y})),(0,be.J7)(Y)){var xe=(0,se.Dw)(Y);if(Y.type===N.C8.QA||Y.type===N.C8.Condition){var en=(0,se.ZI)({data:Y,ports:xe.items,type:ce.yn.update}),bn=en.width,Bn=en.height;ae.setSize(bn,Bn)}ae.prop("ports",xe)}ae.updateData(Y)}}},V=function(te,Y,ae){if(g.current){var pe=g.current.getCellById(ae);if(!(!pe||!pe.isNode())){var xe=pe.getData();if(xe){var en=xe.nodeConfig,bn=Ve()(xe,Us),Bn=Object.keys(te).reduce(function(it,Fn){return typeof Fn=="string"&&Fn&&(it[Fn]=Y[Fn]),it},{});D(ae,h()(h()({},bn),{},{nodeConfig:(0,Be.Gm)((0,Be.Xh)(en),Bn)}));var Zn=bn.loopNodeId;if(Zn){var Jn=g.current.getCellById(Zn.toString());Jn&&(0,be.HP)(Jn)}}}}},L=function(te,Y){if(g.current&&(g.current.removeCell(te),Y&&Y.loopNodeId)){var ae=g.current.getCellById(Y.loopNodeId);(0,be.HP)(ae)}},R=function(te){if(g.current){var Y=g.current.getCellById(te);if(Y&&Y.isEdge()){var ae=Y.getSourceNode();if(ae){var pe=ae.getData().nextNodeIds;pe&&ae.updateData({nextNodeIds:pe.filter(function(xe){return xe!==Number(Y.getTargetNode().id)})})}}g.current.removeCell(te)}},U=function(te,Y,ae){var pe=(0,se.jN)({source:te,target:Y,zIndex:ae?25:1});g.current&&g.current.addEdge(pe)},J=function(te){var Y=g.current.getCellById(te);if(!(!Y||!g.current)){Y.updateData({isFocus:!1}),g.current.cleanSelection();var ae=g.current.getSelectedCells();g.current.unselect(ae),g.current.select(Y)}},X=function(te,Y){var ae=g.current.getCellById(te);if(!(!ae||!g.current)){var pe=ae.getData();ae.updateData({isFocus:!0,runResults:[].concat(G()((pe.runResults||[]).filter(function(xe){return xe.status!==N.Ss.EXECUTING})),[Y])}),g.current.select(ae)}},ee=function(){if(g.current){var te=g.current.getNodes();te.forEach(function(Y){Y.updateData({runResults:[]})})}},ne=function(){g.current&&g.current.trigger("blank:click")},ie=function(te){g.current&&g.current.zoomTo(Number(te))},de=function(){g.current&&g.current.zoomToFit({padding:{top:146,left:18,right:18,bottom:18},maxScale:1,minScale:.2,preserveAspectRatio:!0,useCellGeometry:!0})},ge=function(){if(g.current&&t.nodeList.length>0){g.current.clearCells();var te=t.nodeList.filter(function(ae){return!ae.loopNodeId}),Y=te.map(function(ae){return(0,se.QP)(ae)});g.current.fromJSON({nodes:Y}),S(function(ae){return ae.type===N.C8.Loop}),w(t.edgeList),g.current.once("render:done",function(){setTimeout(function(){de(),p()},20)})}},_e=function(){if(!g.current)return{x:0,y:0,width:0,height:0};var te=g.current.getGraphArea();return{x:te.x,y:te.y,width:te.width,height:te.height}},Cn=function(){return g.current};(0,s.useImperativeHandle)(n,function(){return{getCurrentViewPort:_e,graphAddNode:Z,graphUpdateNode:D,graphUpdateByFormData:V,graphDeleteNode:L,graphDeleteEdge:R,graphChangeZoom:ie,graphChangeZoomToFit:de,drawGraph:ge,graphSelectNode:J,graphCreateNewEdge:U,getGraphRef:Cn,graphTriggerBlankClick:ne,graphActiveNodeRunResult:X,graphResetRunResult:ee}});var De=(0,s.useCallback)(function(){var re=q()(K()().mark(function te(Y){var ae;return K()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,i(Y);case 2:return ae=xe.sent,ae||l(),xe.abrupt("return",ae);case 5:case"end":return xe.stop()}},te)}));return function(te){return re.apply(this,arguments)}}(),[i,l]),ue=(0,s.useCallback)(function(){var re=q()(K()().mark(function te(Y){var ae;return K()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,a(Y);case 2:return ae=xe.sent,ae||l(),xe.abrupt("return",ae);case 5:case"end":return xe.stop()}},te)}));return function(te){return re.apply(this,arguments)}}(),[a,l]);return(0,s.useEffect)(function(){if(k.current){c(),g.current=Vs({containerId:ta,changeDrawer:r,changeCondition:i,changeNodeConfigWithRefresh:De,changeEdgeConfigWithRefresh:ue,changeZoom:y,createNodeByPortOrEdge:I,onSaveNode:x,onClickBlank:m});var re=ms({graph:g.current,changeEdgeConfigWithRefresh:ue,copyNode:u,changeNodeConfigWithRefresh:De,removeNode:o,modal:T,message:d});return function(){setTimeout(function(){re(),g.current&&g.current.dispose()},100)}}},[]),(0,s.useEffect)(function(){t.nodeList.length===0&&(f.current=!1)},[t.nodeList]),(0,s.useEffect)(function(){t.nodeList.length>0&&!f.current&&(ge(),f.current=!0)},[t.nodeList]),(0,e.jsx)("div",{ref:k,id:ta})}),_s=Ws,Ks=E(86230),$s=E(61606),Gs=E(89858),Hs=E(7036),zs=function(n){var t=n.isValidLoading,r=n.info,a=n.onToggleVersionHistory,i=n.setShowCreateWorkflow,u=n.showPublish,o=(0,ke.useParams)(),y=o.spaceId,I=r.name,x=r.icon,m=r.publishStatus,p=r.modified,l=r.description,j=r.publishDate,T=(0,s.useMemo)(function(){if(r){var d;return!(r!=null&&(d=r.permissions)!==null&&d!==void 0&&d.includes(N.jE.Publish))}else return!1},[r]);return(0,e.jsxs)("div",{className:"fold-header-style flex items-center gap-20",children:[(0,e.jsxs)("div",{className:"dis-left flex-1",children:[(0,e.jsx)($s.Z,{className:"back-icon-style",onClick:function(){return(0,Ks.bC)("/space/".concat(y,"/library"))}}),(0,e.jsx)("img",{src:x||(0,se.Pk)(Se.qR.Workflow),alt:"",className:"header-icon-style"}),(0,e.jsx)("div",{className:"dis-col header-content-style ",children:(0,e.jsxs)("div",{className:"dis-left",children:[(0,e.jsx)("strong",{className:"header-name-style",children:I}),(0,e.jsx)(Re.Z,{content:l,children:(0,e.jsx)(En.Z,{className:"mr-6",style:{fontSize:"16px"}})}),m==="Published"&&(0,e.jsx)(Re.Z,{content:"\u5DF2\u53D1\u5E03",children:(0,e.jsx)(Aa.Z,{className:"mr-6",style:{color:"#00B23C",fontSize:"16px"}})}),(0,e.jsx)(Gs.Z,{onClick:i,style:{fontSize:"16px"}})]})})]}),(0,e.jsxs)("div",{className:"header-tag-style",children:[(0,e.jsxs)(Ye.Z,{color:"default",bordered:!1,children:["\u5DF2\u81EA\u52A8\u4FDD\u5B58 ",(0,jn.hK)(p??new Date().toString())]}),j===null&&(0,e.jsx)(Ye.Z,{color:"#EBECF5",style:{color:"rgba(15,21,40,0.82)"},children:"\u672A\u53D1\u5E03"}),j!==null&&j!==p&&(0,e.jsx)(Ye.Z,{bordered:!1,color:"volcano",children:"\u6709\u66F4\u65B0\u672A\u53D1\u5E03"})]}),(0,e.jsx)(Hs.Z,{className:"ico cursor-pointer",onClick:a}),(0,e.jsx)(le.ZP,{disabled:T,onClick:u,type:"primary",loading:t,children:t?"\u6821\u9A8C\u4E2D":"\u53D1\u5E03"})]})},Qs=zs,Js=["nodeConfig"],Xs=["nodeConfig"],Ys=["nodeConfig"],qs=Xn.Ne.filter(function(C){return[Se.qR.Plugin,Se.qR.Workflow,Se.qR.Table,Se.qR.MCP].includes(C.key)}),eo=function(){var n,t,r=(0,ke.useModel)("workflow"),a=r.getWorkflow,i=r.storeWorkflow,u=r.clearWorkflow,o=r.visible,y=r.setVisible,I=r.handleInitLoading,x=r.globalLoadingTime,m=(0,ke.useParams)(),p=Number(m.workflowId),l=Number(m.spaceId),j=(0,s.useState)(Ze.Ec),T=z()(j,2),d=T[0],k=T[1],g=(0,s.useState)(),f=z()(g,2),c=f[0],S=f[1],w=(0,s.useState)(""),P=z()(w,2),Z=P[0],D=P[1],V=(0,s.useState)(!1),L=z()(V,2),R=L[0],U=L[1],J=(0,s.useState)(!1),X=z()(J,2),ee=X[0],ne=X[1],ie=(0,s.useState)(!1),de=z()(ie,2),ge=de[0],_e=de[1],Cn=(0,s.useState)(!1),De=z()(Cn,2),ue=De[0],re=De[1],te=(0,s.useState)(Se.qR.Plugin),Y=z()(te,2),ae=Y[0],pe=Y[1],xe=(0,s.useState)({x:0,y:0}),en=z()(xe,2),bn=en[0],Bn=en[1],Zn=(0,s.useState)(!1),Jn=z()(Zn,2),it=Jn[0],Fn=Jn[1],Ge=(0,s.useRef)(null),to=F.Z.useForm(),ao=z()(to,1),In=ao[0],ro=(0,s.useState)(!1),ka=z()(ro,2),io=ka[0],wa=ka[1],so=(0,s.useState)({nodeList:[],edgeList:[]}),Ra=z()(so,2),Ba=Ra[0],aa=Ra[1],oo=(0,s.useState)({question:"",options:[]}),Za=z()(oo,2),lo=Za[0],uo=Za[1],co=(0,s.useState)({}),Pa=z()(co,2),po=Pa[0],vo=Pa[1],fo=(0,s.useState)({errorList:[],show:!1}),La=z()(fo,2),Bt=La[0],pt=La[1],go=(0,s.useState)(!1),Oa=z()(go,2),mo=Oa[0],Ma=Oa[1],Ne=(0,s.useRef)(null),Va=(0,s.useRef)(0),Zt=(0,s.useRef)(),ho=(0,s.useRef)(null),xo=(0,s.useState)(!1),Ua=z()(xo,2),Wa=Ua[0],ra=Ua[1],Co=(0,s.useState)(!1),_a=z()(Co,2),yo=_a[0],Wn=_a[1],No=(0,ke.useModel)("model"),jt=No.setTestRun,vt=(0,ke.useModel)("workflow"),Ka=vt.setReferenceList,Pn=vt.setIsModified,jo=vt.skillChange,ft=vt.setSkillChange,Pt=vt.isModified,Eo=vt.setSpaceId,st=function(){var A=new Date;S(function(v){return v?h()(h()({},v),{},{modified:A.toString()}):null})};(0,cr.Z)(Wa),dr();var bo=(0,s.useCallback)(function(_,A){var v=(0,ut.ed)(_,A,Ge.current);Ge.current=v},[Ge]);(0,s.useEffect)(function(){i("drawerForm",d),jo&&(In.setFieldsValue(d.nodeConfig),ft(!1))},[d]);var Lt=function(){var _=q()(K()().mark(function A(){var v,b,B;return K()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,M.next=3,qe.ZP.getDetails(p);case 3:v=M.sent,S(v.data),Eo(v.data.spaceId),b=v.data.nodes,B=(0,se.W8)(b),aa({edgeList:B,nodeList:b}),M.next=14;break;case 11:M.prev=11,M.t0=M.catch(0),console.error("Failed to fetch graph data:",M.t0);case 14:case"end":return M.stop()}},A,null,[[0,11]])}));return function(){return _.apply(this,arguments)}}(),Fo=function(){var _=q()(K()().mark(function A(v){var b;return K()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return ue&&re(!1),O.next=3,qe.ZP.updateDetails(v);case 3:b=O.sent,b.code===on.ZP.success&&(st(),Lt());case 5:case"end":return O.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Io=function(A){if(A===-1){var v;(v=Ne.current)===null||v===void 0||v.graphChangeZoomToFit()}else{var b;(b=Ne.current)===null||b===void 0||b.graphChangeZoom(A)}},So=function(A){S(function(v){return v?h()(h()({},v),{},{extension:{size:A}}):null})},Et=function(){var _=q()(K()().mark(function A(v){var b,B;return K()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(v===ce.zQ.empty||Va.current===v)){M.next=2;break}return M.abrupt("return",!1);case 2:return M.next=4,qe.ZP.getOutputArgs(v);case 4:return b=M.sent,B=b.code===on.ZP.success,B&&(b.data&&b.data.previousNodes&&b.data.previousNodes.length?Ka(b.data):Ka({previousNodes:[],innerPreviousNodes:[],argMap:{}})),M.abrupt("return",B);case 8:case"end":return M.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),$a=function(){var _=q()(K()().mark(function A(v){var b,B;return K()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,qe.ZP.getNodeConfig(v);case 2:if(b=M.sent,b.code!==on.ZP.success){M.next=7;break}return k(b.data),(B=Ne.current)===null||B===void 0||B.graphUpdateNode(String(b.data.id),b.data),M.abrupt("return",b.data);case 7:return M.abrupt("return",!1);case 8:case"end":return M.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),bt=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve,fe=arguments;return K()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(b=fe.length>1&&fe[1]!==void 0?fe[1]:function(){return Et(a("drawerForm").id)},B=v.type,O=v.targetId,M=v.sourceNode,W=v.id,Ne.current){Pe.next=4;break}return Pe.abrupt("return",!1);case 4:return $=Ne.current,H=$.graphUpdateNode,oe=$.graphDeleteEdge,Pe.next=7,vr({type:B,targetId:O,sourceNode:M,id:W,graphUpdateNode:H,graphDeleteEdge:oe,callback:b});case 7:return ve=Pe.sent,ve&&(st(),bo("sourceNode",{nextNodeIds:ve})),Pe.abrupt("return",ve);case 10:case"end":return Pe.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Ao=function(){var _=q()(K()().mark(function A(v){var b,B,O,M;return K()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(v.id!==ce.zQ.empty){$.next=2;break}return $.abrupt("return",!1);case 2:return B=(0,Be.Xh)(v),(b=Ne.current)===null||b===void 0||b.graphUpdateNode(String(B.id),B),O=!1,$.next=7,(0,ut.zD)(B);case 7:if(M=$.sent,M.code!==on.ZP.success){$.next=14;break}return v.id===a("drawerForm").id&&k(B),$.next=12,Et(a("drawerForm").id);case 12:st(),O=!0;case 14:return $.abrupt("return",O);case 15:case"end":return $.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Ln=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve,fe,Ae,Pe=arguments;return K()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(B=v.nodeData,O=v.update,M=v.targetNodeId,W=Pe.length>1&&Pe[1]!==void 0?Pe[1]:function(){return Et(a("drawerForm").id)},$=(0,Be.Xh)(B),H=O&&O===ce.Yi.moved,H&&B.id===a("drawerForm").id&&(ve=(oe=ho.current)===null||oe===void 0?void 0:oe.getFormValues(),$=h()(h()({},B),{},{nodeConfig:h()(h()(h()({},B.nodeConfig),ve),{},{extension:h()({},B.nodeConfig.extension)})})),$.id!==ce.zQ.empty){je.next=7;break}return je.abrupt("return",!1);case 7:return(b=Ne.current)===null||b===void 0||b.graphUpdateNode(String($.id),$),je.next=10,(0,ut.zD)($);case 10:if(fe=je.sent,Ae=fe&&fe.code===on.ZP.success,!Ae){je.next=20;break}if(st(),!H){je.next=16;break}return je.abrupt("return",!0);case 16:return M&&$.type===N.C8.Loop&&$a(Number(B.id)),$.id===a("drawerForm").id&&k($),W(),je.abrupt("return",!0);case 20:return je.abrupt("return",!1);case 21:case"end":return je.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),gt=(0,s.useCallback)(function(){var _=q()(K()().mark(function A(v){var b,B,O,M;return K()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return b=!1,$.prev=1,B=In.getFieldsValue(!0),([N.C8.IntentRecognition,N.C8.Condition].includes(v.type)||v.type===N.C8.QA&&B.answerType===N.J4.SELECT)&&v.id===a("drawerForm").id?(M=(0,ut.$N)(v.type,B,v.nodeConfig),O=h()(h()({},v),{},{nodeConfig:h()(h()({},v.nodeConfig),M)})):(O=h()(h()({},v),{},{nodeConfig:h()(h()({},v.nodeConfig),B)}),v.type===N.C8.QA&&(O.nextNodeIds=[])),$.next=6,Ao(O);case 6:b=$.sent,$.next=13;break;case 9:$.prev=9,$.t0=$.catch(1),console.error("\u8868\u5355\u63D0\u4EA4\u5931\u8D25:",$.t0),b=!1;case 13:return $.abrupt("return",b);case 14:case"end":return $.stop()}},A,null,[[1,9]])}));return function(A){return _.apply(this,arguments)}}(),[In]),Ot=(0,s.useCallback)(q()(K()().mark(function _(){var A,v,b,B,O,M,W;return K()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(A=!1,v=a("skillChange"),a("isModified")!==!1){H.next=4;break}return H.abrupt("return",A);case 4:return H.prev=4,Pn(!1),H.next=8,gt(a("drawerForm"));case 8:if(A=H.sent,!v){H.next=16;break}return H.next=12,qe.ZP.getNodeConfig(a("drawerForm").id);case 12:b=H.sent,B=b.code===on.ZP.success,O=b.data,B&&O&&O.nodeConfig[Ze.Fw]?(W=(0,ut.gc)(In.getFieldsValue(!0)[Ze.Fw]||[],O.nodeConfig[Ze.Fw]),In.setFieldValue(Ze.Fw,W),ft(!1),k(b.data),(M=Ne.current)===null||M===void 0||M.graphUpdateNode(String(O.id),O)):ft(!1);case 16:H.next=22;break;case 18:H.prev=18,H.t0=H.catch(4),console.error("Failed to fetch node config:",H.t0),ft(!1);case 22:return H.abrupt("return",A);case 23:case"end":return H.stop()}},_,null,[[4,18]])})),[Pn,In,ft]),Ft=(0,s.useCallback)(function(){var _=q()(K()().mark(function A(v){var b,B,O;return K()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:b=a("isModified"),B=a("drawerForm"),b===!0&&B?.id!==0?(Pn(!1),gt(B),Zt.current&&clearTimeout(Zt.current)):v&&v.id!==0&&Et(v.id),v&&v.type!==N.C8.Start&&(jt(!1),D("")),O=a("visible"),k(function($){return jt(!1),$.id===ce.zQ.empty&&v===null?(y(!1),$):v!==null?(O||y(!0),v):(y(!1),{id:ce.zQ.empty,shape:N.K$.General,description:"",workflowId:p,type:N.C8.Start,nodeConfig:{},name:"",icon:""})});case 6:case"end":return W.stop()}},A)}));return function(A){return _.apply(this,arguments)}}(),[]),Ga=function(A){return A===N.C8.Condition||A===N.C8.IntentRecognition},Do=function(){var _=q()(K()().mark(function A(v,b){return K()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return ft(!0),O.next=3,Ln({nodeData:h()(h()({},v),{},{nodeConfig:h()(h()({},v.nodeConfig),{},{knowledgeBaseConfigs:b})})});case 3:case"end":return O.stop()}},A)}));return function(v,b){return _.apply(this,arguments)}}(),To=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve;return K()().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return b=v.sourceNode,B=v.portId,O=v.newNodeId,M=v.targetNode,W=v.isLoop,$=(0,se.k6)(b,B,O,M),Ae.next=4,Ln({nodeData:$},Be.ZT);case 4:H=Ae.sent,H&&(ve=B.split("-").slice(0,-1).join("-"),(oe=Ne.current)===null||oe===void 0||oe.graphCreateNewEdge(ve,String(O),W));case 6:case"end":return Ae.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),ko=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve;return K()().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return b=v.sourceNode,B=v.portId,O=v.newNodeId,M=v.targetNode,W=v.isLoop,$=(0,se.Le)({sourceNode:b,id:O,targetNodeId:M?.id}),Ae.next=4,Ln({nodeData:$},Be.ZT);case 4:H=Ae.sent,H&&(ve=B.split("-").slice(0,-1).join("-"),(oe=Ne.current)===null||oe===void 0||oe.graphCreateNewEdge(ve,String(O),W));case 6:case"end":return Ae.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),wo=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W;return K()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return b=v.newNodeId,B=v.sourceNode,O=v.isLoop,H.next=3,bt({type:ce.I3.created,targetId:b.toString(),sourceNode:B},Be.ZT);case 3:M=H.sent,M&&((W=Ne.current)===null||W===void 0||W.graphCreateNewEdge(String(B.id),String(b),O));case 5:case"end":return H.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Ro=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe;return K()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return b=v.newNode,B=v.targetNode,O=v.isLoop,M=(0,se.F8)(b,B),W=M.nodeData,$=M.sourcePortId,fe.next=4,Ln({nodeData:W},Be.ZT);case 4:H=fe.sent,H&&((oe=Ne.current)===null||oe===void 0||oe.graphCreateNewEdge($,String(B.id),O));case 6:case"end":return fe.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Bo=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$;return K()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return b=v.newNodeId,B=v.targetNodeId,O=v.newNode,M=v.isLoop,oe.next=3,bt({type:ce.I3.created,targetId:B,sourceNode:O},Be.ZT);case 3:W=oe.sent,W&&(($=Ne.current)===null||$===void 0||$.graphCreateNewEdge(String(b),B,M));case 5:case"end":return oe.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Zo=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve,fe,Ae,Pe;return K()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(b=v.newNode,B=v.sourceNode,O=v.portId,M=v.isLoop,W=O.split("-")[0],!Ga(b.type)){je.next=10;break}return $=(0,se.F8)(b,B),H=$.nodeData,oe=$.sourcePortId,je.next=6,Ln({nodeData:H},Be.ZT);case 6:ve=je.sent,ve&&((fe=Ne.current)===null||fe===void 0||fe.graphCreateNewEdge(oe,B.id.toString(),M)),je.next=14;break;case 10:return je.next=12,bt({type:ce.I3.created,targetId:W,sourceNode:b},Be.ZT);case 12:Ae=je.sent,Ae&&((Pe=Ne.current)===null||Pe===void 0||Pe.graphCreateNewEdge(b.id.toString(),W.toString(),M));case 14:case"end":return je.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Po=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H;return K()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(b=v.newNode,B=v.targetNode,O=v.sourceNode,M=v.edgeId,W=v.isLoop,!Ga(b.type)){ve.next=6;break}return ve.next=4,Ro({newNode:b,targetNode:B,isLoop:W});case 4:ve.next=8;break;case 6:return ve.next=8,Bo({newNodeId:b.id,targetNodeId:B.id.toString(),newNode:b,isLoop:W});case 8:return console.timeLog("createNoeByPortOrEdge","addNode:handleTargetNodeConnection:deleteEdge",M),ve.next=11,bt({type:ce.I3.deleted,targetId:B.id.toString(),sourceNode:O},Be.ZT);case 11:$=ve.sent,$&&((H=Ne.current)===null||H===void 0||H.graphDeleteEdge(M));case 13:case"end":return ve.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Lo=function(){var _=q()(K()().mark(function A(v,b){var B,O,M,W,$,H,oe,ve,fe,Ae,Pe,yn,je,Me,Nn,nr;return K()().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(W=(0,se.uP)(v.type),$=v.nodeConfig,H=Ve()(v,Js),oe=b.nodeConfig||{},ve=oe.toolName,fe=oe.mcpId,Ae=h()(h()({},H),{},{shape:W,nodeConfig:h()(h()({},$),ve?{toolName:ve,mcpId:fe}:{})}),Pe=$?.extension||{},(B=Ne.current)===null||B===void 0||B.graphAddNode(Pe,Ae),!(b.type===N.C8.Knowledge&&(O=b.nodeConfig)!==null&&O!==void 0&&O.knowledgeBaseConfigs)){Te.next=9;break}return Te.next=9,Do(Ae,b.nodeConfig.knowledgeBaseConfigs);case 9:return Te.next=11,Ft(Ae);case 11:if((M=Ne.current)===null||M===void 0||M.graphSelectNode(String(v.id)),st(),!Ge.current){Te.next=49;break}if(yn=Ge.current,je=yn.portId,Me=yn.edgeId,Nn=!!v.loopNodeId,nr=je.endsWith("out"),Te.prev=17,!je.includes(ce.TG.exception)){Te.next=23;break}return Te.next=21,ko({sourceNode:Ge.current.sourceNode,portId:je,newNodeId:v.id,targetNode:Ge.current.targetNode,isLoop:Nn});case 21:Te.next=35;break;case 23:if(!(je.length>15)){Te.next=28;break}return Te.next=26,To({sourceNode:Ge.current.sourceNode,portId:je,newNodeId:v.id,targetNode:Ge.current.targetNode,isLoop:Nn});case 26:Te.next=35;break;case 28:if(!nr){Te.next=33;break}return Te.next=31,wo({newNodeId:v.id,sourceNode:Ge.current.sourceNode,isLoop:Nn});case 31:Te.next=35;break;case 33:return Te.next=35,Zo({newNode:Ae,sourceNode:Ge.current.sourceNode,portId:je,isLoop:Nn});case 35:if(!Ge.current.targetNode){Te.next=38;break}return Te.next=38,Po({newNode:Ae,targetNode:Ge.current.targetNode,sourceNode:Ge.current.sourceNode,edgeId:Me,isLoop:Nn});case 38:return Te.next=40,Et(a("drawerForm").id);case 40:Te.next=46;break;case 42:throw Te.prev=42,Te.t0=Te.catch(17),console.error("\u5904\u7406\u8282\u70B9\u8FDE\u63A5\u65F6\u53D1\u751F\u9519\u8BEF:",Te.t0),Te.t0;case 46:return Te.prev=46,Ge.current=null,Te.finish(46);case 49:case"end":return Te.stop()}},A,null,[[17,42,46,49]])}));return function(v,b){return _.apply(this,arguments)}}(),Ha=function(){var _=q()(K()().mark(function A(v,b){var B,O,M,W,$,H,oe,ve,fe,Ae,Pe,yn;return K()().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(B=JSON.parse(JSON.stringify(v)),B.workflowId=p,B.extension=b,O=(0,se.ZI)({data:B,ports:[],type:ce.yn.create}),M=O.width,W=O.height,$=[N.C8.Condition,N.C8.QA,N.C8.IntentRecognition,N.C8.Loop],v.type&&$.includes(v.type)&&(B.extension=h()(h()({},b),{},{height:W,width:M})),!(d.type===N.C8.Loop||d.loopNodeId)){Me.next=15;break}if(B.type!==N.C8.Loop){Me.next=10;break}return xt.ZP.warning("\u5FAA\u73AF\u4F53\u91CC\u8BF7\u4E0D\u8981\u518D\u6DFB\u52A0\u5FAA\u73AF\u4F53"),Me.abrupt("return",!1);case 10:return B.loopNodeId=Number(d.loopNodeId)||Number(d.id),Me.next=13,qe.ZP.getNodeConfig(B.loopNodeId);case 13:H=Me.sent,H.code===on.ZP.success&&(oe=H.data,ve=oe.nodeConfig.extension,B.extension=h()(h()({},B.extension),{},{x:(ve?.x||0)+40,y:(ve?.y||0)+110}));case 15:return Ge.current&&(fe=Ge.current.sourceNode,fe.loopNodeId&&(B.loopNodeId=fe.loopNodeId)),Ae=B.nodeConfig,Pe=Ve()(B,Xs),Me.next=19,qe.ZP.apiAddNode(h()({nodeConfigDto:h()({},Ae)},Pe));case 19:if(yn=Me.sent,yn.code!==on.ZP.success){Me.next=29;break}return Me.prev=21,Me.next=24,Lo(yn.data,v);case 24:Me.next=29;break;case 26:Me.prev=26,Me.t0=Me.catch(21),console.error("\u5904\u7406\u8282\u70B9\u521B\u5EFA\u6210\u529F\u540E\u7684\u64CD\u4F5C\u5931\u8D25:",Me.t0);case 29:case"end":return Me.stop()}},A,null,[[21,26]])}));return function(v,b){return _.apply(this,arguments)}}(),za=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe,ve,fe,Ae,Pe,yn,je;return K()().wrap(function(Nn){for(;;)switch(Nn.prev=Nn.next){case 0:return Nn.next=2,qe.ZP.apiCopyNode(v.id.toString());case 2:b=Nn.sent,b.code===on.ZP.success&&(M=b.data,W=M.nodeConfig,$=Ve()(M,Ys),H=W?.extension||{},oe=v.nodeConfig||{},ve=oe.toolName,fe=oe.mcpId,Ae=h()(h()({},$),{},{shape:(0,se.uP)(b.data.type),nodeConfig:h()(h()(h()({},W),ve?{toolName:ve,mcpId:fe}:{}),{},{extension:h()(h()({},H),{},{x:(H.x||0)+32,y:(H.y||0)+32})})}),Pe={x:(H.x||0)+20,y:(H.y||0)+20},(B=Ne.current)===null||B===void 0||B.graphAddNode(Pe,Ae),yn=(0,se.uP)(b.data.type),je=h()(h()({},b.data),{},{shape:yn}),Ln({nodeData:je}),(O=Ne.current)===null||O===void 0||O.graphSelectNode(String(b.data.id)));case 4:case"end":return Nn.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Qa=function(){var _=q()(K()().mark(function A(v,b){var B,O;return K()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return y(!1),Va.current=Number(v),k({id:0,description:"",shape:N.K$.General,workflowId:p,type:N.C8.Start,nodeConfig:{},name:"",icon:""}),W.next=5,qe.ZP.apiDeleteNode(v);case 5:B=W.sent,B.code===on.ZP.success&&((O=Ne.current)===null||O===void 0||O.graphDeleteNode(String(v)),Zt.current&&clearTimeout(Zt.current),st(),b&&(b.type==="Loop"?Ft(null):$a(b.loopNodeId)));case 7:case"end":return W.stop()}},A)}));return function(v,b){return _.apply(this,arguments)}}(),Oo=function(A,v){if(!(v&&v!=="workflow")){var b;if(A.targetType===Se.qR.Knowledge||A.targetType===Se.qR.Table){var B=[h()(h()({},A),{},{type:N.C8.Knowledge,knowledgeBaseId:A.targetId})],O=sessionStorage.getItem("tableType");b={name:A.name,shape:N.K$.General,description:A.description,type:A.targetType===Se.qR.Knowledge?N.C8.Knowledge:O||N.C8.TableDataQuery,typeId:A.targetId,nodeConfig:{knowledgeBaseConfigs:B,extension:{}}}}else if(A.targetType===Se.qR.Workflow||A.targetType===Se.qR.Plugin){var M=A.targetType===Se.qR.Workflow?N.C8.Workflow:N.C8.Plugin;b={name:A.name,shape:N.K$.General,description:A.description,type:M,typeId:A.targetId}}else if(A.targetType===Se.qR.MCP)b={name:A.name,shape:N.K$.General,description:A.description,type:N.C8.MCP,typeId:A.targetId,nodeConfig:{toolName:A.toolName,mcpId:A.targetId}};else{xt.ZP.warning("\u6682\u4E0D\u652F\u6301\u8BE5\u7C7B\u578B\u7EC4\u4EF6");return}Ha(b,bn),sessionStorage.getItem("tableType")&&sessionStorage.removeItem("tableType"),_e(!1)}},Ja=function(){var _=q()(K()().mark(function A(v,b,B){var O,M,W,$,H,oe;return K()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(M=v?.type||"",W=[N.C8.Plugin,N.C8.Workflow,N.C8.MCP].includes(M),$=["TableDataAdd","TableDataDelete","TableDataUpdate","TableDataQuery","TableSQL"].includes(M),H=(O=Ne.current)===null||O===void 0?void 0:O.getCurrentViewPort(),!W){fe.next=10;break}pe(M),_e(!0),Bn((0,be.Pk)(b,H,B)),fe.next=20;break;case 10:if(!$){fe.next=17;break}pe(Se.qR.Table),_e(!0),Bn((0,be.Pk)(b,H,B)),sessionStorage.setItem("tableType",M),fe.next=20;break;case 17:return oe=(0,be.Pk)(b,H,B),fe.next=20,Ha(v,oe);case 20:case"end":return fe.stop()}},A)}));return function(v,b,B){return _.apply(this,arguments)}}(),Mo=function(){var _=q()(K()().mark(function A(){var v,b,B,O,M,W;return K()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(Wn(!1),a("isModified")!==!0){H.next=4;break}return H.next=4,Ot();case 4:return H.next=6,qe.ZP.getDetails(p);case 6:return b=H.sent,B=b.data.nodes,aa(function(oe){return h()(h()({},oe),{},{nodeList:B})}),Ft(b.data.startNode),(v=Ne.current)===null||v===void 0||v.graphSelectNode(String(b.data.startNode.id)),H.next=13,qe.ZP.validWorkflow(c?.id);case 13:if(O=H.sent,O.code!==on.ZP.success){H.next=25;break}if(M=O.data.filter(function(oe){return!oe.success}),M.length!==0){H.next=20;break}return H.abrupt("return",!0);case 20:return W=M.map(function(oe){return{nodeId:oe.nodeId,error:oe.messages.join(",")}}),pt({show:!0,errorList:W}),H.abrupt("return",!1);case 23:H.next=26;break;case 25:return H.abrupt("return",!1);case 26:case"end":return H.stop()}},A)}));return function(){return _.apply(this,arguments)}}(),Vo=function(){ne(!1);var A=new Date;S(h()(h()({},c),{},{modified:A.toString(),publishDate:A.toString(),publishStatus:"Published"}))},Xa=function(){var A;D(""),(A=Ne.current)===null||A===void 0||A.graphResetRunResult()},Ya=function(){var _=q()(K()().mark(function A(v){var b,B;return K()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return b={nodeId:d.id,params:v},D(""),M.next=4,(0,sa.W)({url:"".concat("","/api/workflow/test/node/execute"),method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem(mt.LA)),Accept:" application/json, text/plain, */* "},body:b,onMessage:function($){$.success?($.complete&&($.data&&$.data.output&&D($.data.output),D(JSON.stringify($.data,null,2)),(0,se.gt)({spaceId:l,workflowId:p})),$.data.status==="STOP_WAIT_ANSWER"&&(Wn(!1),U(!0),(0,se.OF)({spaceId:l,workflowId:p,value:JSON.stringify(v)}))):$.message&&D($.message)},onError:function($){console.error("\u6D41\u5F0F\u8BF7\u6C42\u5F02\u5E38:",$)},onOpen:function($){console.log("\u8FDE\u63A5\u5DF2\u5EFA\u7ACB",$.status)},onClose:function(){Wn(!1)}});case 4:B=M.sent,B();case 6:case"end":return M.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),Uo=function(){var _=q()(K()().mark(function A(v){var b;return K()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return Wn(!0),O.next=3,(0,sa.W)({url:"".concat("","/api/workflow/test/execute"),method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem(mt.LA)),Accept:" application/json, text/plain, */* "},body:v,onMessage:function(W){if(W.data&&W.data.nodeId){var $,H={requestId:W.requestId,options:h()(h()({},W.data.result),{},{nodeId:W.data.nodeId,nodeName:W.data.nodeName}),status:W.data.status};($=Ne.current)===null||$===void 0||$.graphActiveNodeRunResult(W.data.nodeId.toString(),H)}W.success?(W.complete&&(W.data&&W.data.output&&(D(W.data.output),(0,se.gt)({spaceId:l,workflowId:p})),vo(W.nodeExecuteResultMap[(c?.startNode.id).toString()].data),D(JSON.stringify(W.data,null,2)),Wn(!1)),W.data.status==="STOP_WAIT_ANSWER"&&(Wn(!1),U(!0),(0,se.OF)({spaceId:l,workflowId:p,value:JSON.stringify(v)}),W.data.result&&uo(W.data.result.data))):pt(function(oe){return W.data&&W.data.result?{errorList:[].concat(G()(oe.errorList),[W.data.result]),show:!0}:W.data?oe:{errorList:[].concat(G()(oe.errorList),[{error:W.message}]),show:!0}})},onError:function(W){console.error("\u6D41\u5F0F\u8BF7\u6C42\u5F02\u5E38:",W)},onOpen:function(W){console.log("\u8FDE\u63A5\u5DF2\u5EFA\u7ACB",W.status)},onClose:function(){Wn(!1)}});case 3:b=O.sent,b(),st();case 6:case"end":return O.stop()}},A)}));return function(v){return _.apply(this,arguments)}}(),qa=function(){var _=q()(K()().mark(function A(){var v,b;return K()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return v=setTimeout(function(){Fn(!0)},300),O.prev=1,O.next=4,Mo();case 4:b=O.sent,b&&(D(""),jt(!0)),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(1),console.error("\u8BD5\u8FD0\u884C\u6240\u6709\u8282\u70B9\u5931\u8D25:",O.t0);case 11:return O.prev=11,clearTimeout(v),Fn(!1),O.finish(11);case 15:case"end":return O.stop()}},A,null,[[1,8,11,15]])}));return function(){return _.apply(this,arguments)}}(),Wo=(0,s.useCallback)(function(){var _=q()(K()().mark(function A(v,b){var B,O;return K()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(pt({errorList:[],show:!1}),Xa(),v!=="Start"){W.next=8;break}O=(0,se.lr)({spaceId:l,workflowId:p}),O?(B=h()(h()({},JSON.parse(O)),b),U(!1),(0,se.gt)({spaceId:l,workflowId:p})):B={workflowId:c?.id,params:b,requestId:(0,Ee.Z)()},Uo(B),W.next=17;break;case 8:if(v!=="Code"){W.next=16;break}if(!Pt){W.next=13;break}return Pn(!1),W.next=13,gt(a("drawerForm"));case 13:Ya(b),W.next=17;break;case 16:Ya(b);case 17:Wn(!0);case 18:case"end":return W.stop()}},A)}));return function(A,v){return _.apply(this,arguments)}}(),[Pt,d.id]),_o=(0,s.useCallback)(function(){var _=q()(K()().mark(function A(v){return K()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:B.t0=v,B.next=B.t0==="Rename"?3:B.t0==="Delete"?5:B.t0==="Duplicate"?7:B.t0==="TestRun"?9:21;break;case 3:return wa(!0),B.abrupt("break",22);case 5:return Qa(d.id),B.abrupt("break",22);case 7:return za(d),B.abrupt("break",22);case 9:if(!Pt){B.next=13;break}return Pn(!1),B.next=13,gt(a("drawerForm"));case 13:if(a("drawerForm").type!==N.C8.Start){B.next=18;break}return B.next=16,qa();case 16:B.next=20;break;case 18:D(""),jt(!0);case 20:return B.abrupt("break",22);case 21:return B.abrupt("break",22);case 22:case"end":return B.stop()}},A)}));return function(A){return _.apply(this,arguments)}}(),[Pt,d.id]),Ko=(0,s.useCallback)(function(){var _;(_=Ne.current)===null||_===void 0||_.graphTriggerBlankClick()},[]),$o=(0,s.useCallback)(function(){Ft(null),y(!1)},[]),Go=function(A){var v=A.name,b=A.description,B=h()(h()({},d),{},{name:v,description:b});Ln({nodeData:B}),wa(!1)},Ho=(0,s.useCallback)(function(_,A){var v,b=h()(h()({},_),A);Ln({nodeData:b});var B=(v=Ne.current)===null||v===void 0?void 0:v.getGraphRef();if(B){var O=B.getCellById(_.id.toString());O&&(O.updateData({name:b.name}),k(function(M){return h()(h()({},M),{},{name:b.name})}))}else console.error("graph is null")},[Ln,k]),zo=function(A){a("visible")&&A&&A.id===a("drawerForm").id||Ft(A)},Qo=function(A){var v,b=(v=Ne.current)===null||v===void 0?void 0:v.getGraphRef(),B=b?.getCellById(A.toString());if(B){var O;(O=Ne.current)===null||O===void 0||O.graphSelectNode(A.toString())}},Jo=function(A){if(!(o&&A&&A.id===a("drawerForm").id)&&A){var v,b=(v=Ne.current)===null||v===void 0?void 0:v.getGraphRef(),B=b?.getCellById(A.id.toString());B&&b?.centerCell(B),Qo(A.id)}},Xo=function(){var _=q()(K()().mark(function A(v){var b,B,O,M,W,$,H,oe;return K()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return B=v.child,O=v.sourceNode,M=v.portId,W=v.position,$=v.targetNode,H=v.edgeId,Ge.current={sourceNode:O,portId:M,targetNode:$,edgeId:H},oe=(0,be.q7)({position:W,portId:M,type:B.type,hasTargetNode:!!$,sourceNodeId:O.id.toString(),graph:(b=Ne.current)===null||b===void 0?void 0:b.getGraphRef()}),fe.next=5,Ja(B,oe);case 5:case"end":return fe.stop()}},A)}));return function(v){return _.apply(this,arguments)}}();(0,s.useEffect)(function(){return Lt(),function(){Pn(function(_){return _===!0&&gt(a("drawerForm")),!1}),y(!1),jt(!1),u()}},[]),(0,s.useEffect)(function(){if(d.id!==0){var _=(0,Be.Xh)(d);In.resetFields(),In.setFieldsValue(_.nodeConfig),(0,se.wK)({type:_.type,nodeConfig:_.nodeConfig,form:In})}},[d.id,d.type]);var Yo=function(){var _=q()(K()().mark(function A(){var v,b,B;return K()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(Wn(!1),a("isModified")!==!0){M.next=4;break}return M.next=4,Ot();case 4:return M.next=6,qe.ZP.validWorkflow(c?.id);case 6:if(v=M.sent,v.code!==on.ZP.success){M.next=18;break}if(b=v.data.filter(function(W){return!W.success}),b.length!==0){M.next=13;break}return M.abrupt("return",!0);case 13:return B=b.map(function(W){return{nodeId:W.nodeId,error:W.messages.join(",")}}),pt({show:!0,errorList:B}),M.abrupt("return",!1);case 16:M.next=19;break;case 18:return M.abrupt("return",!1);case 19:case"end":return M.stop()}},A)}));return function(){return _.apply(this,arguments)}}(),qo=function(){var _=q()(K()().mark(function A(){var v,b;return K()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return v=setTimeout(function(){Ma(!0)},300),O.next=3,Yo();case 3:return b=O.sent,O.next=6,Lt();case 6:b&&(ne(!0),pt(h()(h()({},Bt),{},{errorList:[],show:!1}))),v&&clearTimeout(v),Ma(!1);case 9:case"end":return O.stop()}},A)}));return function(){return _.apply(this,arguments)}}();pr({run:(0,s.useCallback)(q()(K()().mark(function _(){var A;return K()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return A=a("drawerForm"),b.next=3,gt(A);case 3:return b.abrupt("return",b.sent);case 4:case"end":return b.stop()}},_)})),[]),doNext:(0,s.useCallback)(function(){Pn(!1)},[Pn])});var er=function(){var _=q()(K()().mark(function A(){return K()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return aa({nodeList:[],edgeList:[]}),b.next=3,Lt();case 3:case"end":return b.stop()}},A)}));return function(){return _.apply(this,arguments)}}(),el=(0,s.useCallback)(function(_,A){var v=a("drawerForm").id;!Ne.current||!v||v===ce.zQ.empty||Ne.current.graphUpdateByFormData(_,A,v.toString())},[Ne.current]),nl=ia(function(_,A){Pn(!1),el(_,A),Pn(!0)},500,{leading:!0,trailing:!0});return(0,e.jsxs)("div",{id:"container",children:[(0,e.jsx)(Qs,{isValidLoading:mo,info:c??{},onToggleVersionHistory:function(){return ra(!0)},setShowCreateWorkflow:function(){return re(!0)},showPublish:qo}),(0,e.jsx)(la.Z,{spinning:x>0,indicator:(0,e.jsx)(oa.Z,{spin:!0}),wrapperClassName:"spin-workflow-global-style",children:(0,e.jsx)(_s,{graphParams:Ba,ref:Ne,changeDrawer:zo,changeEdge:bt,changeCondition:Ln,removeNode:Qa,copyNode:za,changeZoom:So,createNodeByPortOrEdge:Xo,onSaveNode:Ho,onClickBlank:$o,onInit:I,onRefresh:er})}),(0,e.jsx)(ds,{dragChild:Ja,foldWrapItem:d,changeGraph:Io,handleTestRun:qa,testRunLoading:it,zoomSize:(n=c==null||(t=c.extension)===null||t===void 0?void 0:t.size)!==null&&n!==void 0?n:1}),(0,e.jsx)(Tn,{className:"fold-wrap-style",lineMargin:!0,title:d.name,visible:o,onClose:Ko,description:d.description,backgroundColor:(0,se.ys)(d.type),icon:(0,se.qM)(d.type),showNameInput:io,changeFoldWrap:Go,otherAction:(0,e.jsx)(Qe,{onChange:_o,testRun:Ze.fY.includes(d.type),nodeType:d.type,action:d.type!==N.C8.Start&&d.type!==N.C8.End}),children:(0,e.jsx)("div",{className:"dispose-node-style",children:(0,e.jsx)(F.Z,{form:In,layout:"vertical",onFinishFailed:Ot,onFinish:Ot,clearOnDestroy:!0,onValuesChange:function(A){nl(A,In.getFieldsValue(!0))},children:(0,e.jsx)(es,{params:d},"".concat(d.type,"-").concat(d.id,"-nodePanelDrawer"))},"".concat(d.type,"-").concat(d.id,"-form"))})},"".concat(d.type,"-").concat(d.id,"-foldWrap")),(0,e.jsx)(cn.Z,{checkTag:ae,onAdded:Oo,open:ge,tabs:qs,addComponents:[{type:Se.qR.Workflow,targetId:p,status:Se.BQ.Added}],onCancel:function(){return _e(!1)}}),(0,e.jsx)(or,{node:d,run:Wo,testRunResult:Z,clearRunResult:Xa,loading:yo,stopWait:R,formItemValue:po,testRunParams:lo}),(0,e.jsx)(pn.Z,h()({onConfirm:Fo,onCancel:function(){return re(!1)},open:ue,type:N.jA.Update},c)),(0,e.jsx)(vs,{visible:o,errorList:Bt.errorList,show:Bt.show,onClose:function(){return pt(h()(h()({},Bt),{},{errorList:[],show:!1}))},onClickItem:Jo,nodeList:Ba.nodeList}),(0,e.jsx)(Gn.Z,{mode:Se.qR.Workflow,targetId:p,spaceId:l,category:c?.category,open:ee,onCancel:function(){return ne(!1)},onConfirm:Vo}),(0,e.jsx)(lr.Z,{targetId:p,targetName:c?.name,targetType:Se.qR.Workflow,permissions:c?.permissions||[],visible:Wa,isDrawer:!0,onClose:function(){return ra(!1)},renderActions:function(A){return(0,e.jsx)(ts,{data:A,onRefresh:er,onClose:function(){return ra(!1)}})}})]})},no=eo},48512:function(ot,Sn,E){E.d(Sn,{DJ:function(){return h},RY:function(){return z},YM:function(){return le},b9:function(){return Re},iE:function(){return _n},x8:function(){return pn}});var An=E(65173),G=E(73415),Q=E(92122),Ve=E(56769),He=E(63619),K=E(28246),On=E(43898),q=E(52676),_n=[{name:"",key:"group1",children:[{name:"\u5927\u6A21\u578B",icon:(0,q.jsx)(G.EF,{}),bgIcon:G.G0,type:Q.C8.LLM,shape:Q.K$.General,description:"\u8C03\u7528\u5927\u8BED\u8A00\u6A21\u578B\uFF0C\u4F7F\u7528\u53D8\u91CF\u548C\u63D0\u793A\u8BCD\u751F\u6210\u56DE\u590D"},{name:"\u63D2\u4EF6",icon:(0,q.jsx)(G.KS,{}),bgIcon:G.SU,type:Q.C8.Plugin,shape:Q.K$.General,description:"\u5FC5\u5E94\u641C\u7D22\u5F15\u64CE\u3002\u5F53\u4F60\u9700\u8981\u641C\u7D22\u4F60\u4E0D\u77E5\u9053\u7684\u4FE1\u606F\uFF0C\u6BD4\u5982\u5929\u6C14..."},{name:"\u5DE5\u4F5C\u6D41",icon:(0,q.jsx)(G.fl,{}),bgIcon:G.Ls,type:Q.C8.Workflow,shape:Q.K$.General,description:"\u5FC5\u5E94\u641C\u7D22\u5F15\u64CE\u3002\u5F53\u4F60\u9700\u8981\u641C\u7D22\u4F60\u4E0D\u77E5\u9053\u7684\u4FE1\u606F\uFF0C\u6BD4\u5982\u5929\u6C14..."},{name:"MCP",icon:(0,q.jsx)(G.VE,{}),bgIcon:G.zH,type:Q.C8.MCP,shape:Q.K$.General,description:"MCP \u7EC4\u4EF6"}]},{name:"\u4E1A\u52A1\u903B\u8F91",key:"group2",children:[{name:"\u4EE3\u7801",icon:(0,q.jsx)(G.HF,{}),bgIcon:G.Po,type:Q.C8.Code,shape:Q.K$.General,description:"\u7F16\u5199\u4EE3\u7801\uFF0C\u5904\u7406\u8F93\u5165\u53D8\u91CF\u6765\u751F\u6210\u8FD4\u56DE\u503C"},{name:"\u6761\u4EF6\u5206\u652F",icon:(0,q.jsx)(G.ZO,{}),bgIcon:G.TK,type:Q.C8.Condition,shape:Q.K$.General,description:"\u8FDE\u63A5\u591A\u4E2A\u4E0B\u6E38\u5206\u652F\uFF0C\u82E5\u8BBE\u5B9A\u7684\u6761\u4EF6\u6210\u7ACB\u5219\u4EC5\u8FD0\u884C\u5BF9\u5E94\u7684\u5206\u652F\uFF0C\u82E5 \u5747\u4E0D\u6210\u7ACB\u5219\u53EA\u8FD0\u884C\u201C\u5426\u5219\u201D\u5206\u652F"},{name:"\u610F\u56FE\u8BC6\u522B",icon:(0,q.jsx)(G.mT,{}),bgIcon:G.cp,type:Q.C8.IntentRecognition,shape:Q.K$.General,description:"\u7528\u4E8E\u7528\u6237\u8F93\u5165\u7684\u610F\u56FE\u8BC6\u522B\uFF0C\u5E76\u5C06\u5176\u4E0E\u9884\u8BBE\u610F\u56FE\u9009\u9879\u8FDB\u884C\u5339\u914D\u3002"},{name:"\u5FAA\u73AF",icon:(0,q.jsx)(G.ZX,{}),bgIcon:G.bD,type:Q.C8.Loop,shape:Q.K$.Loop,description:"\u7528\u4E8E\u901A\u8FC7\u8BBE\u5B9A\u5FAA\u73AF\u6B21\u6570\u548C\u903B\u8F91\uFF0C\u91CD\u590D\u6267\u884C\u4E00\u7CFB\u5217\u4EFB\u52A1\u3002"},{name:"\u7EE7\u7EED\u5FAA\u73AF",icon:(0,q.jsx)(G.uS,{}),bgIcon:G.jI,type:Q.C8.LoopContinue,shape:Q.K$.General,description:""},{name:"\u7EC8\u6B62\u5FAA\u73AF",icon:(0,q.jsx)(G.QL,{}),bgIcon:G.J2,type:Q.C8.LoopBreak,shape:Q.K$.General,description:""}]},{name:"\u77E5\u8BC6&\u6570\u636E",key:"group3",children:[{name:"\u77E5\u8BC6\u5E93",icon:(0,q.jsx)(G.fF,{}),bgIcon:G.Lm,type:Q.C8.Knowledge,shape:Q.K$.General,description:"\u5728\u9009\u5B9A\u7684\u77E5\u8BC6\u4E2D\uFF0C\u6839\u636E\u8F93\u5165\u53D8\u91CF\u53EC\u56DE\u6700\u5339\u914D\u7684\u4FE1\u606F"},{name:"\u53D8\u91CF",icon:(0,q.jsx)(G.JU,{}),bgIcon:G.Hl,type:Q.C8.Variable,shape:Q.K$.General,description:"\u7528\u4E8E\u8BFB\u53D6\u548C\u5199\u5165\u9879\u76EE\u4E2D\u7684\u53D8\u91CF\uFF0C\u53D8\u91CF\u540D\u987B\u4E0E\u9879\u76EE\u4E2D\u7684\u53D8\u91CF\u540D\u76F8\u5339\u914D"},{name:"\u957F\u671F\u8BB0\u5FC6",icon:(0,q.jsx)(G.GY,{}),bgIcon:G.aA,type:Q.C8.LongTermMemory,shape:Q.K$.General,description:"\u7528\u4E8E\u8C03\u7528\u957F\u671F\u8BB0\u5FC6\uFF0C\u83B7\u53D6\u7528\u6237\u7684\u4E2A\u6027\u5316\u4FE1\u606F"}]},{name:"\u6570\u636E\u8868",key:"group4",children:[{name:"\u6570\u636E\u65B0\u589E",icon:(0,q.jsx)(G.wN,{}),bgIcon:G.Te,type:Q.C8.TableDataAdd,shape:Q.K$.General,description:"\u5BF9\u9009\u5B9A\u7684\u6570\u636E\u8868\u8FDB\u884C\u6570\u636E\u5199\u5165"},{name:"\u6570\u636E\u5220\u9664",icon:(0,q.jsx)(G.t_,{}),bgIcon:G.u8,type:Q.C8.TableDataDelete,shape:Q.K$.General,description:"\u5BF9\u9009\u5B9A\u7684\u6570\u636E\u8868\u6839\u636E\u6307\u5B9AID\u8FDB\u884C\u6570\u636E\u5220\u9664"},{name:"\u6570\u636E\u66F4\u65B0",icon:(0,q.jsx)(G.Lg,{}),bgIcon:G.Og,type:Q.C8.TableDataUpdate,shape:Q.K$.General,description:"\u5BF9\u9009\u5B9A\u7684\u6570\u636E\u8868\u6839\u636E\u6307\u5B9A\u6761\u4EF6\u8FDB\u884C\u6570\u636E\u66F4\u65B0"},{name:"\u6570\u636E\u67E5\u8BE2",icon:(0,q.jsx)(G.Qe,{}),bgIcon:G.c7,type:Q.C8.TableDataQuery,shape:Q.K$.General,description:"\u5BF9\u9009\u5B9A\u7684\u6570\u636E\u8868\u6839\u636E\u6307\u5B9A\u6761\u4EF6\u8FDB\u884C\u6570\u636E\u67E5\u8BE2"},{name:"SQL\u81EA\u5B9A\u4E49",icon:(0,q.jsx)(G.rX,{}),bgIcon:G.D9,type:Q.C8.TableSQL,shape:Q.K$.General,description:"\u53EF\u652F\u6301\u5BF9\u6570\u636E\u8868\u7684\u67E5\u8BE2\u63A7\u5236\uFF0C\u7528\u6237\u53EF\u67E5\u8BE2\u5176\u4ED6\u7528\u6237\u63D0\u4EA4\u7684\u6570\u636E\uFF0C\u7531\u5F00\u53D1\u8005\u63A7\u5236"}]},{name:"\u7EC4\u4EF6&\u5DE5\u5177",key:"group5",children:[{name:"\u95EE\u7B54",icon:(0,q.jsx)(G.MO,{}),bgIcon:G.HI,type:Q.C8.QA,shape:Q.K$.General,description:"\u652F\u6301\u4E2D\u95F4\u5411\u7528\u6237\u63D0\u95EE\u95EE\u9898"},{name:"\u6587\u672C\u5904\u7406",icon:(0,q.jsx)(G.lR,{}),bgIcon:G.v$,type:Q.C8.TextProcessing,shape:Q.K$.General,description:"\u7528\u4E8E\u5904\u7406\u591A\u4E2A\u5B57\u7B26\u4E32\u7C7B\u578B\u53D8\u91CF\u7684\u683C\u5F0F"},{name:"\u6587\u6863\u63D0\u53D6",icon:(0,q.jsx)(G.zL,{}),bgIcon:G.AR,type:Q.C8.DocumentExtraction,shape:Q.K$.General,description:"\u7528\u4E8E\u63D0\u53D6\u6587\u6863\u5185\u5BB9\uFF0C\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B: txt\u3001 markdown\u3001pdf\u3001 html\u3001 xlsx\u3001 xls\u3001 docx\u3001 csv\u3001 md\u3001 htm"},{name:"http\u8BF7\u6C42",icon:(0,q.jsx)(G.qm,{}),bgIcon:G.L5,type:Q.C8.HTTPRequest,shape:Q.K$.General,description:"\u7528\u4E8E\u914D\u7F6Ehttp\u8BF7\u6C42\u8C03\u7528\u5DF2\u6709\u7684\u670D\u52A1"}]},{name:"\u8F93\u51FA",key:"group6",children:[{name:"\u8FC7\u7A0B\u8F93\u51FA",icon:(0,q.jsx)(G.N$,{}),bgIcon:G.bi,type:Q.C8.Output,shape:Q.K$.General,description:"\u652F\u6301\u4E2D\u95F4\u8FC7\u7A0B\u7684\u6D88\u606F\u8F93\u51FA\uFF0C\u652F\u6301\u6D41\u5F0F\u548C\u975E\u6D41\u5F0F\u4E24\u79CD\u65B9\u5F0F"}]}],h=[{label:"String",value:Q.Gi.String},{label:"Integer",value:Q.Gi.Integer},{label:"Number",value:Q.Gi.Number},{label:"File",value:"File",children:[{label:"Doc",value:Q.Gi.File_Doc},{label:"Excel",value:Q.Gi.File_Excel},{label:"PPT",value:Q.Gi.File_PPT},{label:"Txt",value:Q.Gi.File_Txt},{label:"Image",value:Q.Gi.File_Image},{label:"Audio",value:Q.Gi.File_Audio},{label:"Video",value:Q.Gi.File_Video},{label:"Svg",value:Q.Gi.File_Svg},{label:"Code",value:Q.Gi.File_Code}]},{label:"Boolean",value:Q.Gi.Boolean},{label:"Object",value:Q.Gi.Object},{label:"Array<String>",value:Q.Gi.Array_String},{label:"Array<Integer>",value:Q.Gi.Array_Integer},{label:"Array<Number>",value:Q.Gi.Array_Number},{label:"Array<Boolean>",value:Q.Gi.Array_Boolean},{label:"Array<Object>",value:Q.Gi.Array_Object},{label:"Array<File>",value:"Array_File",children:[{label:"Default",value:Q.Gi.Array_File_Default},{label:"Array<Image>",value:Q.Gi.Array_File_Image},{label:"Array<Doc>",value:Q.Gi.Array_File_Doc},{label:"Array<Code>",value:Q.Gi.Array_File_Code},{label:"Array<PPT>",value:Q.Gi.Array_File_PPT},{label:"Array<Txt>",value:Q.Gi.Array_File_Txt},{label:"Array<Excel>",value:Q.Gi.Array_File_Excel},{label:"Array<Audio>",value:Q.Gi.Array_File_Audio},{label:"Array<Zip>",value:Q.Gi.Array_File_Zip},{label:"Array<Video>",value:Q.Gi.Array_File_Video},{label:"Array<Svg>",value:Q.Gi.Array_File_Svg}]}],Mn=[{label:"\u6807\u9898\u751F\u6210",icon:(0,q.jsx)(G.nG,{}),key:"\u6807\u9898\u751F\u6210",children:[{key:"output",label:"output",tag:"String"},{key:"setting",label:"Setting",tag:"Number"}]}],z=[{label:"\u4F7F\u7528\u6570\u7EC4\u5FAA\u73AF",value:"ARRAY_LOOP"},{label:"\u6307\u5B9A\u6B21\u6570\u5FAA\u73AF",value:"SPECIFY_TIMES_LOOP"},{label:"\u65E0\u9650\u5FAA\u73AF",value:"INFINITE_LOOP"}],cn=[{name:"name",placeholder:"\u53D8\u91CF\u540D",label:"\u53D8\u91CF\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D"}],component:He.Z,width:140},{name:"dataType",placeholder:"\u9009\u62E9\u7C7B\u578B",label:"\u53D8\u91CF\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D8\u91CF\u7C7B\u578B"}],component:K.Z,width:110,options:h},{name:"description",placeholder:"\u63CF\u8FF0",label:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63CF\u8FF0"}],component:On.Z,width:0},{name:"require",placeholder:"\u53D8\u91CF\u540D",label:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D"}],component:On.Z,width:0}],pn=[{name:"name",placeholder:"\u53C2\u6570\u540D",label:"\u53C2\u6570\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D"}],component:He.Z,width:100},{name:"bindValue",placeholder:"\u8F93\u5165\u6216\u5F15\u7528\u53C2\u6570\u503C",label:"\u53C2\u6570\u503C",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u503C"}],component:An.Z,width:180},{name:"description",placeholder:"\u63CF\u8FF0",label:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63CF\u8FF0"}],component:On.Z,width:0}],Dn=[{name:"intent",placeholder:"\u8F93\u5165\u53C2\u6570\u503C",label:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u610F\u56FE\u7684\u63CF\u8FF0"}],component:He.Z,width:296}],F=[{name:"name",placeholder:"\u53C2\u6570\u540D",label:"\u53C2\u6570\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D"}],component:He.Z,width:140},{name:"paramsValue",placeholder:"\u8F93\u5165\u6216\u5F15\u7528\u53D8\u91CF\u503C",label:"\u53D8\u91CF\u503C",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u503C"}],component:An.Z,width:120}],Fe=[{icon:(0,q.jsx)(Ve.Z,{}),name:"\u8D44\u6E90\u5E93\u5DE5\u4F5C\u6D41",key:"resources"},{icon:(0,q.jsx)(Ve.Z,{}),name:"\u5B98\u65B9\u793A\u4F8B",key:"example"}],le=[{label:"\u7B49\u4E8E",value:"EQUAL",displayValue:"="},{label:"\u4E0D\u7B49\u4E8E",value:"NOT_EQUAL",displayValue:"\u2260"},{label:"\u5927\u4E8E",value:"GREATER_THAN",displayValue:">"},{label:"\u5927\u4E8E\u7B49\u4E8E",value:"GREATER_THAN_OR_EQUAL",displayValue:"\u2265"},{label:"\u5C0F\u4E8E",value:"LESS_THAN",displayValue:"<"},{label:"\u5C0F\u4E8E\u7B49\u4E8E",value:"LESS_THAN_OR_EQUAL",displayValue:"\u2264"},{label:"\u957F\u5EA6\u5927\u4E8E",value:"LENGTH_GREATER_THAN",displayValue:">"},{label:"\u957F\u5EA6\u5927\u4E8E\u7B49\u4E8E",value:"LENGTH_GREATER_THAN_OR_EQUAL",displayValue:"\u2265"},{label:"\u957F\u5EA6\u5C0F\u4E8E",value:"LENGTH_LESS_THAN",displayValue:"<"},{label:"\u957F\u5EA6\u5C0F\u4E8E\u7B49\u4E8E",value:"LENGTH_LESS_THAN_OR_EQUAL",displayValue:"\u2264"},{label:"\u5305\u542B",value:"CONTAINS",displayValue:"\u2283"},{label:"\u4E0D\u5305\u542B",value:"NOT_CONTAINS",displayValue:"\u2285"},{label:"\u5339\u914D\u6B63\u5219\u8868\u8FBE\u5F0F",value:"MATCH_REGEX",displayValue:"~"},{label:"\u4E3A\u7A7A",value:"IS_NULL",displayValue:"\u2205"},{label:"\u4E0D\u4E3A\u7A7A",value:"NOT_NULL",displayValue:"!\u2205"}],Re=[{label:"\u7B49\u4E8E",value:"EQUAL",displayValue:"="},{label:"\u4E0D\u7B49\u4E8E",value:"NOT_EQUAL",displayValue:"\u2260"},{label:"\u5927\u4E8E",value:"GREATER_THAN",displayValue:">"},{label:"\u5927\u4E8E\u7B49\u4E8E",value:"GREATER_THAN_OR_EQUAL",displayValue:"\u2265"},{label:"\u5C0F\u4E8E",value:"LESS_THAN",displayValue:"<"},{label:"\u5C0F\u4E8E\u7B49\u4E8E",value:"LESS_THAN_OR_EQUAL",displayValue:"\u2264"},{label:"\u5C5E\u4E8E",value:"IN",displayValue:"\u2283"},{label:"\u4E0D\u5C5E\u4E8E",value:"NOT_IN",displayValue:"\u2285"},{label:"\u4E3A\u7A7A",value:"IS_NULL",displayValue:"\u2205"},{label:"\u4E0D\u4E3A\u7A7A",value:"NOT_NULL",displayValue:"!\u2205"}]},15457:function(){},43562:function(){},47804:function(ot){ot.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQySURBVHgB7ZpNTFRXFMf/M8wAE8cRyaDjTAtUFIdCSGVhVy26sDY1aaVpbbuqS1vauq5tUzcVyraVbmyiC78WigvxI5IQFd3NoCKJX3w4oAMy4wAShq9hvOcak1GeH7zz4MXc90te4F3eXM77v/vOOfecsUWj0SEojEMcXiiMHYpjCQDFsQSA4lgCQHEsAaA4lgBQHEsAKI4lABTHgQVkcnISsVgMg4OD6L9/X/x8iMSjBEYfj2JsbAzJ5IS8zuXKhXvJEniWebB8eT58K1ciEAjA5/NhxYoCOBwLZ6bhMycSCVy4eAnhUBidnZ2429UlhdCDy+VCSUkJSkvX4sMNG7Bp00Z4PB4YiU2UxNIwgKmpKfy1tw4tLS2Ixx9hIXC73aip2Yaff6o1TAhDBLgXiWDnzh/R09ODxYBWxX+N/6KwsBBc2AIkk0nUfPkVent7sZjQa3HwwAHhM/LAgR0F9u//f9Fvnrh9+w6aTp4EF9YKmJlJ4aOPq6XjM4O8vDxcuXwJdrv+58haAV1dd027eWJ4eFjY0A0OLAHC7VdhNm1tbeDAEiAUCsFsOm7cAAeWABER/symv78fHHQLkJqdxdBQDGYTi8UxK2zRi24BJicmZA5gNmTD+Pg49KJbgOnpaREGZ176d5vNhtzcXHB53RyUgr/KjtehW4CZVEqKoEVFRQXOnT2Dq+0hNDUdR1FREeZLcXExmk4cl3Ocbj6FqqoqzetSwg5TBEiL946eshYNf9eLPP1d+XtZMIhdu36ZV7JC8+7e/SvKyoLyfPXq9+S5ph1p3lZGtwBZWVnimPvxnJwcaXAmwXWlcs//ptA2+B1RD8ikovx9OJ1ObTsY9QLdApAxDocTi4nWKiI7nGYIQE/aCCfHJTs7m2UHawXQZuRFyCtHowPPjcXjcRGq3jxkknMVm7Tnxvr6+jQrS16vl1UyY2WCfr9/zhg5pb11dRgZGZHnAwODqKtvmJezIgH2NTbKzxKJxDB++/0PzWsD/lXgwKoJrhNFidbW1jnj58+34Nq16yL8FYoqUa8sjM6XcLgdX2/fLsMhCUErQIvKykpwYNUD6Ca/+fY7mMmRw4ewfv0H0AvrFSgXoclMR0iO+FmuoBeWAOR8tm79DGaxsbqa/QDYNcEdO743ZRXQ/6yt/QFc2AKsXbMGe/b8aXjD4lXQymtoqBeV4VJwMaQ3uO2Lz9G47x+xCSp/6f7ACGhu8jvHjh7BJ5s3wwgM6wwRVJjo6OhAc/Np3Lx1C93dPbpCYCbUDQqKDRV5+k+3bJFOj1MFfhFDBciExKBkKBLpk43RB+JIiCoutc1Gxfhj0RxNp59Wcuw2O9xLl4rMcpnMLgu8BfCtEg1Sf0A0Sf3Iz8839KYzWTAB3hasL0hAcSwBoDiWAFAcSwAojiUAFMcSAIpjCQDFsb4tLo4xKMwTd3B2uVYQghwAAAAASUVORK5CYII="}}]);})();
