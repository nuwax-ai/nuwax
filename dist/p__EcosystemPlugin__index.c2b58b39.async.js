"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[7696],{16201:function(ka,X,u){u.r(X),u.d(X,{default:function(){return Ke}});var ye=u(15558),q=u.n(ye),Ce=u(26068),T=u.n(Ce),be=u(90228),c=u.n(be),Te=u(87999),D=u.n(Te),De=u(48305),v=u.n(De),Pe=u(26760),Ee=u(90634),Ae=u(77395),Ne=u(38697),m=u(79337),y=u(78913),L=u(64799),f=u(46),Le=u(63619),je=u(46219),ke=u(7010),we=u(73981),$e=u(17701),Re=u(9504),Ie=u(70183),He=u(94581),Ze=u.n(He),h=u(75271),b={"xagi-nav-style2":"xagi-nav-style2___VkDKq",text:"text___L1ULz","page-container":"page-container___WLDiS",container:"container___tnDVH",header:"header___dDn36",searchInput:"searchInput___cgdZK",pluginList:"pluginList___JxOh1","list-section":"list-section___k1SHt",title:"title___tWZUT",segmented:"segmented___DuKKA",select:"select___olaJQ",headerRight:"headerRight___u2mgm"},Je=u(1586),Me=u(95967),Fe=u(3055),ze=u(61265),Ve=u(16621),i=u(52676),g=Ze().bind(b),Be=Le.Z.Search,w=24,Ue=ze.Ne.filter(function(A){return[L.qR.Plugin].includes(A.key)}),Ge=(m.l$===null||m.l$===void 0?void 0:m.l$.map(function(A){return{label:A.label,value:A.key}}))||[];function Ke(){var A,V,B,Oe=je.Z.useApp(),p=Oe.message,Qe=(0,h.useState)(""),x=v()(Qe,2),U=x[0],_=x[1],We=(0,h.useState)(m.eH.ALL),ee=v()(We,2),P=ee[0],Ye=ee[1],Xe=(0,h.useState)(!1),ae=v()(Xe,2),qe=ae[0],$=ae[1],xe=(0,h.useState)(null),re=v()(xe,2),N=re[0],ne=re[1],_e=(0,h.useState)(!1),se=v()(_e,2),ea=se[0],R=se[1],aa=(0,h.useState)(!1),te=v()(aa,2),G=te[0],ue=te[1],ra=(0,h.useState)(null),le=v()(ra,2),I=le[0],H=le[1],na=(0,h.useState)(!1),ie=v()(na,2),K=ie[0],Z=ie[1],sa=(0,h.useState)({size:10,records:[],total:0,current:1,pages:0}),de=v()(sa,2),C=de[0],J=de[1],ta=(0,h.useState)({current:1,pageSize:w}),oe=v()(ta,2),j=oe[0],ce=oe[1],ua=(0,h.useCallback)(D()(c()().mark(function s(){var e,r,t,l,a,S,o,n,O,Q,W,ge,k,Se,me,Y=arguments;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:e=Y.length>0&&Y[0]!==void 0?Y[0]:{},r=e.tabType,t=e.keyword,l=t===void 0?"":t,a=e.page,S=a===void 0?1:a,o=e.pageSize,n=o===void 0?w:o,O=e.shareStatus,Q=O===void 0?-1:O,W=e.categoryCode,ge=W===void 0?"":W,Z(!0),d.prev=2,d.t0=r,d.next=d.t0===m.eH.ALL?6:d.t0===m.eH.ENABLED?8:d.t0===m.eH.SHARED?10:12;break;case 6:return k=f.wF.ALL,d.abrupt("break",13);case 8:return k=f.wF.ENABLED,d.abrupt("break",13);case 10:return k=f.wF.MY_SHARE,d.abrupt("break",13);case 12:k=f.wF.ALL;case 13:return Se={queryFilter:{dataType:f.Th.PLUGIN,subTabType:k,name:l||void 0,shareStatus:Q===-1?void 0:Q,categoryCode:ge||void 0},current:S,pageSize:n,orders:[{column:"created",asc:!1}]},J({size:n,records:[],total:0,current:S,pages:0}),d.next=17,(0,y.k_)(Se);case 17:me=d.sent,J(me),d.next=25;break;case 21:d.prev=21,d.t1=d.catch(2),console.error("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u5931\u8D25:",d.t1),p.error("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u5931\u8D25");case 25:return d.prev=25,Z(!1),d.finish(25);case 28:case"end":return d.stop()}},s,null,[[2,21,25,28]])})),[P,U,j.current,j.pageSize]),E=function(e){ce({current:1,pageSize:w}),ua(T()({tabType:P,keyword:e?.keyword===void 0?U:e.keyword,page:1,pageSize:w},e||{}))};(0,h.useEffect)(function(){E()},[P]);var la=function(e){var r=P===m.eH.SHARED,t=P===m.eH.ALL;return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion,author:e.author||"",targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:t?e.useStatus===f.MN.ENABLED:void 0,shareStatus:r?e.shareStatus:void 0,publishDoc:e.publishDoc}},ia=function(e){return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion||!1,author:e.author||"",dataType:e.dataType,ownedFlag:e.ownedFlag,targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:e.useStatus===f.MN.ENABLED,publishDoc:e.publishDoc}},he=function(e){_(e),E({keyword:e})},da=function(){ne(null),$(!1)},oa=function(){var s=D()(c()().mark(function e(r){var t;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(N){a.next=2;break}return a.abrupt("return",!1);case 2:return t=null,a.prev=3,a.next=6,(0,y.$t)({uid:N.uid,configParamJson:JSON.stringify(r)});case 6:t=a.sent,a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(3),p.error("\u64CD\u4F5C\u5931\u8D25"),a.abrupt("return",!1);case 13:if(!t){a.next=18;break}return $(!1),p.success("\u66F4\u65B0\u6210\u529F"),E(),a.abrupt("return",!0);case 18:return p.error("\u66F4\u65B0\u5931\u8D25"),a.abrupt("return",!1);case 20:case"end":return a.stop()}},e,null,[[3,9]])}));return function(r){return s.apply(this,arguments)}}(),ca=function(){var s=D()(c()().mark(function e(){var r;return c()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(N!=null&&N.uid){l.next=2;break}return l.abrupt("return",!1);case 2:return r=null,l.prev=3,l.next=6,(0,y.m5)(N.uid);case 6:r=l.sent,l.next=13;break;case 9:return l.prev=9,l.t0=l.catch(3),p.error("\u4E0B\u7EBF\u5931\u8D25"),l.abrupt("return",!1);case 13:if(!r){l.next=18;break}return p.success("\u5DF2\u4E0B\u7EBF"),$(!1),E(),l.abrupt("return",!0);case 18:return p.error("\u4E0B\u7EBF\u5931\u8D25"),l.abrupt("return",!1);case 20:case"end":return l.stop()}},e,null,[[3,9]])}));return function(){return s.apply(this,arguments)}}(),ha=function(){ue(!1),H(null),R(!0)},pa=function(){E(),R(!1),H(null)},va=function(){var s=D()(c()().mark(function e(r,t){var l,a,S;return c()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,l={name:r.name,description:r.description,dataType:f.Th.PLUGIN,targetType:r.targetType||L.qR.Plugin,targetId:r.targetId,categoryCode:r.categoryCode,categoryName:r.categoryName,useStatus:r.useStatus||f.MN.ENABLED,author:r.author,publishDoc:r.publishDoc,configParamJson:r.configParamJson,icon:r.icon},a=null,!(G&&I!==null&&I!==void 0&&I.uid)){n.next=16;break}if(S=T()(T()({},l),{},{uid:I.uid}),!t){n.next=11;break}return n.next=8,(0,y.Cd)(S);case 8:a=n.sent,n.next=14;break;case 11:return n.next=13,(0,y.F6)(S);case 13:a=n.sent;case 14:n.next=25;break;case 16:if(!t){n.next=22;break}return n.next=19,(0,y.$Q)(l);case 19:a=n.sent,n.next=25;break;case 22:return n.next=24,(0,y.TG)(l);case 24:a=n.sent;case 25:if(!a){n.next=31;break}return p.success(G?"\u66F4\u65B0\u6210\u529F":"\u521B\u5EFA\u6210\u529F"),pa(),n.abrupt("return",!0);case 31:return p.error("\u64CD\u4F5C\u5931\u8D25"),n.abrupt("return",!1);case 33:n.next=40;break;case 35:return n.prev=35,n.t0=n.catch(0),console.error("\u4FDD\u5B58\u5206\u4EAB\u5931\u8D25:",n.t0),p.error("\u64CD\u4F5C\u5931\u8D25"),n.abrupt("return",!1);case 40:case"end":return n.stop()}},e,null,[[0,35]])}));return function(r,t){return s.apply(this,arguments)}}(),fa=function(){var s=D()(c()().mark(function e(r,t){var l,a,S=arguments;return c()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l=S.length>2&&S[2]!==void 0?S[2]:!1,Z(!0),n.prev=2,n.next=5,(0,y.k_)({queryFilter:{dataType:f.Th.PLUGIN},current:r,pageSize:t,orders:[{column:"created",asc:!1}]});case 5:a=n.sent,l&&C.records?J(T()(T()({},a),{},{records:[].concat(q()(C.records||[]),q()(a.records||[]))})):J(a),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(2),console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",n.t0),p.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25");case 13:return n.prev=13,Z(!1),n.finish(13);case 16:case"end":return n.stop()}},e,null,[[2,9,13,16]])}));return function(r,t){return s.apply(this,arguments)}}(),ga=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;K||(ce(function(t){return T()(T()({},t),{},{current:e})}),fa(e,j.pageSize,r))},Sa=function(e){E({shareStatus:e})},ma=function(e){E({categoryCode:e===""?void 0:e})},ya=(0,h.useState)(!1),pe=v()(ya,2),Ca=pe[0],M=pe[1],ba=(0,h.useState)(null),ve=v()(ba,2),Ta=ve[0],F=ve[1],Da=(0,h.useState)([]),fe=v()(Da,2),Pa=fe[0],z=fe[1],Ea=function(e){M(!1),F({icon:e.icon,name:e.name,description:e.description,targetType:e.targetType,targetId:e.targetId.toString(),shareStatus:f.yB.DRAFT}),z([{type:e.targetType,targetId:e.targetId,status:L.BQ.Added}])},Aa=function(){var s=D()(c()().mark(function e(r){var t,l,a;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(P!=="shared"){o.next=11;break}H(r),ue(!0),R(!0),M(!1),t=r.targetType,l={icon:r.icon||"",uid:r.uid,name:r.name||"",description:r.description||"",targetType:t,targetId:(r.targetId||"").toString(),author:r.author||"",publishDoc:r.publishDoc||"",shareStatus:r.shareStatus,configParamJson:r.configParamJson||""},F(l),z([{type:t,targetId:Number(l.targetId)||0,status:L.BQ.Added}]),o.next=22;break;case 11:if(!r.uid){o.next=22;break}return o.prev=12,o.next=15,(0,y.Ry)(r.uid);case 15:a=o.sent,a&&(ne(a),$(!0)),o.next=22;break;case 19:o.prev=19,o.t0=o.catch(12),p.error("\u83B7\u53D6\u63D2\u4EF6\u8BE6\u60C5\u5931\u8D25");case 22:case"end":return o.stop()}},e,null,[[12,19]])}));return function(r){return s.apply(this,arguments)}}(),Na=function(){var s=D()(c()().mark(function e(r){var t;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=null,a.prev=1,a.next=4,(0,y.n)(r);case 4:t=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(!t){a.next=14;break}return p.success("\u63D2\u4EF6\u5DF2\u4E0B\u7EBF"),E(),a.abrupt("return",!0);case 14:return a.abrupt("return",!1);case 15:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return s.apply(this,arguments)}}(),La=function(){var s=D()(c()().mark(function e(r){var t;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=null,a.prev=1,a.next=4,(0,y.LI)(r);case 4:t=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(console.log("result",t),!t){a.next=15;break}return p.success("\u63D2\u4EF6\u5DF2\u64A4\u9500\u53D1\u5E03"),E(),a.abrupt("return",!0);case 15:return a.abrupt("return",!1);case 16:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return s.apply(this,arguments)}}(),ja=function(){R(!1),H(null),F(null),z([])};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:g(b.container,"flex","flex-col","h-full","overflow-hide"),children:[(0,i.jsxs)("div",{className:g(b.header),children:[(0,i.jsxs)(ke.Z,{children:[(0,i.jsx)("h3",{className:g(b.title),children:"\u63D2\u4EF6"}),(0,i.jsx)(we.Z,{className:g(b.segmented),options:Ge,value:P,onChange:function(e){return Ye(e)}}),P===m.eH.SHARED?(0,i.jsx)($e.default,{options:[{label:"\u5168\u90E8\u5206\u7C7B",value:-1},{label:"\u5DF2\u53D1\u5E03",value:3},{label:"\u5BA1\u6838\u4E2D",value:2},{label:"\u5DF2\u4E0B\u7EBF",value:4}],defaultValue:-1,onChange:function(e){return Sa(e)},className:g(b.select)}):(0,i.jsx)(Ee.Z,{targetType:L.qR.Plugin,onChange:function(e){return ma(e)}})]}),(0,i.jsxs)("div",{className:g(b.headerRight),children:[(0,i.jsx)(Be,{className:g(b.searchInput),placeholder:"\u641C\u7D22\u63D2\u4EF6",value:U,onChange:function(e){return _(e.target.value)},onSearch:he,onClear:function(){return he("")},allowClear:!0}),P===m.eH.SHARED&&(0,i.jsx)(Re.ZP,{type:"primary",onClick:ha,icon:(0,i.jsx)(Ve.Z,{}),children:"\u521B\u5EFA\u5206\u4EAB"})]})]}),(0,i.jsx)("div",{className:g(b.pluginList,"flex-1","scroll-container-hide"),onScroll:function(e){var r=e.currentTarget,t=r.scrollTop,l=r.scrollHeight,a=r.clientHeight;l-t-a<100&&!K&&j.current<(C.pages||0)&&ga(j.current+1,!0)},children:K&&(C==null||(A=C.records)===null||A===void 0?void 0:A.length)===0?(0,i.jsx)(Fe.Z,{className:g("h-full")}):C!=null&&(V=C.records)!==null&&V!==void 0&&V.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:g(b["list-section"]),children:(B=C.records)===null||B===void 0?void 0:B.map(function(s){return(0,i.jsx)(Je.Z,T()(T()({},la(s)),{},{onClick:D()(c()().mark(function e(){return c()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Aa(s);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},e)}))}),s?.uid)})}),!(j.current<(C.pages||0))&&(0,i.jsx)(Me.Z,{})]}):(0,i.jsx)("div",{className:g("flex","h-full","items-center","content-center"),children:(0,i.jsx)(Ie.Z,{className:g("flex","flex-col","items-center","content-center"),description:"\u6682\u65E0\u6570\u636E"})})})]}),(0,i.jsx)(Pe.Z,{visible:qe,data:N?ia(N):void 0,onClose:da,onUpdateAndEnable:oa,onDisable:ca}),(0,i.jsx)(Ae.Z,{type:f.Th.PLUGIN,targetType:L.qR.Plugin,visible:ea,isEdit:G,onClose:ja,onOffline:Na,onWithdraw:La,onSave:va,data:Ta,onAddComponent:function(){M(!0)},onRemoveComponent:function(){F(null),z([])}}),(0,i.jsx)(Ne.Z,{checkTag:L.qR.Plugin,onAdded:Ea,open:Ca,onCancel:function(){return M(!1)},tabs:Ue,addComponents:Pa})]})}}}]);})();
