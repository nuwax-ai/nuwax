"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[7311],{10104:function(gn,K,n){n.r(K),n.d(K,{default:function(){return Ve}});var de=n(90228),h=n.n(de),ce=n(26068),U=n.n(ce),pe=n(87999),E=n.n(pe),ve=n(48305),he=n.n(ve),fe=n(30704),g=n(6377),ge=n(51802),L=n(61304),me=n(2660),Ce=n(56716),xe=n(27791),Y=n(73415),O=n(87620),ye=n(53501),J=n(48512),X=n(24643),z=n(64799),p=n(92122),A=n(44953),$=n(40677),Fe=n(26324),Q=n(86743),C=n(28190),x=n(63619),W=n(28246),w=n(17701),R=n(43898),je=n(68108),q=n(7010),Ee=n(51430),_=n(10580),Z=n(9504),Ie=n(94581),ee=n.n(Ie),ne=n(75271),b=n(56179),v={"xagi-nav-style2":"xagi-nav-style2___yMpiL",text:"text___db3EP","page-container":"page-container___Tga9u",container:"container___IEl0t","main-container":"main-container___sMpOU",title:"title___ODWN6","request-select":"request-select___M1IeR","table-wrap":"table-wrap___ty9xJ","mb-24":"mb-24___UJXHH",select:"select___yVYzb"},Te=n(26145),Ae=n(45019),Ze=n(86230),be=n(61606),Pe=n(23299),Be=n(66118),De=n(7036),Ne=n(73813),Oe=n(12758),Re=n(16483),ae=n.n(Re),d={"xagi-nav-style2":"xagi-nav-style2___Pns8X",text:"text___efngY","page-container":"page-container___qBf68",header:"header___fCRSy","icon-back":"icon-back___t7VtQ",logo:"logo___PI8Y9",section:"section___c_GEv","top-box":"top-box___M54E6",name:"name___VB2L3",circle:"circle___XOm84","bottom-box":"bottom-box___OPqdd",box:"box___NiV4x","update-time":"update-time___r2_WM",history:"history___cyNGM","try-btn":"try-btn___k7NAI"},e=n(52676),c=ee().bind(d),Se=function(m){var l=m.pluginInfo,S=m.onEdit,M=m.onToggleHistory,I=m.onSave,i=m.onTryRun,k=m.onPublish,P=(0,b.useParams)(),V=P.spaceId,B=(0,ne.useMemo)(function(){if(l){var y;return!(l!=null&&(y=l.permissions)!==null&&y!==void 0&&y.includes(p.jE.Publish))}else return!1},[l]);return(0,e.jsxs)("header",{className:c("flex","items-center","w-full",d.header),children:[(0,e.jsx)(be.Z,{className:c(d["icon-back"],"cursor-pointer"),onClick:function(){return(0,Ze.bC)("/space/".concat(V,"/library"))}}),(0,e.jsx)("img",{className:c(d.logo),src:l?.icon||Te,alt:""}),(0,e.jsxs)("section",{className:c("flex-1","flex","flex-col","content-between",d.section),children:[(0,e.jsxs)("div",{className:c("flex","w-full",d["top-box"]),children:[(0,e.jsx)("h3",{className:c(d.name,"text-ellipsis"),children:l?.name}),(0,e.jsx)(Pe.Z,{className:c("cursor-pointer","hover-box"),onClick:S}),l?.publishStatus===p.xH.Published&&(0,e.jsx)(Be.Z,{className:c(d.circle)}),l?.publishDate!==null&&ae()(l?.publishDate).isBefore(l?.modified)&&(0,e.jsx)(Oe.Z,{bordered:!1,color:"volcano",style:{marginLeft:"6px"},children:"\u6709\u66F4\u65B0\u672A\u53D1\u5E03"})]}),(0,e.jsxs)("div",{className:c(d["bottom-box"],"flex","items-center"),children:[(0,e.jsx)("span",{className:c(d.box),children:l?.type===Ae.AQ.HTTP?"http":"\u4EE3\u7801"}),(0,e.jsx)("span",{className:c(d.box),children:l?.publishStatus===p.xH.Published?"\u5DF2\u53D1\u5E03":"\u672A\u53D1\u5E03"}),(0,e.jsxs)("span",{className:c(d["update-time"]),children:["\u914D\u7F6E\u4FDD\u5B58\u4E8E",ae()(l?.modified).format("HH:mm")]})]})]}),(0,e.jsx)(De.Z,{className:c(d.history,"cursor-pointer"),onClick:M}),(0,e.jsx)(Z.ZP,{className:c(d["try-btn"]),type:"primary",onClick:I,children:"\u4FDD\u5B58"}),(0,e.jsx)(Z.ZP,{className:c(d["try-btn"]),type:"primary",icon:(0,e.jsx)(Ne.Z,{}),onClick:i,children:"\u8BD5\u8FD0\u884C"}),(0,e.jsx)(Z.ZP,{type:"primary",onClick:k,disabled:B,children:"\u53D1\u5E03"})]})},Me=Se,f=ee().bind(v),ke=function(){var m=(0,b.useParams)(),l=Number(m.spaceId),S=C.Z.useForm(),M=he()(S,1),I=M[0],i=(0,ye.Z)(),k=i.isModalOpen,P=i.setIsModalOpen,V=i.autoAnalysisOpen,B=i.setAutoAnalysisOpen,y=i.visible,ue=i.setVisible,Ge=i.openModal,te=i.setOpenModal,F=i.pluginId,r=i.pluginInfo,Ke=i.setPluginInfo,Ue=i.openPlugin,le=i.setOpenPlugin,T=i.inputConfigArgs,Le=i.setInputConfigArgs,ie=i.outputConfigArgs,H=i.expandedRowKeys,Ye=i.setExpandedRowKeys,Je=i.outputExpandedRowKeys,j=i.handleInputValue,D=i.handleOutputValue,Xe=i.handleInputAddChild,ze=i.handleOutputAddChild,$e=i.handleInputDel,Qe=i.handleOutputDel,We=i.handleConfirmUpdate,we=i.handleInputConfigAdd,qe=i.handleOutputConfigAdd,oe=i.handleOutputConfigArgs,_e=i.handleConfirmPublishPlugin,en=i.handleUpdateSuccess,nn=i.isClickSaveBtnRef,an=(0,b.useRequest)(X.dB,{manual:!0,debounceInterval:300,onSuccess:function(u){if(Ke(u),u.config){var a=u.config,t=a.method,s=a.url,G=a.contentType,vn=a.timeout,se=a.inputArgs,hn=a.outputArgs;I.setFieldsValue({method:t||p.LM.GET,url:s,contentType:G||p.lT.OTHER,timeout:vn||10});var fn=(0,$.kS)(se);Ye(fn),Le(se),oe(hn)}}}),un=an.run,tn=(0,b.useRequest)(X.i,{manual:!0,debounceInterval:300,onSuccess:function(){en()}}),ln=tn.run;(0,ne.useEffect)(function(){un(F)},[F]);var re=function(u){return u[u.length-1]},on=[{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u540D\u79F0"}),dataIndex:"name",key:"name",className:"flex items-center",render:function(u,a){return(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0\uFF0C\u786E\u4FDD\u542B\u4E49\u6E05\u6670",value:u,onChange:function(s){return j(a.key,"name",s.target.value)}})}},{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u63CF\u8FF0"}),dataIndex:"description",key:"description",render:function(u,a){return(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u63CF\u8FF0\uFF0C\u786E\u4FDD\u63CF\u8FF0\u8BE6\u7EC6\u4FBF\u4E8E\u5927\u6A21\u578B\u66F4\u597D\u7684\u7406\u89E3",value:u,onChange:function(s){return j(a.key,"description",s.target.value)}})}},{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u7C7B\u578B"}),dataIndex:"dataType",key:"dataType",width:120,render:function(u,a){return(0,e.jsx)(W.Z,{rootClassName:v.select,allowClear:!1,options:J.DJ,expandTrigger:"hover",displayRender:re,defaultValue:(0,A.n3)(u),onChange:function(s){j(a.key,"dataType",(0,A.$g)(s))},placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B"})}},{title:(0,e.jsx)(g.Z,{label:"\u4F20\u5165\u65B9\u5F0F"}),dataIndex:"inputType",key:"inputType",width:120,render:function(u,a){return(0,$.YY)(T,a.key,1)===1&&(0,e.jsx)(w.default,{rootClassName:v.select,options:O.R0,value:u,onChange:function(s){return j(a.key,"inputType",s)}})}},{title:"\u662F\u5426\u5FC5\u987B",dataIndex:"require",key:"require",width:100,align:"center",render:function(u,a){return(0,e.jsx)(R.Z,{checked:u,onChange:function(s){return j(a.key,"require",s.target.checked)}})}},{title:"\u9ED8\u8BA4\u503C",dataIndex:"bindValue",key:"bindValue",width:150,render:function(u,a){var t;return(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u503C",disabled:p.Gi.Object===a.dataType||p.Gi.Array_Object===a.dataType||((t=a.dataType)===null||t===void 0?void 0:t.includes("Array"))||!a.enable,value:u,onChange:function(G){return j(a.key,"bindValue",G.target.value)}})}},{title:"\u5F00\u542F",dataIndex:"enable",key:"enable",width:70,align:"center",render:function(u,a){return(0,e.jsx)(je.Z,{title:a.require&&!a.bindValue&&"\u6B64\u53C2\u6570\u662F\u5FC5\u586B\u53C2\u6570\uFF0C\u586B\u5199\u9ED8\u8BA4\u503C\u540E\uFF0C\u6B64\u5F00\u5173\u53EF\u7528",children:(0,e.jsx)(R.Z,{disabled:a.require&&!a.bindValue,checked:u,onChange:function(s){return j(a.key,"enable",s.target.checked)}})})}},{title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:function(u,a){return(0,e.jsxs)(q.Z,{size:"middle",children:[(p.Gi.Object===a.dataType||p.Gi.Array_Object===a.dataType)&&(0,e.jsx)(Y.Me,{className:f("cursor-pointer"),onClick:function(){return Xe(a.key)}}),(0,e.jsx)(Q.Z,{onClick:function(){return $e(a.key)}})]})}}],rn=[{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u540D\u79F0"}),dataIndex:"name",key:"name",width:430,className:"flex items-center",render:function(u,a){return(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0\uFF0C\u786E\u4FDD\u542B\u4E49\u6E05\u6670",value:u,onChange:function(s){return D(a.key,"name",s.target.value)}})}},{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u63CF\u8FF0"}),dataIndex:"description",key:"description",render:function(u,a){return(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u63CF\u8FF0\uFF0C\u786E\u4FDD\u63CF\u8FF0\u8BE6\u7EC6\u4FBF\u4E8E\u5927\u6A21\u578B\u66F4\u597D\u7684\u7406\u89E3",onChange:function(s){return D(a.key,"description",s.target.value)},value:u})}},{title:(0,e.jsx)(g.Z,{label:"\u53C2\u6570\u7C7B\u578B"}),dataIndex:"dataType",key:"dataType",width:120,render:function(u,a){return(0,e.jsx)(W.Z,{allowClear:!1,rootClassName:v.select,options:J.DJ,expandTrigger:"hover",displayRender:re,defaultValue:(0,A.n3)(u),onChange:function(s){D(a.key,"dataType",(0,A.$g)(s))},placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7C7B\u578B"})}},{title:"\u5F00\u542F",dataIndex:"enable",key:"enable",width:70,align:"center",render:function(u,a){return(0,e.jsx)(R.Z,{checked:u,onChange:function(s){return D(a.key,"enable",s.target.checked)}})}},{title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:function(u,a){return(0,e.jsxs)(q.Z,{size:"middle",children:[(p.Gi.Object===a.dataType||p.Gi.Array_Object===a.dataType)&&(0,e.jsx)(Y.Me,{className:f("cursor-pointer"),onClick:function(){return ze(a.key)}}),(0,e.jsx)(Q.Z,{onClick:function(){return Qe(a.key)}})]})}}],N=function(){var o=E()(h()().mark(function u(){var a;return h()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,I.validateFields();case 2:a=s.sent,ln({id:F,config:U()(U()({},a),{},{inputArgs:T,outputArgs:ie})});case 4:case"end":return s.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),sn=function(){var o=E()(h()().mark(function u(){return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return nn.current=!0,t.next=3,N();case 3:case"end":return t.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),dn=function(){var o=E()(h()().mark(function u(){return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:P(!0);case 3:case"end":return t.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),cn=function(){var o=E()(h()().mark(function u(){return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:te(!0);case 3:case"end":return t.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),pn=function(){var o=E()(h()().mark(function u(){return h()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:B(!0);case 3:case"end":return t.stop()}},u)}));return function(){return o.apply(this,arguments)}}();return(0,e.jsxs)("div",{className:f("flex","h-full"),children:[(0,e.jsxs)("div",{className:f(v.container,"flex","flex-col","flex-1","h-full"),children:[(0,e.jsx)(Me,{pluginInfo:r,onEdit:function(){return le(!0)},onToggleHistory:function(){return ue(!y)},onSave:sn,onTryRun:dn,onPublish:cn}),(0,e.jsxs)("div",{className:f(v["main-container"],"overflow-y"),children:[(0,e.jsx)("h3",{className:f(v.title,"mb-12"),children:"\u8BF7\u6C42\u914D\u7F6E"}),(0,e.jsxs)(C.Z,{form:I,initialValues:{method:p.LM.GET,contentType:p.lT.OTHER,timeout:10},layout:"vertical",requiredMark:Fe.N,children:[(0,e.jsx)(C.Z.Item,{label:(0,e.jsx)(g.Z,{label:"\u8BF7\u6C42\u65B9\u6CD5\u4E0E\u8DEF\u5F84"}),children:(0,e.jsxs)("div",{className:f("flex"),children:[(0,e.jsx)(C.Z.Item,{name:"method",noStyle:!0,children:(0,e.jsx)(w.default,{rootClassName:f(v["request-select"]),options:O.dh,placeholder:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u65B9\u6CD5"})}),(0,e.jsx)(C.Z.Item,{name:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u8DEF\u5F84"}],noStyle:!0,children:(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u8DEF\u5F84"})})]})}),(0,e.jsx)(C.Z.Item,{name:"contentType",label:"\u8BF7\u6C42\u5185\u5BB9\u683C\u5F0F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u5185\u5BB9\u683C\u5F0F"}],children:(0,e.jsx)(Ee.ZP.Group,{options:O.Ev})}),(0,e.jsx)(C.Z.Item,{name:"timeout",label:"\u8BF7\u6C42\u8D85\u65F6\u914D\u7F6E",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D85\u65F6\u914D\u7F6E"}],children:(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u6C42\u8D85\u65F6\u914D\u7F6E\uFF0C\u4EE5\u79D2\u4E3A\u5355\u4F4D"})})]}),(0,e.jsx)(L.Z,{title:"\u5165\u53C2\u914D\u7F6E",onClick:we}),(0,e.jsx)(_.Z,{className:f(v["table-wrap"],v["mb-24"],"overflow-hide"),columns:on,dataSource:T,pagination:!1,expandable:{childrenColumnName:"subArgs",defaultExpandAllRows:!0,expandedRowKeys:H,expandIcon:function(){return null}}}),(0,e.jsx)(L.Z,{title:"\u51FA\u53C2\u914D\u7F6E",onClick:qe,extra:(0,e.jsx)(Z.ZP,{onClick:pn,children:"\u81EA\u52A8\u89E3\u6790"})}),(0,e.jsx)(_.Z,{className:f(v["table-wrap"],"overflow-hide"),columns:rn,dataSource:ie,pagination:!1,expandable:{childrenColumnName:"subArgs",defaultExpandAllRows:!0,expandedRowKeys:Je,expandIcon:function(){return null}}}),(0,e.jsx)(me.Z,{inputConfigArgs:T,inputExpandedRowKeys:H,pluginId:F,pluginName:r?.name,open:k,onCancel:function(){return P(!1)}}),(0,e.jsx)(ge.Z,{inputConfigArgs:T,inputExpandedRowKeys:H,pluginId:F,pluginName:r?.name,open:V,onCancel:function(){return B(!1)},onConfirm:oe})]})]}),(0,e.jsx)(Ce.Z,{mode:z.qR.Plugin,targetId:F,spaceId:l,category:r?.category,open:Ge,onlyShowTemplate:!1,onCancel:function(){return te(!1)},onConfirm:_e}),(0,e.jsx)(xe.Z,{targetId:F,targetName:r?.name,targetType:z.qR.Plugin,permissions:r?.permissions||[],visible:y,onClose:function(){return ue(!1)}}),(0,e.jsx)(fe.Z,{open:Ue,id:r?.id,icon:r?.icon,name:r?.name,description:r?.description,mode:p.jA.Update,onCancel:function(){return le(!1)},onConfirm:We})]})},Ve=ke}}]);})();
