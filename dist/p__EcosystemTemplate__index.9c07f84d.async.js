"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[5550],{68868:function(Za,_,n){n.r(_),n.d(_,{default:function(){return Ue}});var Pe=n(19632),ee=n.n(Pe),Le=n(97857),T=n.n(Le),ke=n(15009),g=n.n(ke),Ne=n(99289),N=n.n(Ne),we=n(5574),f=n.n(we),Re=n(70787),je=n(96947),Me=n(78927),He=n(33265),$e=n(70852),Fe=n(28365),ae=n(13969),y=n(59170),b=n(9297),A=n(91120),p=n(30928),Ie=n(80882),Ze=n(25278),ze=n(3914),re=n(34041),Be=n(50136),Je=n(85804),Ve=n(80688),We=n(32983),Ke=n(94184),Oe=n.n(Ke),h=n(67294),C={container:"container___KApVK",header:"header___b_sUz",tabs:"tabs___ipXPe",searchInput:"searchInput___laR_L",pluginList:"pluginList___A1zUu","list-section":"list-section___yhNEd",title:"title___vjScq",createShareButton:"createShareButton___txQtl",headerRight:"headerRight___ojI87",select:"select___qinf1"},i=n(85893),S=Oe().bind(C),te=Ze.Z.Search,w=24;function Ue(){var K,O,U,Ge=ze.Z.useApp(),v=Ge.message,Qe=(0,h.useState)(""),ne=f()(Qe,2),R=ne[0],G=ne[1],Ye=(0,h.useState)(y.eH.ALL),se=f()(Ye,2),P=se[0],Xe=se[1],qe=(0,h.useState)(!1),ue=f()(qe,2),xe=ue[0],H=ue[1],_e=(0,h.useState)(null),le=f()(_e,2),L=le[0],ie=le[1],ea=(0,h.useState)(!1),de=f()(ea,2),aa=de[0],$=de[1],ra=(0,h.useState)(!1),oe=f()(ra,2),Q=oe[0],ce=oe[1],ta=(0,h.useState)(null),he=f()(ta,2),F=he[0],I=he[1],k=(0,h.useRef)(""),na=(0,h.useState)({checkTag:A.qR.Workflow,tabs:ae.Ne.filter(function(t){return[A.qR.Workflow].includes(t.key)})}),pe=f()(na,2),sa=pe[0],ua=pe[1],la=(0,h.useState)({targetType:A.qR.Workflow,type:p.Th.TEMPLATE}),fe=f()(la,2),ia=fe[0],ve=fe[1],da=(0,h.useState)(!1),ge=f()(da,2),Y=ge[0],Z=ge[1],oa=(0,h.useState)({size:w,records:[],total:0,current:1,pages:0}),Se=f()(oa,2),E=Se[0],z=Se[1],ca=(0,h.useState)({current:1,pageSize:w}),me=f()(ca,2),j=me[0],ye=me[1],ha=(0,h.useCallback)(N()(g()().mark(function t(){var e,a,l,s,r,m,d,u,o,X,q,Ae,M,Ee,De,x=arguments;return g()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=x.length>0&&x[0]!==void 0?x[0]:{},a=e.tabType,l=e.keyword,s=l===void 0?"":l,r=e.page,m=r===void 0?1:r,d=e.pageSize,u=d===void 0?w:d,o=e.shareStatus,X=o===void 0?-1:o,q=e.categoryCode,Ae=q===void 0?"":q,Z(!0),c.prev=2,c.t0=a,c.next=c.t0===y.eH.ALL?6:c.t0===y.eH.ENABLED?8:c.t0===y.eH.SHARED?10:12;break;case 6:return M=p.wF.ALL,c.abrupt("break",13);case 8:return M=p.wF.ENABLED,c.abrupt("break",13);case 10:return M=p.wF.MY_SHARE,c.abrupt("break",13);case 12:M=p.wF.ALL;case 13:return Ee={queryFilter:{dataType:p.Th.TEMPLATE,subTabType:M,targetType:k.current===""?void 0:k.current,name:s||void 0,shareStatus:X===-1?void 0:X,categoryCode:Ae||void 0},current:m,pageSize:u,orders:[{column:"created",asc:!1}]},z({size:u,records:[],total:0,current:m,pages:0}),c.next=17,(0,b.k_)(Ee);case 17:De=c.sent,z(De),c.next=25;break;case 21:c.prev=21,c.t1=c.catch(2),console.error("\u83B7\u53D6\u6A21\u677F\u5217\u8868\u5931\u8D25:",c.t1),v.error("\u83B7\u53D6\u6A21\u677F\u5217\u8868\u5931\u8D25");case 25:return c.prev=25,Z(!1),c.finish(25);case 28:case"end":return c.stop()}},t,null,[[2,21,25,28]])})),[P,R,j.current,j.pageSize]),D=function(e){ye({current:1,pageSize:w}),ha(T()({tabType:P,keyword:e?.keyword===void 0?R:e.keyword,page:1,pageSize:w},e||{}))};(0,h.useEffect)(function(){k.current="",D()},[]),(0,h.useEffect)(function(){D()},[P]);var pa=function(e){var a=P===y.eH.ALL,l=P===y.eH.SHARED;return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion,author:e.author||"",targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:a?e.useStatus===p.MN.ENABLED:void 0,shareStatus:l?e.shareStatus:void 0,publishDoc:e.publishDoc}},fa=function(e){return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion||!1,author:e.author||"",targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:e.useStatus===p.MN.ENABLED,publishDoc:e.publishDoc,ownedFlag:e.ownedFlag}},B=function(e){G(e),D({keyword:e})},va=function(){ie(null),H(!1)},ga=function(){var t=N()(g()().mark(function e(a){var l;return g()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(L){r.next=2;break}return r.abrupt("return",!1);case 2:return l=null,r.prev=3,r.next=6,(0,b.$t)({uid:L.uid,configParamJson:JSON.stringify(a)});case 6:l=r.sent,r.next=13;break;case 9:return r.prev=9,r.t0=r.catch(3),v.error("\u66F4\u65B0\u5931\u8D25"),r.abrupt("return",!1);case 13:if(!l){r.next=18;break}return H(!1),v.success("\u66F4\u65B0\u6210\u529F"),D(),r.abrupt("return",!0);case 18:return v.error("\u66F4\u65B0\u5931\u8D25"),r.abrupt("return",!1);case 20:case"end":return r.stop()}},e,null,[[3,9]])}));return function(a){return t.apply(this,arguments)}}(),Sa=function(){var t=N()(g()().mark(function e(){var a;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(L!=null&&L.uid){s.next=2;break}return s.abrupt("return",!1);case 2:return a=null,s.prev=3,s.next=6,(0,b.m5)(L.uid);case 6:a=s.sent,s.next=13;break;case 9:return s.prev=9,s.t0=s.catch(3),v.error("\u4E0B\u7EBF\u5931\u8D25"),s.abrupt("return",!1);case 13:if(!a){s.next=18;break}return v.success("\u5DF2\u4E0B\u7EBF"),H(!1),D(),s.abrupt("return",!0);case 18:return v.error("\u4E0B\u7EBF\u5931\u8D25"),s.abrupt("return",!1);case 20:case"end":return s.stop()}},e,null,[[3,9]])}));return function(){return t.apply(this,arguments)}}(),ma=function(e){ua({checkTag:e,tabs:ae.Ne.filter(function(a){return[e].includes(a.key)})}),ve({targetType:e,type:p.Th.TEMPLATE}),ce(!1),I(null),$(!0)},ya=function(){D(),$(!1),I(null)},Ca=function(){var t=N()(g()().mark(function e(a,l){var s,r,m;return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,s={name:a.name,description:a.description,dataType:p.Th.TEMPLATE,targetType:a.targetType||A.qR.Workflow,targetId:a.targetId,categoryCode:a.categoryCode,categoryName:a.categoryName,useStatus:a.useStatus||p.MN.ENABLED,author:a.author,publishDoc:a.publishDoc,configParamJson:a.configParamJson,icon:a.icon},r=null,!(Q&&F!==null&&F!==void 0&&F.uid)){u.next=16;break}if(m=T()(T()({},s),{},{uid:F.uid}),!l){u.next=11;break}return u.next=8,(0,b.Cd)(m);case 8:r=u.sent,u.next=14;break;case 11:return u.next=13,(0,b.F6)(m);case 13:r=u.sent;case 14:u.next=25;break;case 16:if(!l){u.next=22;break}return u.next=19,(0,b.$Q)(s);case 19:r=u.sent,u.next=25;break;case 22:return u.next=24,(0,b.TG)(s);case 24:r=u.sent;case 25:if(!r){u.next=31;break}return v.success(Q?"\u66F4\u65B0\u6210\u529F":"\u521B\u5EFA\u6210\u529F"),ya(),u.abrupt("return",!0);case 31:return v.error("\u64CD\u4F5C\u5931\u8D25"),u.abrupt("return",!1);case 33:u.next=40;break;case 35:return u.prev=35,u.t0=u.catch(0),console.error("\u4FDD\u5B58\u5206\u4EAB\u5931\u8D25:",u.t0),v.error("\u64CD\u4F5C\u5931\u8D25"),u.abrupt("return",!1);case 40:case"end":return u.stop()}},e,null,[[0,35]])}));return function(a,l){return t.apply(this,arguments)}}(),Ta=function(){var t=N()(g()().mark(function e(a,l){var s,r,m,d=arguments;return g()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:s=d.length>2&&d[2]!==void 0?d[2]:!1,Z(!0),o.prev=2,o.t0=P,o.next=o.t0===y.eH.ALL?6:o.t0===y.eH.ENABLED?8:o.t0===y.eH.SHARED?10:12;break;case 6:return r=p.wF.ALL,o.abrupt("break",13);case 8:return r=p.wF.ENABLED,o.abrupt("break",13);case 10:return r=p.wF.MY_SHARE,o.abrupt("break",13);case 12:r=p.wF.ALL;case 13:return o.next=15,(0,b.k_)({queryFilter:{dataType:p.Th.TEMPLATE,subTabType:r,targetType:k.current===""?void 0:k.current,name:R||void 0},current:a,pageSize:l,orders:[{column:"created",asc:!1}]});case 15:m=o.sent,s&&E.records?z(T()(T()({},m),{},{records:[].concat(ee()(E.records||[]),ee()(m.records||[]))})):z(m),o.next=23;break;case 19:o.prev=19,o.t1=o.catch(2),console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",o.t1),v.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25");case 23:return o.prev=23,Z(!1),o.finish(23);case 26:case"end":return o.stop()}},e,null,[[2,19,23,26]])}));return function(a,l){return t.apply(this,arguments)}}(),ba=function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;Y||(ye(function(l){return T()(T()({},l),{},{current:e})}),Ta(e,j.pageSize,a))},Aa={items:[{key:A.qR.Workflow,label:"\u5DE5\u4F5C\u6D41"},{key:A.qR.Agent,label:"\u667A\u80FD\u4F53"}],onClick:function(e){ma(e.key)}},Ea=(0,h.useState)(!1),Ce=f()(Ea,2),Da=Ce[0],J=Ce[1],Pa=(0,h.useState)(null),Te=f()(Pa,2),La=Te[0],V=Te[1],ka=(0,h.useState)([]),be=f()(ka,2),Na=be[0],W=be[1],wa=function(e){e.type=e.targetType,e.typeId=e.targetId,J(!1),V({icon:e.icon,name:e.name,description:e.description,targetType:e.targetType,targetId:e.targetId.toString(),shareStatus:p.yB.DRAFT}),W([{type:e.targetType,targetId:e.targetId,status:A.BQ.Added}])},Ra=function(){var t=N()(g()().mark(function e(a){var l,s,r;return g()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(P!==y.eH.SHARED){d.next=13;break}return I(a),ce(!0),$(!0),J(!1),l=a.targetType,s={icon:a.icon||"",uid:a.uid,name:a.name||"",description:a.description||"",targetType:l,targetId:(a.targetId||"").toString(),author:a.author||"",publishDoc:a.publishDoc||"",shareStatus:a.shareStatus,configParamJson:a.configParamJson||""},V(s),ve({targetType:l,type:p.Th.TEMPLATE}),W([{type:l,targetId:Number(s.targetId)||0,status:A.BQ.Added}]),d.abrupt("return",!0);case 13:if(!a.uid){d.next=27;break}return d.prev=14,d.next=17,(0,b.Ry)(a.uid);case 17:if(r=d.sent,!r){d.next=22;break}return ie(r),H(!0),d.abrupt("return",!0);case 22:d.next=27;break;case 24:d.prev=24,d.t0=d.catch(14),v.error("\u83B7\u53D6\u63D2\u4EF6\u8BE6\u60C5\u5931\u8D25");case 27:return d.abrupt("return",!1);case 28:case"end":return d.stop()}},e,null,[[14,24]])}));return function(a){return t.apply(this,arguments)}}(),ja=function(){var t=N()(g()().mark(function e(a){var l;return g()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=null,r.prev=1,r.next=4,(0,b.n)(a);case 4:l=r.sent,r.next=11;break;case 7:return r.prev=7,r.t0=r.catch(1),v.error("\u4E0B\u7EBF\u5931\u8D25"),r.abrupt("return",!1);case 11:if(!l){r.next=15;break}return v.success("\u6A21\u677F\u5DF2\u4E0B\u7EBF"),D(),r.abrupt("return",!0);case 15:return v.error("\u4E0B\u7EBF\u5931\u8D25"),r.abrupt("return",!1);case 17:case"end":return r.stop()}},e,null,[[1,7]])}));return function(a){return t.apply(this,arguments)}}(),Ma=function(){$(!1),I(null),V(null),W([])},Ha=function(e){D({shareStatus:e})},$a=function(e){D({categoryCode:e===""?void 0:e})},Fa=function(e){k.current=e,D()},Ia=function(){return P===y.eH.SHARED?(0,i.jsxs)("div",{className:S(C.headerRight),children:[(0,i.jsx)(re.Z,{options:[{label:"\u5168\u90E8",value:-1},{label:"\u5DF2\u53D1\u5E03",value:3},{label:"\u5BA1\u6838\u4E2D",value:2},{label:"\u5DF2\u4E0B\u7EBF",value:4}],defaultValue:-1,onChange:function(a){return Ha(a)},className:S(C.select)}),(0,i.jsx)(te,{className:S(C.searchInput),placeholder:"\u641C\u7D22\u6A21\u677F",value:R,onChange:function(a){return G(a.target.value)},onSearch:B,onClear:function(){return B("")},allowClear:!0}),(0,i.jsx)(Be.Z,{menu:Aa,children:(0,i.jsx)(Je.ZP,{type:"primary",icon:(0,i.jsx)(Ie.Z,{}),iconPosition:"end",children:"\u521B\u5EFA\u5206\u4EAB"})})]}):(0,i.jsxs)("div",{className:S(C.headerRight),children:[(0,i.jsx)(re.Z,{options:[{label:"\u5168\u90E8",value:""},{label:"\u667A\u80FD\u4F53",value:A.qR.Agent},{label:"\u5DE5\u4F5C\u6D41",value:A.qR.Workflow}],style:{width:100},defaultValue:"",onChange:function(a){return Fa(a)}}),k.current&&(0,i.jsx)(Me.Z,{targetType:k.current,onChange:function(a){return $a(a)}}),(0,i.jsx)(te,{className:S(C.searchInput),placeholder:"\u641C\u7D22\u6A21\u677F",value:R,onChange:function(a){return G(a.target.value)},onSearch:B,onClear:function(){return B("")},allowClear:!0})]})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:S(C.container,"flex","flex-col","h-full","overflow-hide"),children:[(0,i.jsx)("h3",{className:S(C.title),children:"\u6A21\u677F"}),(0,i.jsxs)("div",{className:S(C.header),children:[(0,i.jsx)(Ve.Z,{activeKey:P,onChange:function(e){return Xe(e)},className:S(C.tabs),items:y.l$}),Ia()]}),(0,i.jsx)("div",{className:S(C.pluginList,"flex-1","overflow-y"),onScroll:function(e){var a=e.currentTarget,l=a.scrollTop,s=a.scrollHeight,r=a.clientHeight;s-l-r<100&&!Y&&j.current<(E.pages||0)&&ba(j.current+1,!0)},children:Y&&(E==null||(K=E.records)===null||K===void 0?void 0:K.length)===0?(0,i.jsx)($e.Z,{className:S("h-full")}):E!=null&&(O=E.records)!==null&&O!==void 0&&O.length?(0,i.jsx)("div",{className:S(C["list-section"]),children:(U=E.records)===null||U===void 0?void 0:U.map(function(t){return(0,i.jsx)(Re.Z,T()(T()({},pa(t)),{},{onClick:function(){return Ra(t)}}),t?.uid)})}):(0,i.jsx)("div",{className:S("flex","h-full","items-center","content-center"),children:(0,i.jsx)(We.Z,{className:S("flex","flex-col","items-center","content-center"),description:"\u6682\u65E0\u6570\u636E"})})})]}),(0,i.jsx)(je.Z,{visible:xe,data:L?fa(L):void 0,onClose:va,onUpdateAndEnable:ga,onDisable:Sa}),(0,i.jsx)(He.Z,T()({visible:aa,isEdit:Q,onClose:Ma,onOffline:ja,onSave:Ca,data:La,onAddComponent:function(){J(!0)},onRemoveComponent:function(){V(null),W([])}},ia)),(0,i.jsx)(Fe.Z,T()({onAdded:wa,open:Da,onCancel:function(){return J(!1)},addComponents:Na},sa))]})}}}]);})();
