(()=>{(self.webpackChunknuwax_frontend=self.webpackChunknuwax_frontend||[]).push([[5064,1871],{62549:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return W}});var Ie=e(66283),A=e(75271),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 140H96c-17.7 0-32 14.3-32 32v496c0 17.7 14.3 32 32 32h380v112H304c-8.8 0-16 7.2-16 16v48c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-48c0-8.8-7.2-16-16-16H548V700h380c17.7 0 32-14.3 32-32V172c0-17.7-14.3-32-32-32zm-40 488H136V212h752v416z"}}]},name:"desktop",theme:"outlined"},Z=je,Ee=e(47221),T=function(m,oe){return A.createElement(Ee.Z,(0,Ie.Z)({},m,{ref:oe,icon:Z}))},he=A.forwardRef(T),W=he},83744:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return W}});var Ie=e(66283),A=e(75271),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"}}]},name:"file-add",theme:"outlined"},Z=je,Ee=e(47221),T=function(m,oe){return A.createElement(Ee.Z,(0,Ie.Z)({},m,{ref:oe,icon:Z}))},he=A.forwardRef(T),W=he},80998:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return W}});var Ie=e(66283),A=e(75271),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"},Z=je,Ee=e(47221),T=function(m,oe){return A.createElement(Ee.Z,(0,Ie.Z)({},m,{ref:oe,icon:Z}))},he=A.forwardRef(T),W=he},66701:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return W}});var Ie=e(66283),A=e(75271),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M705.6 124.9a8 8 0 00-11.6 7.2v64.2c0 5.5 2.9 10.6 7.5 13.6a352.2 352.2 0 0162.2 49.8c32.7 32.8 58.4 70.9 76.3 113.3a355 355 0 0127.9 138.7c0 48.1-9.4 94.8-27.9 138.7a355.92 355.92 0 01-76.3 113.3 353.06 353.06 0 01-113.2 76.4c-43.8 18.6-90.5 28-138.5 28s-94.7-9.4-138.5-28a353.06 353.06 0 01-113.2-76.4A355.92 355.92 0 01184 650.4a355 355 0 01-27.9-138.7c0-48.1 9.4-94.8 27.9-138.7 17.9-42.4 43.6-80.5 76.3-113.3 19-19 39.8-35.6 62.2-49.8 4.7-2.9 7.5-8.1 7.5-13.6V132c0-6-6.3-9.8-11.6-7.2C178.5 195.2 82 339.3 80 506.3 77.2 745.1 272.5 943.5 511.2 944c239 .5 432.8-193.3 432.8-432.4 0-169.2-97-315.7-238.4-386.7zM480 560h64c4.4 0 8-3.6 8-8V88c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8z"}}]},name:"poweroff",theme:"outlined"},Z=je,Ee=e(47221),T=function(m,oe){return A.createElement(Ee.Z,(0,Ie.Z)({},m,{ref:oe,icon:Z}))},he=A.forwardRef(T),W=he},99870:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return B}});var Ie=e(15558),A=e.n(Ie),je=e(90228),Z=e.n(je),Ee=e(26068),T=e.n(Ee),he=e(87999),W=e.n(he),Ge=e(48305),m=e.n(Ge),oe=e(81176),be=e(61993),p=e(51238),nn=e(2201),pe=e(36151),Qe=e(41249),Be=e(14719),tn=e(94581),ze=e.n(tn),gn=e(32222),dn=e.n(gn),s=e(75271),vn=e(9115),Le=e(76365),yn=e(25318),Ue=e(51866),rn=e(83744),fe=e(80998),Te=e(23299),re=e(15739),fn=e(86743),M=e(30426),Ye=e(21794),$n=e(50716),Re={"xagi-nav-style2":"xagi-nav-style2___fPae5",text:"text___ZEZVJ","page-container":"page-container___cFSlk",contextMenu:"contextMenu___P_Nid",contextMenuItem:"contextMenuItem___aDCRI",dangerMenuItem:"dangerMenuItem___JKmWy",disabledMenuItem:"disabledMenuItem___xN5_X",contextMenuIcon:"contextMenuIcon___owB48",contextMenuDivider:"contextMenuDivider___buRX1"},n=e(52676),Fn=function(t){var c,b,u=t.visible,C=t.position,a=t.targetNode,P=t.onClose,$=t.onDelete,S=t.onRename,y=t.onUploadFiles,w=t.onCreateFile,O=t.onCreateFolder,H=t.onImportProject,z=t.onDownloadFileByUrl,X=t.disableDelete,ae=X===void 0?!1:X,r=(0,s.useCallback)(function(F){F(),P()},[P]),ie=(0,s.useCallback)(function(){a&&r(function(){var F={stopPropagation:function(){},preventDefault:function(){},currentTarget:null,target:null,bubbles:!1,cancelable:!1,defaultPrevented:!1,eventPhase:0,isTrusted:!1,nativeEvent:{},timeStamp:Date.now(),type:"click"};$(a,F)})},[a,$,r]),K=(0,s.useCallback)(function(){!a||!S||r(function(){S(a)})},[a,S,r]),ue=(0,s.useCallback)(function(){y&&r(function(){y(a)})},[a,y,r]),ce=(0,s.useCallback)(function(){w&&r(function(){var F=a&&a.type==="folder"?a:null;w(F)})},[a,w,r]),N=(0,s.useCallback)(function(){O&&r(function(){var F=a&&a.type==="folder"?a:null;O(F)})},[a,O,r]),Pe=(0,s.useCallback)(function(){!a||!a.fileProxyUrl||r(function(){z?.(a)})},[a,r]),E=(0,s.useCallback)(function(){!a||!a.fileProxyUrl||r(function(){z?.(a,!0)})},[a,r,z]),Y=(0,s.useRef)(null),q=(0,s.useState)(C),f=m()(q,2),D=f[0],G=f[1];if((0,s.useLayoutEffect)(function(){if(!u||!Y.current){u||G(C);return}var F=Y.current,U=F.offsetHeight,Q=F.offsetWidth;if(U===0){G(C);return}var te=window.innerHeight,ye=window.innerWidth,Fe=C.y,j=C.x;C.y+U>te&&(Fe=C.y-U,Fe=Math.max(8,Fe),U>te-16&&(Fe=8)),C.x+Q>ye&&(j=Math.max(8,ye-Q-8)),G({x:j,y:Fe})},[u,C]),!u)return null;var L=a?a.type==="folder"?[{key:"createFile",label:"\u65B0\u5EFA\u6587\u4EF6",icon:(0,n.jsx)(rn.Z,{}),onClick:ce,disabled:!w},{key:"createFolder",label:"\u65B0\u5EFA\u6587\u4EF6\u5939",icon:(0,n.jsx)(fe.Z,{}),onClick:N,disabled:!O},{key:"divider1",type:"divider"},{key:"rename",label:"\u91CD\u547D\u540D",icon:(0,n.jsx)(Te.Z,{}),onClick:K,disabled:!S},{key:"upload",label:"\u4E0A\u4F20\u6587\u4EF6",icon:(0,n.jsx)(re.Z,{}),onClick:ue,disabled:!y||(a==null||(c=a.name)===null||c===void 0?void 0:c.startsWith("."))},{key:"divider2",type:"divider"},{key:"delete",label:"\u5220\u9664",icon:(0,n.jsx)(fn.Z,{}),onClick:ie,danger:!0}]:[{key:"rename",label:"\u91CD\u547D\u540D",icon:(0,n.jsx)(Te.Z,{}),onClick:K,disabled:!S}].concat(A()(a!=null&&a.fileProxyUrl?[{key:"download",label:"\u4E0B\u8F7D",icon:(0,n.jsx)(M.Z,{}),onClick:Pe}].concat(A()((0,nn.gK)(a?.name||"")?[{key:"exportPdf",label:"\u5BFC\u51FA\u4E3A PDF",icon:(0,n.jsx)(Ye.Z,{}),onClick:E}]:[])):[]),[{key:"upload",label:"\u4E0A\u4F20\u6587\u4EF6",icon:(0,n.jsx)(re.Z,{}),onClick:ue,disabled:!y||(a==null||(b=a.name)===null||b===void 0?void 0:b.startsWith("."))},{key:"divider",type:"divider"},{key:"delete",label:"\u5220\u9664",icon:(0,n.jsx)(fn.Z,{}),onClick:ie,danger:!0}]):[{key:"createFile",label:"\u65B0\u5EFA\u6587\u4EF6",icon:(0,n.jsx)(rn.Z,{}),onClick:ce,disabled:!w},{key:"createFolder",label:"\u65B0\u5EFA\u6587\u4EF6\u5939",icon:(0,n.jsx)(fe.Z,{}),onClick:N,disabled:!O}].concat(A()(H?[{key:"importProject",label:"\u5BFC\u5165\u9879\u76EE",icon:(0,n.jsx)($n.Z,{}),onClick:H}]:[]),[{key:"divider1",type:"divider"},{key:"upload",label:"\u4E0A\u4F20\u6587\u4EF6",icon:(0,n.jsx)(re.Z,{}),onClick:ue,disabled:!y}]),R=ae?L.filter(function(F){return F.key!=="delete"&&F.key!=="rename"&&F.key!=="divider"&&F.key!=="divider2"}):L;return(0,n.jsx)("div",{ref:Y,className:Re.contextMenu,style:{position:"fixed",left:D.x,top:D.y,zIndex:1e3},onClick:function(U){return U.stopPropagation()},children:R.map(function(F,U){return F.type==="divider"?(0,n.jsx)("div",{className:Re.contextMenuDivider},U):(0,n.jsxs)("div",{className:"".concat(Re.contextMenuItem," ").concat(F.danger?Re.dangerMenuItem:""," ").concat(F.disabled?Re.disabledMenuItem:""),onClick:F.disabled?void 0:F.onClick,children:[(0,n.jsx)("span",{className:Re.contextMenuIcon,children:F.icon}),(0,n.jsx)("span",{children:F.label})]},F.key)})})},jn=Fn,l=e(68279),Ve=e(40462),Sn=e(16722),mn=e(37269),Mn=e(27867),hn=e(68659),xe=e(62549),ke=e(36967),Je=e(73981),Xe=e(68108),De=e(9504),an=Object.defineProperty,I=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,qe=(i,t,c)=>t in i?an(i,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[t]=c,Kn=(i,t)=>{for(var c in t||(t={}))d.call(t,c)&&qe(i,c,t[c]);if(I)for(var c of I(t))g.call(t,c)&&qe(i,c,t[c]);return i};const Cn=i=>s.createElement("svg",Kn({viewBox:"0 0 1024 1024",width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg"},i),s.createElement("path",{fill:"currentColor",d:"m153.77 517.559 200.388-197.242-51.298-52.127-254.098 250.1 254.44 243.615 50.59-52.834L153.771 517.56zm504.516-197.242 51.297-52.127 254.099 250.1-254.44 243.615-50.59-52.834 200.02-191.512-200.386-197.242zM545.304 234.13 393.996 785.554l70.534 19.359 151.308-551.4-70.534-19.358z"}));var vt="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB3aWR0aD0iMWVtIiBoZWlnaHQ9IjFlbSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Im0xNTMuNzcgNTE3LjU1OSAyMDAuMzg4LTE5Ny4yNDItNTEuMjk4LTUyLjEyNy0yNTQuMDk4IDI1MC4xIDI1NC40NCAyNDMuNjE1IDUwLjU5LTUyLjgzNEwxNTMuNzcxIDUxNy41NnptNTA0LjUxNi0xOTcuMjQyIDUxLjI5Ny01Mi4xMjcgMjU0LjA5OSAyNTAuMS0yNTQuNDQgMjQzLjYxNS01MC41OS01Mi44MzQgMjAwLjAyLTE5MS41MTItMjAwLjM4Ni0xOTcuMjQyek01NDUuMzA0IDIzNC4xMyAzOTMuOTk2IDc4NS41NTRsNzAuNTM0IDE5LjM1OSAxNTEuMzA4LTU1MS40LTcwLjUzNC0xOS4zNTh6Ii8+PC9zdmc+",ee={"xagi-nav-style2":"xagi-nav-style2___X190V",text:"text___ZNvWv","page-container":"page-container___xWHpK",filePathHeader:"filePathHeader___Ihqhq",fileInfo:"fileInfo___MIrBc",fileDetails:"fileDetails___ktrUt",fileName:"fileName___HkkLJ",fileMeta:"fileMeta___UXR0l","svg-box":"svg-box___zwTmz","pc-box":"pc-box___eeX3X",viewModeButtons:"viewModeButtons___cJqDD",viewModeButton:"viewModeButton___b07iR",actionButtons:"actionButtons___KQ8lq",actionButton:"actionButton___HQg06"},Gn=e(58176),bn=function(t){var c=t.onImportProject,b=t.onRestartServer,u=t.onExportProject,C=(0,s.useMemo)(function(){return[].concat(A()(c?[{key:"import",icon:(0,n.jsx)(l.Z,{name:"icons-common-import",style:{fontSize:16}}),label:"\u5BFC\u5165\u9879\u76EE",onClick:c},{type:"divider"}]:[]),A()(b?[{key:"restart",icon:(0,n.jsx)(l.Z,{name:"icons-common-restart",style:{fontSize:16}}),label:"\u91CD\u542F\u8FDC\u7A0B\u7535\u8111",onClick:b}]:[]),A()(u?[{type:"divider"},{key:"export",icon:(0,n.jsx)(l.Z,{name:"icons-common-download",style:{fontSize:16}}),label:"\u5BFC\u51FA\u9879\u76EE",onClick:u}]:[]))},[c,b,u]);return C!=null&&C.length?(0,n.jsx)(Gn.Z,{trigger:["click"],menu:{items:C},placement:"bottomRight",children:(0,n.jsx)(De.ZP,{type:"text",icon:(0,n.jsx)(l.Z,{name:"icons-common-more",style:{fontSize:"16px"}})})}):null},Qn=bn,Yn=Object.defineProperty,wn=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable,Jn=(i,t,c)=>t in i?Yn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[t]=c,ft=(i,t)=>{for(var c in t||(t={}))ne.call(t,c)&&Jn(i,c,t[c]);if(wn)for(var c of wn(t))Se.call(t,c)&&Jn(i,c,t[c]);return i};const Ce=i=>React.createElement("svg",ft({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true"},i),React.createElement("rect",{width:20,height:14,x:2,y:3,rx:2}),React.createElement("path",{d:"M8 21h8M12 17v4"}));var _e="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgYXJpYS1oaWRkZW49InRydWUiPjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIxNCIgeD0iMiIgeT0iMyIgcng9IjIiLz48cGF0aCBkPSJNOCAyMWg4TTEyIDE3djQiLz48L3N2Zz4=",mt=e(99330),Xn=e(47974),me=e(59942),le=e(41766),qn=e(86015),Dn=e(53817),_n=e(78931),ln=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],ht=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],et=function(t,c){var b=t.fieldProps,u=t.children,C=t.params,a=t.proFieldProps,P=t.mode,$=t.valueEnum,S=t.request,y=t.showSearch,w=t.options,O=(0,le.Z)(t,ln),H=(0,s.useContext)(Dn.Z);return(0,n.jsx)(_n.Z,(0,me.Z)((0,me.Z)({valueEnum:(0,qn.h)($),request:S,params:C,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,me.Z)({options:w,mode:P,showSearch:y,getPopupContainer:H.getPopupContainer},b),ref:c,proFieldProps:a},O),{},{children:u}))},pt=s.forwardRef(function(i,t){var c=i.fieldProps,b=i.children,u=i.params,C=i.proFieldProps,a=i.mode,P=i.valueEnum,$=i.request,S=i.options,y=(0,le.Z)(i,ht),w=(0,me.Z)({options:S,mode:a||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},c),O=(0,s.useContext)(Dn.Z);return(0,n.jsx)(_n.Z,(0,me.Z)((0,me.Z)({valueEnum:(0,qn.h)(P),request:$,params:u,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,me.Z)({getPopupContainer:O.getPopupContainer},w),ref:t,proFieldProps:C},y),{},{children:b}))}),nt=s.forwardRef(et),xt=pt,Pn=nt;Pn.SearchSelect=xt,Pn.displayName="ProFormComponent";var Zn=Pn,Tn=e(64616),gt=e(91716),Rn=[{label:"1\u5206\u949F",value:60},{label:"5\u5206\u949F",value:5*60},{label:"10\u5206\u949F",value:10*60},{label:"20\u5206\u949F",value:20*60},{label:"30\u5206\u949F",value:30*60},{label:"40\u5206\u949F",value:40*60},{label:"50\u5206\u949F",value:50*60},{label:"1\u5C0F\u65F6",value:60*60},{label:"2\u5C0F\u65F6",value:2*60*60},{label:"4\u5C0F\u65F6",value:4*60*60},{label:"8\u5C0F\u65F6",value:8*60*60},{label:"16\u5C0F\u65F6",value:16*60*60},{label:"1\u5929",value:24*60*60}],tt=function(t){var c=t.visible,b=t.onClose,u=t.conversationId,C=(0,s.useRef)(),a=function(S){var y=Rn.find(function(w){return w.value===S});return y?.label||"".concat(S,"\u79D2")},P=function(){var $=W()(Z()().mark(function S(y){var w,O,H,z,X,ae,r,ie,K,ue;return Z()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(u){N.next=3;break}return Qe.ZP.error("\u4F1A\u8BDDID\u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u5206\u4EAB"),N.abrupt("return",!1);case 3:return N.prev=3,w="/computer/desktop/".concat(u,"/vnc.html?resize=scale&autoconnect=true"),O={conversationId:Number(u),type:"DESKTOP",content:w,expireSeconds:y.expireSeconds},N.next=8,(0,mn.mU)(O);case 8:if(H=N.sent,z=H.data,X=H.code,X!==Ve.Gh){N.next=23;break}return r=((ae=window)===null||ae===void 0||(ae=ae.location)===null||ae===void 0?void 0:ae.origin)||"",ie="/desktop-preview.html",K=new URLSearchParams,K.set("sk",z?.shareKey),K.set("isDev","false"),ue=r+ie+"?"+K.toString(),(0,mt.TE)(ue),Qe.ZP.success("\u8FDC\u7A0B\u684C\u9762\u5206\u4EAB\u6210\u529F\uFF0C\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F"),N.abrupt("return",!0);case 23:return Qe.ZP.error("\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),N.abrupt("return",!1);case 25:N.next=32;break;case 27:return N.prev=27,N.t0=N.catch(3),console.error("\u5206\u4EAB\u8FDC\u7A0B\u684C\u9762\u5931\u8D25:",N.t0),Qe.ZP.error("\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),N.abrupt("return",!1);case 32:case"end":return N.stop()}},S,null,[[3,27]])}));return function(y){return $.apply(this,arguments)}}();return(0,n.jsxs)(Xn.Y,{title:"\u5206\u4EAB\u8FDC\u7A0B\u684C\u9762",open:c,formRef:C,onOpenChange:function(S){S||b()},onFinish:P,modalProps:{width:480,destroyOnClose:!0},submitTimeout:2e3,submitter:{searchConfig:{submitText:"\u751F\u6210\u5206\u4EAB\u94FE\u63A5",resetText:"\u53D6\u6D88"}},initialValues:{expireSeconds:60*60},children:[(0,n.jsx)(Zn,{name:"expireSeconds",label:"\u6709\u6548\u65F6\u95F4",placeholder:"\u8BF7\u9009\u62E9\u6709\u6548\u65F6\u95F4",options:Rn,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6709\u6548\u65F6\u95F4"}]}),(0,n.jsx)(Tn.Z,{name:["expireSeconds"],children:function(S){var y=S.expireSeconds;return(0,n.jsxs)("div",{style:{marginTop:-16,marginBottom:16,color:"#00000073"},children:["\u94FE\u63A5\u5C06\u5728 ",a(y||5*60)," \u540E\u5931\u6548"]})}}),(0,n.jsx)(gt.Z,{message:"\u6E29\u99A8\u63D0\u793A\uFF1A",description:(0,n.jsxs)("ul",{style:{margin:0,paddingLeft:0},children:[(0,n.jsx)("li",{children:"\u5206\u4EAB\u94FE\u63A5\u751F\u6210\u540E\u5C06\u81EA\u52A8\u590D\u5236\u5230\u526A\u5207\u677F"}),(0,n.jsx)("li",{children:"\u94FE\u63A5\u5728\u6709\u6548\u671F\u5185\u53EF\u591A\u6B21\u8BBF\u95EE"}),(0,n.jsx)("li",{children:"\u4E3A\u4FDD\u969C\u5B89\u5168\uFF0C\u8BF7\u52FF\u5C06\u94FE\u63A5\u5206\u4EAB\u7ED9\u964C\u751F\u4EBA"}),(0,n.jsx)("li",{children:"\u94FE\u63A5\u5931\u6548\u540E\u9700\u8981\u91CD\u65B0\u751F\u6210"})]}),type:"info",showIcon:!0,style:{marginTop:8}})]})},rt=tt,yt=ze().bind(ee),at=function(t){var c=t.className,b=t.conversationId,u=t.targetNode,C=t.viewMode,a=C===void 0?"preview":C,P=t.onViewModeChange,$=t.onRestartServer,S=t.onImportProject,y=t.onExportProject,w=t.onFullscreen,O=t.isFullscreen,H=O===void 0?!1:O,z=t.onSaveFiles,X=t.onCancelSaveFiles,ae=t.hasModifiedFiles,r=ae===void 0?!1:ae,ie=t.isSavingFiles,K=ie===void 0?!1:ie,ue=t.isDownloadingFile,ce=ue===void 0?!1:ue,N=t.showMoreActions,Pe=N===void 0?!0:N,E=t.viewFileType,Y=E===void 0?"preview":E,q=t.onViewFileTypeChange,f=t.onDownloadFileByUrl,D=t.isShowShare,G=D===void 0?!0:D,L=t.onExportPdf,R=t.isExportingPdf,F=R===void 0?!1:R,U=u?.name,Q=u?.size,te=(0,s.useMemo)(function(){return Q?(0,p.sS)(Q):""},[Q]),ye=localStorage.getItem(Sn.CD),Fe=ye?JSON.parse(ye):null,j=(0,s.useState)(!1),Ze=m()(j,2),wt=Ze[0],Bn=Ze[1],Pt=function(){var Me=W()(Z()().mark(function We(){var Ln,Un,pn,st,sn,ut,Vn,In,Hn;return Z()().wrap(function(un){for(;;)switch(un.prev=un.next){case 0:return Ln={conversationId:Number(b),type:"CONVERSATION",content:u?.fileProxyUrl||""},un.next=3,(0,mn.mU)(Ln);case 3:Un=un.sent,pn=Un.data,st=Un.code,st===Ve.Gh&&(ut=((sn=window)===null||sn===void 0||(sn=sn.location)===null||sn===void 0?void 0:sn.origin)||"",Vn="/file-preview.html",In=new URLSearchParams,In.set("sk",pn?.shareKey),In.set("isDev","false"),Hn=ut+Vn+"?"+In.toString(),(0,Mn.TE)(Hn),Qe.ZP.success("\u5206\u4EAB\u6210\u529F\uFF0C\u94FE\u63A5\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F"));case 7:case"end":return un.stop()}},We)}));return function(){return Me.apply(this,arguments)}}(),zn=function(){Bn(!0)},Nt=function(We){b&&(We==="preview"&&Pt(),We==="desktop"&&zn())};return(0,n.jsxs)("div",{className:yt(ee.filePathHeader,c),children:[(0,n.jsx)("div",{className:ee.fileInfo,children:a==="preview"?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:ee.fileDetails,children:[(0,n.jsx)("div",{className:ee.fileName,children:U}),te&&(0,n.jsx)("div",{className:ee.fileMeta,children:te})]}),u?.fileProxyUrl&&U&&(U?.includes(".htm")||(0,nn.gK)(U))&&(0,n.jsx)(Je.Z,{value:Y,onChange:q,options:[{label:(0,n.jsx)(Xe.Z,{title:"\u9884\u89C8",children:(0,n.jsx)(hn.Z,{})}),value:"preview"},{label:(0,n.jsx)(Xe.Z,{title:"\u6E90\u4EE3\u7801",children:(0,n.jsx)("span",{className:ee["svg-box"],children:(0,n.jsx)(Cn,{})})}),value:"code"}]})]}):(0,n.jsxs)("div",{className:ee["pc-box"],children:[(0,n.jsx)("img",{src:_e,alt:""}),(0,n.jsxs)("div",{className:ee.fileName,children:[Fe?.nickName||Fe?.userName||"\u8FDC\u7A0B","\u7684\u667A\u80FD\u4F53\u7535\u8111"]})]})}),r&&(0,n.jsxs)("div",{className:"flex items-center content-end gap-4 ml-auto",children:[(0,n.jsx)(De.ZP,{size:"small",type:"primary",onClick:z,loading:K,children:"\u4FDD\u5B58"}),(0,n.jsx)(De.ZP,{size:"small",type:"default",onClick:X,children:"\u53D6\u6D88"})]}),u?.fileProxyUrl&&a==="preview"&&(0,n.jsx)(Xe.Z,{title:ce?"\u4E0B\u8F7D\u4E2D...":"\u4E0B\u8F7D",children:(0,n.jsx)(De.ZP,{type:"text",size:"small",icon:(0,n.jsx)(l.Z,{name:"icons-common-download",style:{fontSize:16}}),onClick:function(){return f?.(u)},className:ee.actionButton,loading:ce,disabled:ce})}),u&&U&&(0,nn.gK)(U)&&a==="preview"&&(0,n.jsx)(Xe.Z,{title:F?"\u5BFC\u51FA\u4E2D...":"\u5BFC\u51FA\u4E3A PDF",children:(0,n.jsx)(De.ZP,{type:"text",size:"small",icon:(0,n.jsx)(Ye.Z,{style:{fontSize:16}}),onClick:function(){return L?.(u)},className:ee.actionButton,loading:F,disabled:F})}),P&&(0,n.jsxs)("div",{className:ee.viewModeButtons,children:[(0,n.jsx)(De.ZP,{type:a==="preview"?"primary":"default",size:"small",icon:(0,n.jsx)(l.Z,{name:"icons-common-preview",style:{fontSize:14}}),onClick:function(){return P?.("preview")},className:ee.viewModeButton,children:"\u6587\u4EF6\u9884\u89C8"}),(0,n.jsx)(De.ZP,{type:a==="desktop"?"primary":"default",size:"small",icon:(0,n.jsx)(xe.Z,{style:{fontSize:14}}),onClick:function(){return P?.("desktop")},className:ee.viewModeButton,children:"\u667A\u80FD\u4F53\u7535\u8111"})]}),(0,n.jsxs)("div",{className:ee.actionButtons,children:[G&&(a==="desktop"||u?.fileProxyUrl&&a==="preview")&&(0,n.jsx)(Xe.Z,{title:"\u5206\u4EAB",children:(0,n.jsx)(De.ZP,{type:"text",size:"small",icon:(0,n.jsx)(l.Z,{name:"icons-chat-share",style:{fontSize:16}}),onClick:function(){return Nt(a)},className:ee.actionButton})}),u?.fileProxyUrl&&a==="preview"&&(0,n.jsx)(Xe.Z,{title:ce?"\u4E0B\u8F7D\u4E2D...":"\u4E0B\u8F7D",children:(0,n.jsx)(De.ZP,{type:"text",size:"small",icon:(0,n.jsx)(l.Z,{name:"icons-common-download",style:{fontSize:16}}),onClick:function(){return f?.(u)},className:ee.actionButton,loading:ce,disabled:ce})}),(0,n.jsx)(Xe.Z,{title:H?"\u9000\u51FA\u5168\u5C4F":"\u5168\u5C4F",children:(0,n.jsx)(De.ZP,{type:"text",size:"small",icon:H?(0,n.jsx)(ke.Z,{style:{fontSize:16}}):(0,n.jsx)(l.Z,{name:"icons-common-fullscreen",style:{fontSize:16}}),onClick:w,className:ee.actionButton})}),Pe&&(0,n.jsx)(Qn,{onImportProject:S,onRestartServer:$,onExportProject:y})]}),(0,n.jsx)(rt,{visible:wt,onClose:function(){return Bn(!1)},conversationId:b||""})]})},it=at,lt=e(59602),kn=e(63619),se={"xagi-nav-style2":"xagi-nav-style2___Jx3g7",text:"text___bzRU7","page-container":"page-container___eG6xg",fileTree:"fileTree___mE7PM",inlineRenameInput:"inlineRenameInput___bkriO",folderItem:"folderItem___zTMkc",folderHeader:"folderHeader___JLBhN",folderIcon:"folderIcon___Ej8Ai",expanded:"expanded___Bh5ot",folderName:"folderName___nn26p",fileList:"fileList___LpbNl","slide-down":"slide-down___llSw8",fileItem:"fileItem___h_moW",activeFile:"activeFile___oL0_4",fileName:"fileName___N7g9T",hiddenFile:"hiddenFile___O7ChY","no-files":"no-files___RTlRv"},Nn=ze().bind(se),Ft=function(t){var c=t.files,b=t.fileTreeDataLoading,u=t.taskAgentSelectedFileId,C=t.selectedFileId,a=t.renamingNode,P=t.onCancelRename,$=t.onFileSelect,S=t.onConfirmRenameFile,y=t.onContextMenu,w=(0,s.useState)(""),O=m()(w,2),H=O[0],z=O[1],X=(0,s.useRef)(null),ae=(0,s.useState)(function(){return new Set((c||[]).filter(function(f){return f.type==="folder"}).map(function(f){return f.id}))}),r=m()(ae,2),ie=r[0],K=r[1],ue=(0,s.useCallback)(function(f){var D=260,G=16,L=8;return D-G-f*L},[]),ce=(0,s.useCallback)(function(f){K(function(D){var G=new Set(D);return G.has(f)?G.delete(f):G.add(f),G})},[]),N=function(){var D=H.trim(),G=a?.status==="create"&&!D;P({removeIfNew:G,node:a||null}),z("")},Pe=function(){if(a){var D=H.trim();if(!D||D===a.name){N();return}var G=/[/\\:*?"<>|]/;if(!G.test(D)){N();try{S(a,D)}catch(L){console.error("\u91CD\u547D\u540D\u5931\u8D25:",L)}}}},E=(0,s.useCallback)(function(f){f.key==="Enter"?Pe():f.key==="Escape"&&N()},[Pe,N]),Y=(0,s.useCallback)(function(){setTimeout(function(){if(a)if(a.status==="create"){var f=H.trim();f?Pe():N()}else Pe()},100)},[a,H,Pe,N]);(0,s.useEffect)(function(){a&&X.current&&(X.current.focus(),X.current.select()),a&&z(a.name)},[a,ie]),(0,s.useEffect)(function(){if(!(!a||a.status!=="create")){var f=a.parentPath;if(f){var D=f.split("/").filter(Boolean);K(function(G){var L=new Set(G),R="";return D.forEach(function(F){R=R?"".concat(R,"/").concat(F):F,L.add(R)}),L})}}},[a]),(0,s.useEffect)(function(){if(!(!u||!c||c.length===0)){var f=(0,p.gE)(u,c);if(f){var D=function(R){var F=[],U=R.split("/").filter(Boolean);if(U.length<=1)return F;for(var Q="",te=0;te<U.length-1;te++)Q=Q?"".concat(Q,"/").concat(U[te]):U[te],F.push(Q);return F},G=D(f.path||f.id);G.length>0&&K(function(L){var R=new Set(L);return G.forEach(function(F){R.add(F)}),R})}}},[u,c]);var q=(0,s.useCallback)(function(f){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,G=ie.has(f.id),L=C===f.id,R=a?.id===f.id,F=f.id,U=ue(D);if(f.type==="folder")return(0,n.jsxs)("div",{className:se.folderItem,style:{marginLeft:D*8,maxWidth:"".concat(U,"px")},children:[(0,n.jsxs)("div",{className:se.folderHeader,onClick:function(){return!R&&ce(f.id)},onContextMenu:function(ye){return y(ye,f)},children:[(0,n.jsx)(l.Z,{name:"icons-common-caret_right",style:{fontSize:"16px"},className:"".concat(se.folderIcon," ").concat(G?se.expanded:"")}),R?(0,n.jsx)(kn.Z,{ref:X,value:H,onChange:function(ye){return z(ye.target.value)},onKeyDown:E,onBlur:Y,className:se.inlineRenameInput,size:"small"}):(0,n.jsx)("span",{className:Nn(se.folderName,"text-ellipsis"),children:f.name})]}),G&&f.children&&(0,n.jsx)("div",{className:se.fileList,children:f.children.map(function(te){return q(te,D+1)})})]},F);var Q=ue(D);return(0,n.jsxs)("div",{className:"".concat(se.fileItem," ").concat(L?se.activeFile:""),onClick:function(){f.name.startsWith(".")||R||$(f.id)},onContextMenu:function(ye){return y(ye,f)},style:{marginLeft:D*8,maxWidth:"".concat(Q,"px")},children:[(0,pe.LP)(f.name),R?(0,n.jsx)(kn.Z,{ref:X,value:H,onChange:function(ye){return z(ye.target.value)},onKeyDown:E,onBlur:Y,className:se.inlineRenameInput,size:"small"}):(0,n.jsx)("span",{className:"".concat(se.fileName," ").concat(f.name.startsWith(".")?se.hiddenFile:""),children:f.name})]},F)},[ie,C,a,H,ce,$,y,E,Y,ue]);return(0,n.jsx)("div",{className:se.fileTree,onContextMenu:function(D){return y(D,null)},children:b&&!(c!=null&&c.length)?(0,n.jsx)("div",{className:Nn("flex","content-center","items-center","h-full"),children:(0,n.jsx)(lt.Z,{})}):c?.length>0?c?.map(function(f){return q(f)}):(0,n.jsx)("div",{className:Nn(se["no-files"],"flex","content-center","items-center","h-full"),children:"\u6682\u65E0\u6587\u4EF6"})})},ge=Ft,Oe={"xagi-nav-style2":"xagi-nav-style2___i8EY2",text:"text___dH4Fc","page-container":"page-container___p0ktk","file-tree-view":"file-tree-view___rt9Ar","content-container":"content-container___kzIgA","fullscreen-modal":"fullscreen-modal___VAznk","fullscreen-container":"fullscreen-container___Wj9cB","fullscreen-content":"fullscreen-content___lVcaP","vnc-preview":"vnc-preview___QgNP2"},on=e(82092),ot=e.n(on),On=e(81881),An=e(17023),we={"xagi-nav-style2":"xagi-nav-style2___PaOXd",text:"text___bvTIY","page-container":"page-container___fFc3m","search-view":"search-view___ybKDc","search-bar":"search-bar___DtR6O","search-icon":"search-icon___IYYvs","search-dropdown":"search-dropdown___Koqjw","search-item":"search-item___l11iE","search-item-selected":"search-item-selected___D_Bmb","file-icon":"file-icon___jqAyo","file-info":"file-info___lzyLs","file-name":"file-name___HKjmF","file-path":"file-path___tymxJ"},Ae=ze().bind(we),jt=function(t){var c=t.className,b=t.files,u=t.onFileSelect,C=(0,s.useState)(""),a=m()(C,2),P=a[0],$=a[1],S=(0,s.useState)(0),y=m()(S,2),w=y[0],O=y[1],H=(0,s.useState)(!1),z=m()(H,2),X=z[0],ae=z[1],r=(0,s.useRef)(null),ie=(0,s.useRef)(null),K=(0,s.useMemo)(function(){return P.trim()?(0,On.hT)(b,P):[]},[b,P]),ue=function(Y){var q=Y.target.value;$(q),ae(q.trim().length>0),O(0)},ce=function(Y){u&&u(Y.id),$(""),ae(!1)},N=function(Y){if(!(!X||K.length===0))switch(Y.key){case"ArrowDown":Y.preventDefault(),O(function(q){return q<K.length-1?q+1:q});break;case"ArrowUp":Y.preventDefault(),O(function(q){return q>0?q-1:0});break;case"Enter":Y.preventDefault(),K[w]&&ce(K[w]);break;case"Escape":$(""),ae(!1);break}},Pe=function(Y){var q=Y.split("/");return q.slice(0,-1).join("/")};return(0,s.useEffect)(function(){var E=function(q){r.current&&!r.current.contains(q.target)&&ae(!1)};if(X)return document.addEventListener("mousedown",E),function(){document.removeEventListener("mousedown",E)}},[X]),(0,s.useEffect)(function(){if(ie.current&&w>=0){var E=ie.current.children[w];E&&E.scrollIntoView({block:"nearest",behavior:"smooth"})}},[w]),(0,n.jsxs)("div",{className:Ae(we["search-view"],"relative",c),ref:r,children:[(0,n.jsx)("div",{className:Ae(we["search-bar"]),children:(0,n.jsx)(kn.Z,{placeholder:"\u641C\u7D22\u6587\u4EF6...",prefix:(0,n.jsx)(An.Z,{className:Ae(we["search-icon"])}),value:P,onChange:ue,onKeyDown:N,onFocus:function(){P.trim().length>0&&ae(!0)}})}),X&&K.length>0&&(0,n.jsx)("div",{className:Ae(we["search-dropdown"]),ref:ie,children:K.map(function(E,Y){var q=Y===w,f=Pe(E.path||E.id);return(0,n.jsxs)("div",{className:Ae(we["search-item"],ot()({},we["search-item-selected"],q)),onClick:function(){return ce(E)},onMouseEnter:function(){return O(Y)},children:[(0,n.jsx)("div",{className:Ae(we["file-icon"]),children:(0,pe.LP)(E.name)}),(0,n.jsxs)("div",{className:Ae(we["file-info"]),children:[(0,n.jsx)("div",{className:Ae(we["file-name"]),children:E.name}),(0,n.jsx)("div",{className:Ae(we["file-path"]),children:f})]})]},E.id)})})]})},St=jt,He=ze().bind(Oe),Ct=(0,s.forwardRef)(function(i,t){var c,b=i.headerClassName,u=i.taskAgentSelectedFileId,C=i.originalFiles,a=i.fileTreeDataLoading,P=i.readOnly,$=P===void 0?!1:P,S=i.targetId,y=i.viewMode,w=i.onUploadFiles,O=i.onExportProject,H=i.onRenameFile,z=i.onCreateFileNode,X=i.onDeleteFile,ae=i.onViewModeChange,r=i.onSaveFiles,ie=i.onImportProject,K=i.onRestartServer,ue=i.showMoreActions,ce=ue===void 0?!0:ue,N=i.isFullscreenPreview,Pe=N===void 0?!1:N,E=i.onFullscreenPreview,Y=i.onShare,q=i.isShowShare,f=q===void 0?!0:q,D=(0,s.useState)([]),G=m()(D,2),L=G[0],R=G[1],F=(0,s.useState)(""),U=m()(F,2),Q=U[0],te=U[1],ye=(0,s.useState)(null),Fe=m()(ye,2),j=Fe[0],Ze=Fe[1],wt=(0,s.useState)(null),Bn=m()(wt,2),Pt=Bn[0],zn=Bn[1],Nt=(0,s.useState)(null),Me=m()(Nt,2),We=Me[0],Ln=Me[1],Un=(0,s.useState)({x:0,y:0}),pn=m()(Un,2),st=pn[0],sn=pn[1],ut=(0,s.useState)(!1),Vn=m()(ut,2),In=Vn[0],Hn=Vn[1],Rt=(0,s.useState)(!1),un=m()(Rt,2),ct=un[0],It=un[1],qt=(0,s.useState)([]),kt=m()(qt,2),cn=kt[0],dt=kt[1],_t=(0,s.useState)(!1),Ot=m()(_t,2),er=Ot[0],At=Ot[1],nr=(0,s.useState)(!1),Bt=m()(nr,2),tr=Bt[0],zt=Bt[1],rr=(0,s.useState)(!1),Lt=m()(rr,2),ar=Lt[0],Ut=Lt[1],ir=(0,s.useState)(!1),Vt=m()(ir,2),lr=Vt[0],Ht=Vt[1],or=(0,s.useState)(!1),Wt=m()(or,2),sr=Wt[0],$t=Wt[1],ur=(0,s.useState)("preview"),Kt=m()(ur,2),Gt=Kt[0],Et=Kt[1],Mt=(0,s.useRef)("");(0,s.useEffect)(function(){Pe&&It(!0)},[Pe]);var bt=function(){var V=W()(Z()().mark(function v(h){var o,x,k,J,de,$e,Wn,_,en;return Z()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(o=(0,p.gE)(h,L),!o){ve.next=32;break}if(x=o?.content||"",!x){ve.next=9;break}te(h),Et("preview"),Ze(o),ve.next=30;break;case 9:if(!sr){ve.next=12;break}return Qe.ZP.warning("\u6587\u4EF6\u6B63\u5728\u91CD\u547D\u540D\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"),ve.abrupt("return");case 12:if(te(h),Et("preview"),k=(0,p.CO)(o?.name||""),J=(0,p.NU)(o?.name||""),de=(0,p.TN)(o?.name||""),$e=(0,p.OA)(o?.name||""),Wn=$e?.isDoc||!1,_=o?.fileProxyUrl||"",!(k||J||de||Wn||!_)){ve.next=24;break}Ze(o),ve.next=30;break;case 24:if(!_){ve.next=30;break}return ve.next=27,(0,be.O3)(_);case 27:en=ve.sent,Ze(T()(T()({},o),{},{content:en||""})),R(function(Ke){var Tt=(0,pe.Lz)(h,en,Ke);return Tt});case 30:ve.next=33;break;case 32:Ze(null);case 33:case"end":return ve.stop()}},v)}));return function(h){return V.apply(this,arguments)}}();(0,s.useImperativeHandle)(t,function(){return{changeFiles:cn}},[cn]),(0,s.useEffect)(function(){if(!u){Mt.current="";return}L?.length>0&&u!==Mt.current&&(Mt.current=u,bt(u))},[u,L]),(0,s.useEffect)(function(){if(Array.isArray(C)&&C.length>0){var V=(0,p.A3)(C);R(V)}return function(){R([]),dt([])}},[C]);var cr=function(v,h){$||(v.preventDefault(),v.stopPropagation(),Ln(h),sn({x:v.clientX,y:v.clientY}),Hn(!0))},Dt=function(){Hn(!1),Ln(null)};(0,s.useEffect)(function(){return document.addEventListener("click",Dt),function(){return document.removeEventListener("click",Dt)}},[]);var dr=function(v){if(v!=null&&v.removeIfNew&&v.node){var h=v.node.id,o=function x(k){return k.filter(function(J){return J.id!==h}).map(function(J){return J.children&&J.children.length>0?T()(T()({},J),{},{children:x(J.children)}):J})};R(function(x){return o(x)}),Q===h&&(te(""),Ze(null))}zn(null)},vr=function(v){zn(v)},fr=function(){var V=W()(Z()().mark(function v(h,o){var x,k,J,de,$e;return Z()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(!o||!(o!=null&&o.trim()))){_.next=2;break}return _.abrupt("return");case 2:if(x=dn()(L),_.prev=3,h){_.next=6;break}return _.abrupt("return");case 6:if(k=h.status==="create",J=(0,pe.D7)(L,h.id,o.trim()),R(J),!k){_.next=16;break}return _.next=12,z?.(h,o);case 12:de=_.sent,de||R(x),_.next=22;break;case 16:return $t(!0),_.next=19,H?.(h,o);case 19:$e=_.sent,$t(!1),$e?j&&(j.id===h.id||j.name===h.name)&&Ze(function(en){return en&&T()(T()({},en),{},{name:o})}):R(x);case 22:_.next=27;break;case 24:_.prev=24,_.t0=_.catch(3),R(x);case 27:case"end":return _.stop()}},v,null,[[3,24]])}));return function(h,o){return V.apply(this,arguments)}}(),mr=function(v){w?.(v)},hr=function(){var V=W()(Z()().mark(function v(h){var o;return Z()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,X?.(h);case 2:o=k.sent,o&&h.id===j?.id&&(Ze(null),te(""));case 4:case"end":return k.stop()}},v)}));return function(h){return V.apply(this,arguments)}}(),Qt=function(v,h){var o=v?.path||null,x="__new__".concat(Date.now()),k=o?"".concat(o,"/").concat(x):x,J={id:k,name:"",type:h,path:k,children:h==="folder"?[]:void 0,parentPath:o,content:h==="file"?"":void 0,lastModified:Date.now(),status:"create"};R(function(de){var $e=v?.id||null,Wn=function en(Zt,ve){return ve?Zt.map(function(Ke){if(Ke.id===ve){var Tt=Ke.children||[];return T()(T()({},Ke),{},{children:[J].concat(A()(Tt))})}return Ke.children&&Ke.children.length>0?T()(T()({},Ke),{},{children:en(Ke.children,ve)}):Ke}):[J].concat(A()(Zt))},_=Wn(de,$e);return _}),J&&zn(J)},pr=function(v){Qt(v,"file")},xr=function(v){Qt(v,"folder")},gr=function(v,h){var o="";R(function(x){var k=(0,p.gE)(v,x);o=k?.content||"";var J=(0,pe.Lz)(v,h,x);return J}),Ze(function(x){return T()(T()({},x),{},{content:h})}),dt(function(x){var k=x.findIndex(function(de){return de.fileId===v});if(k!==-1){var J=A()(x);return J[k]=T()(T()({},J[k]),{},{fileContent:h}),J}else return h!==o?[].concat(A()(x),[{fileId:v,fileContent:h,originalFileContent:o}]):x})},yr=(0,p.CO)(j?.name||""),Fr=(0,p.NU)(j?.name||""),jr=(0,p.TN)(j?.name||""),En=(0,p.OA)(j?.name||""),Sr=En?.isDoc||!1,Cr=En?.fileType,wr=(0,p.iT)(j?.name||""),Pr=function(){It(!ct),E?.(!ct)},Nr=function(){It(!1),E?.(!1)},Ir=function(){var V=W()(Z()().mark(function v(){var h;return Z()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return At(!0),x.next=3,r?.(cn);case 3:h=x.sent,At(!1),h&&dt([]);case 6:case"end":return x.stop()}},v)}));return function(){return V.apply(this,arguments)}}(),Er=function(){var v=L;cn.forEach(function(x){v=(0,pe.Lz)(x.fileId,x.originalFileContent,v)}),R(v);var h=cn?.find(function(x){return x.fileId===Q});if(h){var o=h?.originalFileContent;Ze(function(x){return T()(T()({},x),{},{content:o})})}dt([])},Yt=function(){var v,h;if(y==="desktop")return(0,n.jsx)(yn.Z,{serviceUrl:"",cId:S?.toString()||"",readOnly:$,autoConnect:!0,className:He(Oe["vnc-preview"])});if(!j||j!=null&&(v=j.id)!==null&&v!==void 0&&v.includes("__new__"))return(0,n.jsx)(vn.Z,{type:"empty",title:"\u8BF7\u4ECE\u5DE6\u4FA7\u6587\u4EF6\u6811\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6\u8FDB\u884C\u9884\u89C8",description:"\u5F53\u524D\u6CA1\u6709\u53EF\u9884\u89C8\u7684\u6587\u4EF6\uFF0C\u8BF7\u4ECE\u5DE6\u4FA7\u6587\u4EF6\u6811\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6\u8FDB\u884C\u9884\u89C8"});var o=j!=null&&j.fileProxyUrl?"".concat("").concat(j?.fileProxyUrl):"";if(Fr&&o)return(0,n.jsx)(Le.Z,{src:o,fileType:"video"});if(jr&&o)return(0,n.jsx)(Le.Z,{src:o,fileType:"audio"});if(Sr&&o)return(0,n.jsx)(Le.Z,{src:o,fileType:Cr});if(yr)return o?(0,n.jsx)(Le.Z,{src:o,fileType:"image"}):(0,n.jsx)(oe.OO,{imageUrl:(0,p.T2)(j?.content||""),alt:Q,onRefresh:function(){}});if(!wr){var x,k=(Q==null||(x=Q.split("."))===null||x===void 0?void 0:x.pop())||Q;return(0,n.jsx)(vn.Z,{type:"error",title:"\u65E0\u6CD5\u9884\u89C8\u6B64\u6587\u4EF6\u7C7B\u578B",description:"\u5F53\u524D\u4E0D\u652F\u6301\u9884\u89C8\u3010".concat(k,"\u3011\u683C\u5F0F\u7684\u6587\u4EF6\u3002")})}var J=j?.content||"",de=(Q==null||(h=Q.split("/"))===null||h===void 0?void 0:h.pop())||"";return(de!=null&&de.includes(".htm")||(0,nn.gK)(de))&&Gt==="preview"&&o?(0,n.jsx)(Le.Z,{src:o,fileType:de!=null&&de.includes(".htm")?"html":"markdown"}):(0,n.jsx)(Ue.Z,{fileId:Q,fileName:de,filePath:"app/".concat(Q),content:J,readOnly:$,onContentChange:gr})},Mr=function(){var V=W()(Z()().mark(function v(){return Z()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return zt(!0),o.next=3,O?.();case 3:zt(!1);case 4:case"end":return o.stop()}},v)}));return function(){return V.apply(this,arguments)}}(),Jt=function(){var V=W()(Z()().mark(function v(h,o){return Z()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return Ut(!0),k.next=3,pe.$A===null||pe.$A===void 0?void 0:(0,pe.$A)(h,o);case 3:Ut(!1);case 4:case"end":return k.stop()}},v)}));return function(h,o){return V.apply(this,arguments)}}(),br=function(){var V=W()(Z()().mark(function v(h){return Z()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return Ht(!0),x.next=3,pe.$A===null||pe.$A===void 0?void 0:(0,pe.$A)(h,!0);case 3:Ht(!1);case 4:case"end":return x.stop()}},v)}));return function(h){return V.apply(this,arguments)}}(),Xt=function(){return(0,n.jsx)(it,{conversationId:S?.toString()||"",className:b,targetNode:j,viewMode:y,onViewModeChange:ae,onExportProject:Mr,onImportProject:ie,onRestartServer:K,isExportingProjecting:tr,onFullscreen:Pr,isFullscreen:ct,onSaveFiles:Ir,onCancelSaveFiles:Er,hasModifiedFiles:cn.length>0,isSavingFiles:er,showMoreActions:ce,viewFileType:Gt,onViewFileTypeChange:Et,onDownloadFileByUrl:Jt,isDownloadingFile:ar,isShowShare:f,onShare:Y,onExportPdf:br,isExportingPdf:lr})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Be.Z,{open:ct,onCancel:Nr,footer:null,closable:!1,mask:!1,width:"100%",style:{top:0,paddingBottom:0,maxWidth:"100%"},styles:{body:{height:"100vh",padding:0,display:"flex",flexDirection:"column"}},className:He(Oe["fullscreen-modal"]),destroyOnHidden:!1,children:(0,n.jsxs)("div",{className:He(Oe["fullscreen-container"]),children:[Xt(),(0,n.jsx)("div",{className:He(Oe["fullscreen-content"]),children:Yt()})]})}),(0,n.jsxs)("div",{className:He("flex","flex-1","overflow-hide"),children:[(0,n.jsx)(jn,{visible:In,position:st,targetNode:We,disableDelete:(We==null||(c=We.name)===null||c===void 0?void 0:c.toLowerCase())==="skill.md",onClose:Dt,onDelete:hr,onRename:vr,onUploadFiles:mr,onCreateFile:pr,onCreateFolder:xr,onImportProject:ie,onDownloadFileByUrl:Jt}),y!=="desktop"&&(0,n.jsxs)("div",{className:He(Oe["file-tree-view"],"h-full","flex","flex-col","overflow-hide"),children:[(0,n.jsx)(St,{className:b,files:L,onFileSelect:bt}),(0,n.jsx)(ge,{fileTreeDataLoading:a,files:L,taskAgentSelectedFileId:u,selectedFileId:Q,renamingNode:Pt,onCancelRename:dr,onContextMenu:cr,onFileSelect:bt,onConfirmRenameFile:fr})]}),(0,n.jsxs)("div",{className:He("h-full","flex","flex-col","flex-1","overflow-hide"),children:[Xt(),(0,n.jsx)("div",{className:He(Oe["content-container"]),children:Yt()})]})]})]})}),B=Ct},76365:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return De}});var Ie=e(90228),A=e.n(Ie),je=e(87999),Z=e.n(je),Ee=e(15558),T=e.n(Ee),he=e(48305),W=e.n(he),Ge=e(26068),m=e.n(Ge),oe=e(51664),be=e(65593),p=e(90191),nn=e(21794),pe=e(48155),Qe=e(49089),Be=e(49113),tn=e(45920),ze=e(31178),gn=e(57820),dn=e(63488),s=e(61606),vn=e(27806),Le=e(47383),yn=e(35734),Ue=e(9504),rn=e(68108),fe=e(56555),Te=e(91716),re=e(75271),fn=e(14029),M={filePreviewContainer:"filePreviewContainer___hxaGp",scrollable:"scrollable___jBXsH",placeholder:"placeholder___P9c_U",loadingOverlay:"loadingOverlay___iuka2",loadingText:"loadingText___QPWp1",errorOverlay:"errorOverlay___g0itI",unsupportedOverlay:"unsupportedOverlay___G2UDz",unsupportedText:"unsupportedText___W196l",unsupportedHint:"unsupportedHint___FBBKY",toolbar:"toolbar___wN9i4",toolbarBtn:"toolbarBtn___o5hBU",previewContent:"previewContent___gl2ub",imagePreview:"imagePreview___gu1f3",previewImage:"previewImage___yarh7",imageNavBtn:"imageNavBtn___kZV5H",imageNavRight:"imageNavRight___MC8PL",imageCounter:"imageCounter___FhYYO",audioPreview:"audioPreview___wHbNX",audioPlayer:"audioPlayer___cQ8c4",videoPreview:"videoPreview___zIQhA",videoPlayer:"videoPlayer___u8irE",htmlPreview:"htmlPreview___mPVVK",htmlFrame:"htmlFrame___I8zR7",markdownPreview:"markdownPreview___W_7cH",textPreview:"textPreview___a7yRE",codeBlock:"codeBlock___fFDBb"},Ye=e(26042),$n=e(47470),Re=e(95326),n=e(14550),Fn=e(555),jn=e(99033),l=e(52676),Ve={docx:"docx",doc:"docx",xlsx:"xlsx",xls:"xlsx",pptx:"pptx",ppt:"pptx",pdf:"pdf",jpg:"image",jpeg:"image",png:"image",gif:"image",webp:"image",svg:"image",bmp:"image",ico:"image",mp3:"audio",wav:"audio",ogg:"audio",m4a:"audio",aac:"audio",flac:"audio",mp4:"video",webm:"video",mov:"video",avi:"video",mkv:"video",html:"html",htm:"html",md:"markdown",markdown:"markdown",txt:"text",json:"text",xml:"text",js:"text",jsx:"text",ts:"text",tsx:"text",css:"text",less:"text",scss:"text",sass:"text",yaml:"text",yml:"text",ini:"text",conf:"text",sh:"text",bash:"text",py:"text",java:"text",c:"text",cpp:"text",h:"text",go:"text",rs:"text",rb:"text",php:"text",sql:"text",log:"text",csv:"text"},Sn={"image/jpeg":"image","image/png":"image","image/gif":"image","image/webp":"image","image/svg+xml":"image","image/bmp":"image","audio/mpeg":"audio","audio/wav":"audio","audio/ogg":"audio","audio/mp4":"audio","audio/aac":"audio","video/mp4":"video","video/webm":"video","video/quicktime":"video","text/html":"html","application/pdf":"pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","text/plain":"text","text/markdown":"markdown","application/json":"text","application/xml":"text"},mn=function(I){var d,g=I.split("?")[0].split("#")[0],qe=((d=g.split(".").pop())===null||d===void 0?void 0:d.toLowerCase())||"";return Ve[qe]||"unsupported"},Mn=function(I){var d,g=I.split("?")[0].split("#")[0];return((d=g.split(".").pop())===null||d===void 0?void 0:d.toLowerCase())||""},hn=function(I){var d=I.split(";")[0].trim().toLowerCase();return Sn[d]||"unsupported"},xe=function(I){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:48,g={fontSize:d,marginBottom:16};switch(I){case"docx":return(0,l.jsx)(oe.Z,{style:m()(m()({},g),{},{color:"#2b579a"})});case"xlsx":return(0,l.jsx)(be.Z,{style:m()(m()({},g),{},{color:"#217346"})});case"pptx":return(0,l.jsx)(p.Z,{style:m()(m()({},g),{},{color:"#d24726"})});case"pdf":return(0,l.jsx)(nn.Z,{style:m()(m()({},g),{},{color:"#ff4d4f"})});case"image":return(0,l.jsx)(pe.Z,{style:m()(m()({},g),{},{color:"#1890ff"})});case"audio":return(0,l.jsx)(Qe.Z,{style:m()(m()({},g),{},{color:"#722ed1"})});case"video":return(0,l.jsx)(Be.Z,{style:m()(m()({},g),{},{color:"#eb2f96"})});case"html":return(0,l.jsx)(tn.Z,{style:m()(m()({},g),{},{color:"#e34c26"})});case"markdown":return(0,l.jsx)(ze.Z,{style:m()(m()({},g),{},{color:"#083fa1"})});case"text":return(0,l.jsx)(gn.Z,{style:m()(m()({},g),{},{color:"#52c41a"})});default:return(0,l.jsx)(dn.Z,{style:m()(m()({},g),{},{color:"#bfbfbf"})})}},ke=function(I){return typeof I=="string"?I:I instanceof File||I instanceof Blob?URL.createObjectURL(I):URL.createObjectURL(new Blob([I]))},Je=function(I,d){var g=I?.toLowerCase()||"";if(g.includes("central directory")||g.includes("zip file")||g.includes("jszip"))return"\u6587\u4EF6\u683C\u5F0F\u65E0\u6548\u6216\u5DF2\u635F\u574F\uFF0C\u8BF7\u786E\u8BA4\u662F\u5426\u4E3A\u6709\u6548\u7684 PPTX \u6587\u4EF6";if(g.includes("network")||g.includes("fetch")||g.includes("failed to fetch"))return"\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u540E\u91CD\u8BD5";if(g.includes("load")||g.includes("loading"))return"\u6587\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5";if(g.includes("parse")||g.includes("parsing"))return"\u6587\u4EF6\u89E3\u6790\u5931\u8D25\uFF0C\u6587\u4EF6\u53EF\u80FD\u5DF2\u635F\u574F\u6216\u683C\u5F0F\u4E0D\u652F\u6301";switch(d){case"docx":return"\u6587\u6863\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"xlsx":return"\u8868\u683C\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"pdf":return"PDF \u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"pptx":return"\u6F14\u793A\u6587\u7A3F\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"image":return"\u56FE\u7247\u52A0\u8F7D\u5931\u8D25";default:return"\u6587\u4EF6\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}},Xe=function(I){var d=I.src,g=I.srcList,qe=I.fileType,Kn=I.height,Cn=Kn===void 0?"100%":Kn,vt=I.width,ee=vt===void 0?"100%":vt,Gn=I.showDownload,bn=Gn===void 0?!1:Gn,Qn=I.showRefresh,Yn=Qn===void 0?!1:Qn,wn=I.downloadFileName,ne=I.onRendered,Se=I.onError,Jn=I.className,ft=I.style,Ce=(0,re.useRef)(null),_e=(0,re.useRef)(null),mt=(0,re.useState)("idle"),Xn=W()(mt,2),me=Xn[0],le=Xn[1],qn=(0,re.useState)(""),Dn=W()(qn,2),_n=Dn[0],ln=Dn[1],ht=(0,re.useState)(),et=W()(ht,2),pt=et[0],nt=et[1],xt=(0,re.useState)(""),Pn=W()(xt,2),Zn=Pn[0],Tn=Pn[1],gt=(0,re.useState)(null),Rn=W()(gt,2),tt=Rn[0],rt=Rn[1],yt=(0,re.useState)(0),at=W()(yt,2),it=at[0],lt=at[1],kn=(0,re.useState)([]),se=W()(kn,2),Nn=se[0],Ft=se[1],ge=qe||pt,Oe=(0,re.useMemo)(function(){if(wn)return wn;if(typeof d=="string"){var B=d.split("/");return B[B.length-1].split("?")[0]||"download"}return d instanceof File?d.name:"download"},[d,wn]);(0,re.useEffect)(function(){return function(){Nn.forEach(function(B){return URL.revokeObjectURL(B)})}},[Nn]);var on=(0,re.useMemo)(function(){return g&&g.length>0?g.map(function(B){if(typeof B=="string")return B;var i=URL.createObjectURL(B);return Ft(function(t){return[].concat(T()(t),[i])}),i}):d&&ge==="image"?[ke(d)]:[]},[g,d,ge]),ot=(0,re.useCallback)(function(){if(d){var B=ke(d),i=document.createElement("a");i.href=B,i.download=Oe,document.body.appendChild(i),i.click(),document.body.removeChild(i),typeof d!="string"&&URL.revokeObjectURL(B)}},[d,Oe]),On=function(){var B=Z()(A()().mark(function i(){var t,c,b,u,C,a,P,$,S,y,w,O,H,z,X;return A()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(!Ce.current||!d&&!(g!=null&&g.length))){r.next=2;break}return r.abrupt("return");case 2:if(!(g&&g.length>0)){r.next=7;break}return nt("image"),le("success"),ne?.(),r.abrupt("return");case 7:if(d){r.next=9;break}return r.abrupt("return");case 9:if(t=qe||"unsupported",qe){r.next=28;break}if(typeof d!="string"){r.next=27;break}if(t=mn(d),t!=="unsupported"){r.next=25;break}return r.prev=14,r.next=17,fetch(d,{method:"HEAD"});case 17:c=r.sent,b=c.headers.get("Content-Type"),b&&(t=hn(b)),r.next=25;break;case 22:r.prev=22,r.t0=r.catch(14),console.warn("Failed to detect Content-Type:",r.t0);case 25:r.next=28;break;case 27:d instanceof File?(t=mn(d.name),t==="unsupported"&&d.type&&(t=hn(d.type))):d instanceof Blob&&d.type&&(t=hn(d.type));case 28:if(nt(t),t!=="unsupported"){r.next=32;break}return le("unsupported"),r.abrupt("return");case 32:if(!["image","audio","video"].includes(t)){r.next=36;break}return le("success"),ne?.(),r.abrupt("return");case 36:if(!["markdown","text"].includes(t)){r.next=66;break}if(le("loading"),r.prev=38,typeof d!="string"){r.next=48;break}return r.next=42,fetch(d);case 42:return C=r.sent,r.next=45,C.text();case 45:u=r.sent,r.next=55;break;case 48:if(!(d instanceof File||d instanceof Blob)){r.next=54;break}return r.next=51,d.text();case 51:u=r.sent,r.next=55;break;case 54:u=new TextDecoder().decode(d);case 55:Tn(u),le("success"),ne?.(),r.next=65;break;case 60:r.prev=60,r.t1=r.catch(38),le("error"),ln("\u6587\u4EF6\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),Se?.(r.t1);case 65:return r.abrupt("return");case 66:if(t!=="html"){r.next=95;break}if(typeof d!="string"){r.next=74;break}rt(d),Tn(""),le("success"),ne?.(),r.next=94;break;case 74:if(le("loading"),rt(null),r.prev=76,!(d instanceof File||d instanceof Blob)){r.next=83;break}return r.next=80,d.text();case 80:a=r.sent,r.next=84;break;case 83:a=new TextDecoder().decode(d);case 84:Tn(a),le("success"),ne?.(),r.next=94;break;case 89:r.prev=89,r.t2=r.catch(76),le("error"),ln("HTML \u5185\u5BB9\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),Se?.(r.t2);case 94:return r.abrupt("return");case 95:if(le("loading"),ln(""),_e.current){try{(P=($=_e.current).destroy)===null||P===void 0||P.call($)}catch{}_e.current=null}if(Ce.current.innerHTML="",r.prev=99,y=d,!(d instanceof File)){r.next=105;break}return r.next=104,d.arrayBuffer();case 104:y=r.sent;case 105:r.t3=t,r.next=r.t3==="docx"?108:r.t3==="xlsx"?112:r.t3==="pdf"?116:r.t3==="pptx"?120:134;break;case 108:return S=Ye.Z.init(Ce.current),r.next=111,S.preview(y);case 111:return r.abrupt("break",134);case 112:return S=Re.Z.init(Ce.current),r.next=115,S.preview(y);case 115:return r.abrupt("break",134);case 116:return S=Fn.Z.init(Ce.current,{width:Ce.current.clientWidth||void 0,onError:function(K){le("error"),ln(Je(K?.message,"pdf")),Se?.(K)},onRendered:function(){le("success"),ne?.()}}),r.next=119,S.preview(y);case 119:return r.abrupt("break",134);case 120:if(w=Ce.current.parentElement,O=Ce.current.clientWidth||w?.clientWidth||(typeof ee=="number"?ee:800),H=Ce.current.clientHeight||w?.clientHeight||(typeof Cn=="number"?Cn:600),S=(0,jn.S)(Ce.current,{width:O,height:H}),typeof y!="string"){r.next=131;break}return r.next=127,fetch(y);case 127:return z=r.sent,r.next=130,z.arrayBuffer();case 130:y=r.sent;case 131:return r.next=133,S.preview(y);case 133:return r.abrupt("break",134);case 134:_e.current=S,t!=="pdf"&&(le("success"),ne?.()),r.next=145;break;case 138:r.prev=138,r.t4=r.catch(99),console.error("File preview error:",r.t4),le("error"),X=Je(r.t4===null||r.t4===void 0?void 0:r.t4.message,t),ln(X),Se?.(r.t4);case 145:case"end":return r.stop()}},i,null,[[14,22],[38,60],[76,89],[99,138]])}));return function(){return B.apply(this,arguments)}}();(0,re.useEffect)(function(){return d||g!=null&&g.length?On():le("idle"),function(){if(_e.current){try{var B,i;(B=(i=_e.current).destroy)===null||B===void 0||B.call(i)}catch{}_e.current=null}}},[d,g,qe]);var An=(0,re.useRef)(null);(0,re.useEffect)(function(){if(Ce.current){var B=null,i=new ResizeObserver(function(c){var b=c[0];if(b){var u=b.contentRect,C=u.width,a=u.height,P=An.current;P&&Math.abs(P.width-C)<10&&Math.abs(P.height-a)<10||(B&&clearTimeout(B),B=setTimeout(function(){me==="success"&&ge&&["pptx","xlsx"].includes(ge)&&(An.current={width:C,height:a},On())},500))}}),t=Ce.current.parentElement;return t&&(An.current={width:t.clientWidth,height:t.clientHeight},i.observe(t)),function(){B&&clearTimeout(B),i.disconnect()}}},[me,ge]);var we=function(){On()},Ae=function(){lt(function(i){return i>0?i-1:on.length-1})},jt=function(){lt(function(i){return i<on.length-1?i+1:0})},St=function(){if(!ge)return null;switch(ge){case"image":return(0,l.jsxs)("div",{className:M.imagePreview,children:[on.length>1&&(0,l.jsx)(Ue.ZP,{className:M.imageNavBtn,icon:(0,l.jsx)(s.Z,{}),onClick:Ae}),(0,l.jsx)("img",{src:on[it],alt:"preview",className:M.previewImage,onError:function(){le("error"),ln("\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u662F\u5426\u6709\u6548")}}),on.length>1&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Ue.ZP,{className:"".concat(M.imageNavBtn," ").concat(M.imageNavRight),icon:(0,l.jsx)(vn.Z,{}),onClick:jt}),(0,l.jsxs)("div",{className:M.imageCounter,children:[it+1," / ",on.length]})]})]});case"audio":return(0,l.jsxs)("div",{className:M.audioPreview,children:[xe("audio",64),(0,l.jsx)("audio",{controls:!0,className:M.audioPlayer,children:(0,l.jsx)("source",{src:ke(d)})})]});case"video":return(0,l.jsx)("div",{className:M.videoPreview,children:(0,l.jsx)("video",{controls:!0,className:M.videoPlayer,children:(0,l.jsx)("source",{src:ke(d)})})});case"html":return(0,l.jsx)("div",{className:M.htmlPreview,children:(0,l.jsx)("iframe",{src:tt||void 0,srcDoc:tt?void 0:Zn,sandbox:"allow-scripts allow-same-origin allow-forms",className:M.htmlFrame,title:"HTML Preview"})});case"markdown":return(0,l.jsx)("div",{className:M.markdownPreview,children:(0,l.jsx)(fn.UG,{children:Zn})});case"text":return(0,l.jsx)("div",{className:M.textPreview,children:(0,l.jsx)("pre",{className:M.codeBlock,children:(0,l.jsx)("code",{children:Zn})})});default:return null}},He=["docx","pdf","pptx"].includes(ge||""),Ct=["docx","xlsx","pdf","pptx"].includes(ge||"");return(0,l.jsxs)("div",{className:"".concat(M.filePreviewContainer," ").concat(He?M.scrollable:""," ").concat(Jn||""),style:m()({width:ee,height:Cn},ft),children:[(Yn||bn)&&d&&me==="success"&&(0,l.jsxs)("div",{className:M.toolbar,children:[Yn&&(0,l.jsx)(rn.Z,{title:"\u5237\u65B0",children:(0,l.jsx)(Ue.ZP,{className:M.toolbarBtn,icon:(0,l.jsx)(Le.Z,{}),onClick:we,type:"text"})}),bn&&(0,l.jsx)(rn.Z,{title:"\u4E0B\u8F7D",children:(0,l.jsx)(Ue.ZP,{className:M.toolbarBtn,icon:(0,l.jsx)(yn.Z,{}),onClick:ot,type:"text"})})]}),me==="idle"&&!d&&!(g!=null&&g.length)&&(0,l.jsxs)("div",{className:M.placeholder,children:[(0,l.jsx)(dn.Z,{style:{fontSize:48,color:"#bfbfbf",marginBottom:16}}),(0,l.jsx)("p",{children:"\u6682\u65E0\u6587\u4EF6\u53EF\u9884\u89C8"})]}),me==="loading"&&(0,l.jsxs)("div",{className:M.loadingOverlay,children:[ge&&xe(ge),(0,l.jsx)(fe.Z,{size:"large"}),(0,l.jsx)("span",{className:M.loadingText,children:"\u6B63\u5728\u52A0\u8F7D\u9884\u89C8..."})]}),me==="error"&&(0,l.jsx)("div",{className:M.errorOverlay,children:(0,l.jsx)(Te.Z,{message:"\u9884\u89C8\u5931\u8D25",description:_n||"\u65E0\u6CD5\u9884\u89C8\u6B64\u6587\u4EF6",type:"error",showIcon:!0,action:(0,l.jsx)(Ue.ZP,{size:"small",type:"primary",icon:(0,l.jsx)(Le.Z,{}),onClick:we,children:"\u91CD\u8BD5"})})}),me==="unsupported"&&(0,l.jsxs)("div",{className:M.unsupportedOverlay,children:[xe("unsupported",64),(0,l.jsx)("p",{className:M.unsupportedText,children:"\u6682\u4E0D\u652F\u6301\u9884\u89C8\u6B64\u6587\u4EF6\u7C7B\u578B"}),(0,l.jsxs)("p",{className:M.unsupportedHint,children:["\u6587\u4EF6\u7C7B\u578B: .",Mn(Oe)]}),bn&&(0,l.jsx)(Ue.ZP,{type:"primary",icon:(0,l.jsx)(yn.Z,{}),onClick:ot,children:"\u4E0B\u8F7D\u6587\u4EF6"})]}),me==="success"&&["image","audio","video","html","markdown","text"].includes(ge||"")&&St(),(0,l.jsx)("div",{ref:Ce,className:M.previewContent,style:{height:Cn,width:ee,visibility:me==="success"?"visible":"hidden",display:Ct?"block":"none",overflow:ge==="xlsx"?"hidden":"auto"}})]})},De=Xe},25318:function(xn,Ne,e){"use strict";e.d(Ne,{Z:function(){return pe}});var Ie=e(48305),A=e.n(Ie),je=e(62549),Z=e(66701),Ee=e(47383),T=e(12758),he=e(9504),W=e(68108),Ge=e(56555),m=e(91716),oe=e(75271),be={vncPreviewContainer:"vncPreviewContainer___rLF9M",controlsBar:"controlsBar___x9VWR",statusArea:"statusArea___scBVs",actionsArea:"actionsArea___FnSn7",iframeContainer:"iframeContainer___asK55",loadingOverlay:"loadingOverlay___CfTG7",loadingText:"loadingText___R1RK4",errorOverlay:"errorOverlay___HUrSY"},p=e(52676),nn=function(Be){var tn=Be.serviceUrl,ze=Be.cId,gn=Be.readOnly,dn=gn===void 0?!1:gn,s=Be.autoConnect,vn=s===void 0?!1:s,Le=Be.style,yn=Be.className,Ue=(0,oe.useState)("disconnected"),rn=A()(Ue,2),fe=rn[0],Te=rn[1],re=(0,oe.useState)(""),fn=A()(re,2),M=fn[0],Ye=fn[1],$n=(0,oe.useState)(null),Re=A()($n,2),n=Re[0],Fn=Re[1],jn=(0,oe.useRef)(null),l=function(){if(!ze)return Ye("Missing required configuration (Service URL or Container ID)"),null;var ke=tn?.replace(/\/+$/,""),Je=new URLSearchParams;return Je.set("resize","scale"),Je.set("autoconnect","true"),dn&&Je.set("view_only","true"),"".concat(ke,"/computer/desktop/").concat(ze,"/vnc.html?").concat(Je.toString())},Ve=function(){var ke=l();if(!ke){Te("error");return}Te("connecting"),Ye(""),Fn(ke)},Sn=function(){Te("disconnected"),Fn(null),Ye("")};(0,oe.useEffect)(function(){vn&&Ve()},[vn]),(0,oe.useEffect)(function(){(fe==="connected"||fe==="connecting")&&Ve()},[tn,ze,dn]);var mn=function(){fe==="connecting"&&Te("connected")},Mn=function(){Te("error"),Ye("Failed to load VNC client.")};(0,oe.useEffect)(function(){var xe;return fe==="connecting"&&(xe=setTimeout(function(){jn.current&&Te("connected")},5e3)),function(){xe&&clearTimeout(xe)}},[fe]);var hn=function(){switch(fe){case"connected":return(0,p.jsx)(T.Z,{color:"#52c41a",children:"Connected"});case"connecting":return(0,p.jsx)(T.Z,{color:"#1890ff",children:"Connecting..."});case"disconnected":return(0,p.jsx)(T.Z,{children:"Disconnected"});case"error":return(0,p.jsx)(T.Z,{color:"#ff4d4f",children:"Error"});default:return null}};return(0,p.jsxs)("div",{className:"".concat(be.vncPreviewContainer," ").concat(yn||""),style:Le,children:[(0,p.jsxs)("div",{className:be.controlsBar,children:[(0,p.jsxs)("div",{className:be.statusArea,children:[(0,p.jsx)(je.Z,{}),(0,p.jsx)("span",{style:{fontWeight:500},children:"Remote Desktop"}),hn()]}),(0,p.jsx)("div",{className:be.actionsArea,children:fe==="disconnected"||fe==="error"?(0,p.jsx)(he.ZP,{type:"primary",icon:(0,p.jsx)(Z.Z,{}),onClick:Ve,size:"small",children:"Connect"}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(he.ZP,{danger:!0,icon:(0,p.jsx)(Z.Z,{}),onClick:Sn,size:"small",children:"Disconnect"}),(0,p.jsx)(W.Z,{title:"Reconnect",children:(0,p.jsx)(he.ZP,{icon:(0,p.jsx)(Ee.Z,{}),onClick:function(){Sn(),setTimeout(Ve,100)},size:"small"})})]})})]}),(0,p.jsxs)("div",{className:be.iframeContainer,children:[fe==="disconnected"&&(0,p.jsxs)("div",{style:{color:"#999",flexDirection:"column",display:"flex",alignItems:"center"},children:[(0,p.jsx)(je.Z,{style:{fontSize:48,marginBottom:16}}),(0,p.jsx)("p",{children:"Ready to connect"})]}),fe==="connecting"?(0,p.jsxs)("div",{className:be.loadingOverlay,children:[(0,p.jsx)(Ge.Z,{size:"large"}),(0,p.jsx)("span",{className:be.loadingText,children:"Connecting to remote session..."})]}):null,fe==="error"&&(0,p.jsx)("div",{className:be.errorOverlay,children:(0,p.jsx)(m.Z,{message:"Connection Error",description:M||"Unable to establish connection.",type:"error",showIcon:!0,action:(0,p.jsx)(he.ZP,{size:"small",type:"primary",onClick:Ve,children:"Retry"})})}),n&&(0,p.jsx)("iframe",{ref:jn,src:n,title:"VNC Preview",scrolling:"no",onLoad:mn,onError:Mn,style:{display:fe==="disconnected"?"none":"block"}})]})]})},pe=nn},84232:function(){},14050:function(){}}]);})();
