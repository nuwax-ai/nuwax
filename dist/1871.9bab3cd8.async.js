(()=>{(self.webpackChunknuwax_frontend=self.webpackChunknuwax_frontend||[]).push([[1871],{76365:function(jr,Fe,n){"use strict";n.d(Fe,{Z:function(){return ar}});var Te=n(90228),Y=n.n(Te),Se=n(87999),Ee=n.n(Se),Re=n(15558),Be=n.n(Re),Oe=n(48305),w=n.n(Oe),Ze=n(26068),d=n.n(Ze),ke=n(51664),Le=n(65593),De=n(90191),Ue=n(21794),Ie=n(48155),ze=n(49089),He=n(49113),Me=n(45920),Ae=n(31178),We=n(57820),Q=n(63488),$e=n(61606),Ge=n(27806),V=n(47383),K=n(35734),C=n(9504),J=n(68108),Xe=n(56555),Ye=n(91716),m=n(75271),Qe=n(14029),s={filePreviewContainer:"filePreviewContainer___hxaGp",scrollable:"scrollable___jBXsH",placeholder:"placeholder___P9c_U",loadingOverlay:"loadingOverlay___iuka2",loadingText:"loadingText___QPWp1",errorOverlay:"errorOverlay___g0itI",unsupportedOverlay:"unsupportedOverlay___G2UDz",unsupportedText:"unsupportedText___W196l",unsupportedHint:"unsupportedHint___FBBKY",toolbar:"toolbar___wN9i4",toolbarBtn:"toolbarBtn___o5hBU",previewContent:"previewContent___gl2ub",imagePreview:"imagePreview___gu1f3",previewImage:"previewImage___yarh7",imageNavBtn:"imageNavBtn___kZV5H",imageNavRight:"imageNavRight___MC8PL",imageCounter:"imageCounter___FhYYO",audioPreview:"audioPreview___wHbNX",audioPlayer:"audioPlayer___cQ8c4",videoPreview:"videoPreview___zIQhA",videoPlayer:"videoPlayer___u8irE",htmlPreview:"htmlPreview___mPVVK",htmlFrame:"htmlFrame___I8zR7",markdownPreview:"markdownPreview___W_7cH",textPreview:"textPreview___a7yRE",codeBlock:"codeBlock___fFDBb"},Ve=n(26042),br=n(47470),Ke=n(95326),Pr=n(14550),Je=n(555),qe=n(99033),t=n(52676),_e={docx:"docx",doc:"docx",xlsx:"xlsx",xls:"xlsx",pptx:"pptx",ppt:"pptx",pdf:"pdf",jpg:"image",jpeg:"image",png:"image",gif:"image",webp:"image",svg:"image",bmp:"image",ico:"image",mp3:"audio",wav:"audio",ogg:"audio",m4a:"audio",aac:"audio",flac:"audio",mp4:"video",webm:"video",mov:"video",avi:"video",mkv:"video",html:"html",htm:"html",md:"markdown",markdown:"markdown",txt:"text",json:"text",xml:"text",js:"text",jsx:"text",ts:"text",tsx:"text",css:"text",less:"text",scss:"text",sass:"text",yaml:"text",yml:"text",ini:"text",conf:"text",sh:"text",bash:"text",py:"text",java:"text",c:"text",cpp:"text",h:"text",go:"text",rs:"text",rb:"text",php:"text",sql:"text",log:"text",csv:"text"},er={"image/jpeg":"image","image/png":"image","image/gif":"image","image/webp":"image","image/svg+xml":"image","image/bmp":"image","audio/mpeg":"audio","audio/wav":"audio","audio/ogg":"audio","audio/mp4":"audio","audio/aac":"audio","video/mp4":"video","video/webm":"video","video/quicktime":"video","text/html":"html","application/pdf":"pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","text/plain":"text","text/markdown":"markdown","application/json":"text","application/xml":"text"},q=function(i){var r,a=i.split("?")[0].split("#")[0],T=((r=a.split(".").pop())===null||r===void 0?void 0:r.toLowerCase())||"";return _e[T]||"unsupported"},rr=function(i){var r,a=i.split("?")[0].split("#")[0];return((r=a.split(".").pop())===null||r===void 0?void 0:r.toLowerCase())||""},I=function(i){var r=i.split(";")[0].trim().toLowerCase();return er[r]||"unsupported"},z=function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:48,a={fontSize:r,marginBottom:16};switch(i){case"docx":return(0,t.jsx)(ke.Z,{style:d()(d()({},a),{},{color:"#2b579a"})});case"xlsx":return(0,t.jsx)(Le.Z,{style:d()(d()({},a),{},{color:"#217346"})});case"pptx":return(0,t.jsx)(De.Z,{style:d()(d()({},a),{},{color:"#d24726"})});case"pdf":return(0,t.jsx)(Ue.Z,{style:d()(d()({},a),{},{color:"#ff4d4f"})});case"image":return(0,t.jsx)(Ie.Z,{style:d()(d()({},a),{},{color:"#1890ff"})});case"audio":return(0,t.jsx)(ze.Z,{style:d()(d()({},a),{},{color:"#722ed1"})});case"video":return(0,t.jsx)(He.Z,{style:d()(d()({},a),{},{color:"#eb2f96"})});case"html":return(0,t.jsx)(Me.Z,{style:d()(d()({},a),{},{color:"#e34c26"})});case"markdown":return(0,t.jsx)(Ae.Z,{style:d()(d()({},a),{},{color:"#083fa1"})});case"text":return(0,t.jsx)(We.Z,{style:d()(d()({},a),{},{color:"#52c41a"})});default:return(0,t.jsx)(Q.Z,{style:d()(d()({},a),{},{color:"#bfbfbf"})})}},Z=function(i){return typeof i=="string"?i:i instanceof File||i instanceof Blob?URL.createObjectURL(i):URL.createObjectURL(new Blob([i]))},_=function(i,r){var a=i?.toLowerCase()||"";if(a.includes("central directory")||a.includes("zip file")||a.includes("jszip"))return"\u6587\u4EF6\u683C\u5F0F\u65E0\u6548\u6216\u5DF2\u635F\u574F\uFF0C\u8BF7\u786E\u8BA4\u662F\u5426\u4E3A\u6709\u6548\u7684 PPTX \u6587\u4EF6";if(a.includes("network")||a.includes("fetch")||a.includes("failed to fetch"))return"\u7F51\u7EDC\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u540E\u91CD\u8BD5";if(a.includes("load")||a.includes("loading"))return"\u6587\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5";if(a.includes("parse")||a.includes("parsing"))return"\u6587\u4EF6\u89E3\u6790\u5931\u8D25\uFF0C\u6587\u4EF6\u53EF\u80FD\u5DF2\u635F\u574F\u6216\u683C\u5F0F\u4E0D\u652F\u6301";switch(r){case"docx":return"\u6587\u6863\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"xlsx":return"\u8868\u683C\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"pdf":return"PDF \u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"pptx":return"\u6F14\u793A\u6587\u7A3F\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4\u6587\u4EF6\u683C\u5F0F\u6B63\u786E";case"image":return"\u56FE\u7247\u52A0\u8F7D\u5931\u8D25";default:return"\u6587\u4EF6\u9884\u89C8\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}},tr=function(i){var r=i.src,a=i.srcList,T=i.fileType,ee=i.height,k=ee===void 0?"100%":ee,re=i.width,L=re===void 0?"100%":re,te=i.showDownload,H=te===void 0?!1:te,ae=i.showRefresh,ne=ae===void 0?!1:ae,M=i.downloadFileName,c=i.onRendered,h=i.onError,nr=i.className,ir=i.style,p=(0,m.useRef)(null),j=(0,m.useRef)(null),sr=(0,m.useState)("idle"),ie=w()(sr,2),g=ie[0],v=ie[1],lr=(0,m.useState)(""),se=w()(lr,2),or=se[0],S=se[1],ur=(0,m.useState)(),le=w()(ur,2),dr=le[0],oe=le[1],cr=(0,m.useState)(""),ue=w()(cr,2),A=ue[0],W=ue[1],vr=(0,m.useState)(null),de=w()(vr,2),ce=de[0],ve=de[1],mr=(0,m.useState)(0),me=w()(mr,2),pe=me[0],fe=me[1],pr=(0,m.useState)([]),he=w()(pr,2),ge=he[0],fr=he[1],f=T||dr,$=(0,m.useMemo)(function(){if(M)return M;if(typeof r=="string"){var l=r.split("/");return l[l.length-1].split("?")[0]||"download"}return r instanceof File?r.name:"download"},[r,M]);(0,m.useEffect)(function(){return function(){ge.forEach(function(l){return URL.revokeObjectURL(l)})}},[ge]);var E=(0,m.useMemo)(function(){return a&&a.length>0?a.map(function(l){if(typeof l=="string")return l;var o=URL.createObjectURL(l);return fr(function(u){return[].concat(Be()(u),[o])}),o}):r&&f==="image"?[Z(r)]:[]},[a,r,f]),xe=(0,m.useCallback)(function(){if(r){var l=Z(r),o=document.createElement("a");o.href=l,o.download=$,document.body.appendChild(o),o.click(),document.body.removeChild(o),typeof r!="string"&&URL.revokeObjectURL(l)}},[r,$]),G=function(){var l=Ee()(Y()().mark(function o(){var u,D,R,b,O,B,P,we,x,y,N,je,be,Pe,Ne;return Y()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!p.current||!r&&!(a!=null&&a.length))){e.next=2;break}return e.abrupt("return");case 2:if(!(a&&a.length>0)){e.next=7;break}return oe("image"),v("success"),c?.(),e.abrupt("return");case 7:if(r){e.next=9;break}return e.abrupt("return");case 9:if(u=T||"unsupported",T){e.next=28;break}if(typeof r!="string"){e.next=27;break}if(u=q(r),u!=="unsupported"){e.next=25;break}return e.prev=14,e.next=17,fetch(r,{method:"HEAD"});case 17:D=e.sent,R=D.headers.get("Content-Type"),R&&(u=I(R)),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(14),console.warn("Failed to detect Content-Type:",e.t0);case 25:e.next=28;break;case 27:r instanceof File?(u=q(r.name),u==="unsupported"&&r.type&&(u=I(r.type))):r instanceof Blob&&r.type&&(u=I(r.type));case 28:if(oe(u),u!=="unsupported"){e.next=32;break}return v("unsupported"),e.abrupt("return");case 32:if(!["image","audio","video"].includes(u)){e.next=36;break}return v("success"),c?.(),e.abrupt("return");case 36:if(!["markdown","text"].includes(u)){e.next=66;break}if(v("loading"),e.prev=38,typeof r!="string"){e.next=48;break}return e.next=42,fetch(r);case 42:return O=e.sent,e.next=45,O.text();case 45:b=e.sent,e.next=55;break;case 48:if(!(r instanceof File||r instanceof Blob)){e.next=54;break}return e.next=51,r.text();case 51:b=e.sent,e.next=55;break;case 54:b=new TextDecoder().decode(r);case 55:W(b),v("success"),c?.(),e.next=65;break;case 60:e.prev=60,e.t1=e.catch(38),v("error"),S("\u6587\u4EF6\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),h?.(e.t1);case 65:return e.abrupt("return");case 66:if(u!=="html"){e.next=95;break}if(typeof r!="string"){e.next=74;break}ve(r),W(""),v("success"),c?.(),e.next=94;break;case 74:if(v("loading"),ve(null),e.prev=76,!(r instanceof File||r instanceof Blob)){e.next=83;break}return e.next=80,r.text();case 80:B=e.sent,e.next=84;break;case 83:B=new TextDecoder().decode(r);case 84:W(B),v("success"),c?.(),e.next=94;break;case 89:e.prev=89,e.t2=e.catch(76),v("error"),S("HTML \u5185\u5BB9\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),h?.(e.t2);case 94:return e.abrupt("return");case 95:if(v("loading"),S(""),j.current){try{(P=(we=j.current).destroy)===null||P===void 0||P.call(we)}catch{}j.current=null}if(p.current.innerHTML="",e.prev=99,y=r,!(r instanceof File)){e.next=105;break}return e.next=104,r.arrayBuffer();case 104:y=e.sent;case 105:e.t3=u,e.next=e.t3==="docx"?108:e.t3==="xlsx"?112:e.t3==="pdf"?116:e.t3==="pptx"?120:134;break;case 108:return x=Ve.Z.init(p.current),e.next=111,x.preview(y);case 111:return e.abrupt("break",134);case 112:return x=Ke.Z.init(p.current),e.next=115,x.preview(y);case 115:return e.abrupt("break",134);case 116:return x=Je.Z.init(p.current,{width:p.current.clientWidth||void 0,onError:function(U){v("error"),S(_(U?.message,"pdf")),h?.(U)},onRendered:function(){v("success"),c?.()}}),e.next=119,x.preview(y);case 119:return e.abrupt("break",134);case 120:if(N=p.current.parentElement,je=p.current.clientWidth||N?.clientWidth||(typeof L=="number"?L:800),be=p.current.clientHeight||N?.clientHeight||(typeof k=="number"?k:600),x=(0,qe.S)(p.current,{width:je,height:be}),typeof y!="string"){e.next=131;break}return e.next=127,fetch(y);case 127:return Pe=e.sent,e.next=130,Pe.arrayBuffer();case 130:y=e.sent;case 131:return e.next=133,x.preview(y);case 133:return e.abrupt("break",134);case 134:j.current=x,u!=="pdf"&&(v("success"),c?.()),e.next=145;break;case 138:e.prev=138,e.t4=e.catch(99),console.error("File preview error:",e.t4),v("error"),Ne=_(e.t4===null||e.t4===void 0?void 0:e.t4.message,u),S(Ne),h?.(e.t4);case 145:case"end":return e.stop()}},o,null,[[14,22],[38,60],[76,89],[99,138]])}));return function(){return l.apply(this,arguments)}}();(0,m.useEffect)(function(){return r||a!=null&&a.length?G():v("idle"),function(){if(j.current){try{var l,o;(l=(o=j.current).destroy)===null||l===void 0||l.call(o)}catch{}j.current=null}}},[r,a,T]);var X=(0,m.useRef)(null);(0,m.useEffect)(function(){if(p.current){var l=null,o=new ResizeObserver(function(D){var R=D[0];if(R){var b=R.contentRect,O=b.width,B=b.height,P=X.current;P&&Math.abs(P.width-O)<10&&Math.abs(P.height-B)<10||(l&&clearTimeout(l),l=setTimeout(function(){g==="success"&&f&&["pptx","xlsx"].includes(f)&&(X.current={width:O,height:B},G())},500))}}),u=p.current.parentElement;return u&&(X.current={width:u.clientWidth,height:u.clientHeight},o.observe(u)),function(){l&&clearTimeout(l),o.disconnect()}}},[g,f]);var ye=function(){G()},hr=function(){fe(function(o){return o>0?o-1:E.length-1})},gr=function(){fe(function(o){return o<E.length-1?o+1:0})},xr=function(){if(!f)return null;switch(f){case"image":return(0,t.jsxs)("div",{className:s.imagePreview,children:[E.length>1&&(0,t.jsx)(C.ZP,{className:s.imageNavBtn,icon:(0,t.jsx)($e.Z,{}),onClick:hr}),(0,t.jsx)("img",{src:E[pe],alt:"preview",className:s.previewImage,onError:function(){v("error"),S("\u56FE\u7247\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u662F\u5426\u6709\u6548")}}),E.length>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.ZP,{className:"".concat(s.imageNavBtn," ").concat(s.imageNavRight),icon:(0,t.jsx)(Ge.Z,{}),onClick:gr}),(0,t.jsxs)("div",{className:s.imageCounter,children:[pe+1," / ",E.length]})]})]});case"audio":return(0,t.jsxs)("div",{className:s.audioPreview,children:[z("audio",64),(0,t.jsx)("audio",{controls:!0,className:s.audioPlayer,children:(0,t.jsx)("source",{src:Z(r)})})]});case"video":return(0,t.jsx)("div",{className:s.videoPreview,children:(0,t.jsx)("video",{controls:!0,className:s.videoPlayer,children:(0,t.jsx)("source",{src:Z(r)})})});case"html":return(0,t.jsx)("div",{className:s.htmlPreview,children:(0,t.jsx)("iframe",{src:ce||void 0,srcDoc:ce?void 0:A,sandbox:"allow-scripts allow-same-origin allow-forms",className:s.htmlFrame,title:"HTML Preview"})});case"markdown":return(0,t.jsx)("div",{className:s.markdownPreview,children:(0,t.jsx)(Qe.UG,{children:A})});case"text":return(0,t.jsx)("div",{className:s.textPreview,children:(0,t.jsx)("pre",{className:s.codeBlock,children:(0,t.jsx)("code",{children:A})})});default:return null}},yr=["docx","pdf","pptx"].includes(f||""),wr=["docx","xlsx","pdf","pptx"].includes(f||"");return(0,t.jsxs)("div",{className:"".concat(s.filePreviewContainer," ").concat(yr?s.scrollable:""," ").concat(nr||""),style:d()({width:L,height:k},ir),children:[(ne||H)&&r&&g==="success"&&(0,t.jsxs)("div",{className:s.toolbar,children:[ne&&(0,t.jsx)(J.Z,{title:"\u5237\u65B0",children:(0,t.jsx)(C.ZP,{className:s.toolbarBtn,icon:(0,t.jsx)(V.Z,{}),onClick:ye,type:"text"})}),H&&(0,t.jsx)(J.Z,{title:"\u4E0B\u8F7D",children:(0,t.jsx)(C.ZP,{className:s.toolbarBtn,icon:(0,t.jsx)(K.Z,{}),onClick:xe,type:"text"})})]}),g==="idle"&&!r&&!(a!=null&&a.length)&&(0,t.jsxs)("div",{className:s.placeholder,children:[(0,t.jsx)(Q.Z,{style:{fontSize:48,color:"#bfbfbf",marginBottom:16}}),(0,t.jsx)("p",{children:"\u6682\u65E0\u6587\u4EF6\u53EF\u9884\u89C8"})]}),g==="loading"&&(0,t.jsxs)("div",{className:s.loadingOverlay,children:[f&&z(f),(0,t.jsx)(Xe.Z,{size:"large"}),(0,t.jsx)("span",{className:s.loadingText,children:"\u6B63\u5728\u52A0\u8F7D\u9884\u89C8..."})]}),g==="error"&&(0,t.jsx)("div",{className:s.errorOverlay,children:(0,t.jsx)(Ye.Z,{message:"\u9884\u89C8\u5931\u8D25",description:or||"\u65E0\u6CD5\u9884\u89C8\u6B64\u6587\u4EF6",type:"error",showIcon:!0,action:(0,t.jsx)(C.ZP,{size:"small",type:"primary",icon:(0,t.jsx)(V.Z,{}),onClick:ye,children:"\u91CD\u8BD5"})})}),g==="unsupported"&&(0,t.jsxs)("div",{className:s.unsupportedOverlay,children:[z("unsupported",64),(0,t.jsx)("p",{className:s.unsupportedText,children:"\u6682\u4E0D\u652F\u6301\u9884\u89C8\u6B64\u6587\u4EF6\u7C7B\u578B"}),(0,t.jsxs)("p",{className:s.unsupportedHint,children:["\u6587\u4EF6\u7C7B\u578B: .",rr($)]}),H&&(0,t.jsx)(C.ZP,{type:"primary",icon:(0,t.jsx)(K.Z,{}),onClick:xe,children:"\u4E0B\u8F7D\u6587\u4EF6"})]}),g==="success"&&["image","audio","video","html","markdown","text"].includes(f||"")&&xr(),(0,t.jsx)("div",{ref:p,className:s.previewContent,style:{height:k,width:L,visibility:g==="success"?"visible":"hidden",display:wr?"block":"none",overflow:f==="xlsx"?"hidden":"auto"}})]})},ar=tr},84232:function(){},14050:function(){}}]);})();
