"use strict";(()=>{(self.webpackChunk=self.webpackChunk||[]).push([[5550],{93595:function(Oa,ee,s){s.r(ee),s.d(ee,{default:function(){return qe}});var Pe=s(15558),ae=s.n(Pe),ke=s(26068),C=s.n(ke),we=s(90228),p=s.n(we),Ne=s(87999),k=s.n(Ne),Re=s(48305),f=s.n(Re),je=s(3055),Me=s(1586),He=s(26760),$e=s(90634),Fe=s(77395),Ie=s(95967),Ze=s(38697),re=s(61265),g=s(79337),b=s(78913),D=s(64799),v=s(46),ze=s(16621),Be=s(13143),Je=s(63619),Ve=s(46219),We=s(58176),Oe=s(9504),Qe=s(7010),Ue=s(73981),te=s(17701),Ge=s(70183),Ke=s(94581),Ye=s.n(Ke),h=s(75271),E={"xagi-nav-style2":"xagi-nav-style2___mavtr",text:"text___x_LRe","page-container":"page-container___FIht4",container:"container___KApVK",header:"header___b_sUz",searchInput:"searchInput___laR_L",pluginList:"pluginList___A1zUu","list-section":"list-section___yhNEd",title:"title___vjScq",segmented:"segmented___cNYZ6",createShareButton:"createShareButton___txQtl",headerRight:"headerRight___ojI87",select:"select___qinf1"},i=s(52676),y=Ye().bind(E),ne=Je.Z.Search,$=24,Xe=(g.l$===null||g.l$===void 0?void 0:g.l$.map(function(M){return{label:M.label,value:M.key}}))||[];function qe(){var M,K,Y,xe=Ve.Z.useApp(),S=xe.message,_e=(0,h.useState)(""),se=f()(_e,2),F=se[0],I=se[1],ea=(0,h.useState)(g.eH.ALL),ue=f()(ea,2),L=ue[0],aa=ue[1],ra=(0,h.useState)(!1),le=f()(ra,2),ta=le[0],Z=le[1],na=(0,h.useState)(null),ie=f()(na,2),R=ie[0],de=ie[1],sa=(0,h.useState)(!1),oe=f()(sa,2),ua=oe[0],z=oe[1],la=(0,h.useState)(!1),ce=f()(la,2),X=ce[0],he=ce[1],ia=(0,h.useState)(null),pe=f()(ia,2),B=pe[0],J=pe[1],m=(0,h.useRef)({targetType:"",categoryCode:"",shareStatus:-1}),da=(0,h.useState)({checkTag:D.qR.Workflow,tabs:re.Ne.filter(function(t){return[D.qR.Workflow].includes(t.key)})}),ve=f()(da,2),oa=ve[0],ca=ve[1],ha=(0,h.useState)({targetType:D.qR.Workflow,type:v.Th.TEMPLATE}),fe=f()(ha,2),pa=fe[0],ge=fe[1],va=(0,h.useState)(!1),Se=f()(va,2),q=Se[0],V=Se[1],fa=(0,h.useState)({size:$,records:[],total:0,current:1,pages:0}),ye=f()(fa,2),A=ye[0],W=ye[1],ga=(0,h.useState)({current:1,pageSize:$}),me=f()(ga,2),H=me[0],Te=me[1],Sa=(0,h.useCallback)(k()(p()().mark(function t(){var e,r,n,u,a,T,o,l,w,N,j,x,d,De,Le,_=arguments;return p()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=_.length>0&&_[0]!==void 0?_[0]:{},r=e.tabType,n=e.keyword,u=n===void 0?"":n,a=e.page,T=a===void 0?1:a,o=e.pageSize,l=o===void 0?$:o,V(!0),c.prev=2,c.t0=r,c.next=c.t0===g.eH.ALL?6:c.t0===g.eH.ENABLED?8:c.t0===g.eH.SHARED?10:12;break;case 6:return w=v.wF.ALL,c.abrupt("break",13);case 8:return w=v.wF.ENABLED,c.abrupt("break",13);case 10:return w=v.wF.MY_SHARE,c.abrupt("break",13);case 12:w=v.wF.ALL;case 13:return N=m.current,j=N.targetType,x=N.categoryCode,d=N.shareStatus,De={queryFilter:{dataType:v.Th.TEMPLATE,subTabType:w,targetType:j===""?void 0:j,name:u||void 0,shareStatus:d===-1?void 0:d,categoryCode:x||void 0},current:T,pageSize:l,orders:[{column:"created",asc:!1}]},W({size:l,records:[],total:0,current:T,pages:0}),c.next=18,(0,b.k_)(De);case 18:Le=c.sent,W(Le),c.next=26;break;case 22:c.prev=22,c.t1=c.catch(2),console.error("\u83B7\u53D6\u6A21\u677F\u5217\u8868\u5931\u8D25:",c.t1),S.error("\u83B7\u53D6\u6A21\u677F\u5217\u8868\u5931\u8D25");case 26:return c.prev=26,V(!1),c.finish(26);case 29:case"end":return c.stop()}},t,null,[[2,22,26,29]])})),[L,F,H.current,H.pageSize]),P=function(e){Te({current:1,pageSize:$}),Sa(C()({tabType:L,keyword:e?.keyword===void 0?F:e.keyword,page:1,pageSize:$},e||{}))},Ce=(0,h.useCallback)(function(){m.current.categoryCode="",m.current.targetType="",m.current.shareStatus=-1,I("")},[]);(0,h.useEffect)(function(){Ce(),P()},[L]);var ya=function(e){var r=L===g.eH.ALL,n=L===g.eH.SHARED;return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion,author:e.author||"",targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:r?e.useStatus===v.MN.ENABLED:void 0,shareStatus:n?e.shareStatus:void 0,publishDoc:e.publishDoc}},ma=function(e){return{icon:e.icon||"",title:e.name||"\u672A\u547D\u540D\u63D2\u4EF6",description:e.description||"\u6682\u65E0\u63CF\u8FF0",isNewVersion:e.isNewVersion||!1,author:e.author||"",dataType:e.dataType,targetType:e.targetType,configParamJson:e.serverConfigParamJson,localConfigParamJson:e.localConfigParamJson,isEnabled:e.useStatus===v.MN.ENABLED,publishDoc:e.publishDoc,ownedFlag:e.ownedFlag}},O=function(e){I(e),P({keyword:e})},Ta=function(){de(null),Z(!1)},Ca=function(){var t=k()(p()().mark(function e(r){var n;return p()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(R){a.next=2;break}return a.abrupt("return",!1);case 2:return n=null,a.prev=3,a.next=6,(0,b.$t)({uid:R.uid,configParamJson:JSON.stringify(r)});case 6:n=a.sent,a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(3),S.error("\u66F4\u65B0\u5931\u8D25"),a.abrupt("return",!1);case 13:if(!n){a.next=18;break}return Z(!1),S.success("\u66F4\u65B0\u6210\u529F"),P(),a.abrupt("return",!0);case 18:return S.error("\u66F4\u65B0\u5931\u8D25"),a.abrupt("return",!1);case 20:case"end":return a.stop()}},e,null,[[3,9]])}));return function(r){return t.apply(this,arguments)}}(),ba=function(){var t=k()(p()().mark(function e(){var r;return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(R!=null&&R.uid){u.next=2;break}return u.abrupt("return",!1);case 2:return r=null,u.prev=3,u.next=6,(0,b.m5)(R.uid);case 6:r=u.sent,u.next=13;break;case 9:return u.prev=9,u.t0=u.catch(3),S.error("\u4E0B\u7EBF\u5931\u8D25"),u.abrupt("return",!1);case 13:if(!r){u.next=18;break}return S.success("\u5DF2\u4E0B\u7EBF"),Z(!1),P(),u.abrupt("return",!0);case 18:return S.error("\u4E0B\u7EBF\u5931\u8D25"),u.abrupt("return",!1);case 20:case"end":return u.stop()}},e,null,[[3,9]])}));return function(){return t.apply(this,arguments)}}(),Ea=function(e){ca({checkTag:e,tabs:re.Ne.filter(function(r){return[e].includes(r.key)})}),ge({targetType:e,type:v.Th.TEMPLATE}),he(!1),J(null),z(!0)},Aa=function(){Ce(),P(),z(!1),J(null)},Da=function(){var t=k()(p()().mark(function e(r,n){var u,a,T;return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(l.prev=0,u={name:r.name,description:r.description,dataType:v.Th.TEMPLATE,targetType:r.targetType||D.qR.Workflow,targetId:r.targetId,categoryCode:r.categoryCode,categoryName:r.categoryName,useStatus:r.useStatus||v.MN.ENABLED,author:r.author,publishDoc:r.publishDoc,configParamJson:r.configParamJson,icon:r.icon},a=null,!(X&&B!==null&&B!==void 0&&B.uid)){l.next=16;break}if(T=C()(C()({},u),{},{uid:B.uid}),!n){l.next=11;break}return l.next=8,(0,b.Cd)(T);case 8:a=l.sent,l.next=14;break;case 11:return l.next=13,(0,b.F6)(T);case 13:a=l.sent;case 14:l.next=25;break;case 16:if(!n){l.next=22;break}return l.next=19,(0,b.$Q)(u);case 19:a=l.sent,l.next=25;break;case 22:return l.next=24,(0,b.TG)(u);case 24:a=l.sent;case 25:if(!a){l.next=31;break}return S.success(X?"\u66F4\u65B0\u6210\u529F":"\u521B\u5EFA\u6210\u529F"),Aa(),l.abrupt("return",!0);case 31:return S.error("\u64CD\u4F5C\u5931\u8D25"),l.abrupt("return",!1);case 33:l.next=40;break;case 35:return l.prev=35,l.t0=l.catch(0),console.error("\u4FDD\u5B58\u5206\u4EAB\u5931\u8D25:",l.t0),S.error("\u64CD\u4F5C\u5931\u8D25"),l.abrupt("return",!1);case 40:case"end":return l.stop()}},e,null,[[0,35]])}));return function(r,n){return t.apply(this,arguments)}}(),La=function(){var t=k()(p()().mark(function e(r,n){var u,a,T,o,l,w,N,j=arguments;return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:u=j.length>2&&j[2]!==void 0?j[2]:!1,V(!0),d.prev=2,d.t0=L,d.next=d.t0===g.eH.ALL?6:d.t0===g.eH.ENABLED?8:d.t0===g.eH.SHARED?10:12;break;case 6:return a=v.wF.ALL,d.abrupt("break",13);case 8:return a=v.wF.ENABLED,d.abrupt("break",13);case 10:return a=v.wF.MY_SHARE,d.abrupt("break",13);case 12:a=v.wF.ALL;case 13:return T=m.current,o=T.targetType,l=T.categoryCode,w=T.shareStatus,d.next=16,(0,b.k_)({queryFilter:{dataType:v.Th.TEMPLATE,subTabType:a,targetType:o===""?void 0:o,name:F||void 0,categoryCode:l===""?void 0:l,shareStatus:w===-1?void 0:w},current:r,pageSize:n,orders:[{column:"created",asc:!1}]});case 16:N=d.sent,u&&A.records?W(C()(C()({},N),{},{records:[].concat(ae()(A.records||[]),ae()(N.records||[]))})):W(N),d.next=24;break;case 20:d.prev=20,d.t1=d.catch(2),console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",d.t1),S.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25");case 24:return d.prev=24,V(!1),d.finish(24);case 27:case"end":return d.stop()}},e,null,[[2,20,24,27]])}));return function(r,n){return t.apply(this,arguments)}}(),Pa=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;q||(Te(function(n){return C()(C()({},n),{},{current:e})}),La(e,H.pageSize,r))},ka={items:[{key:D.qR.Workflow,label:"\u5DE5\u4F5C\u6D41"},{key:D.qR.Agent,label:"\u667A\u80FD\u4F53"}],onClick:function(e){Ea(e.key)}},wa=(0,h.useState)(!1),be=f()(wa,2),Na=be[0],Q=be[1],Ra=(0,h.useState)(null),Ee=f()(Ra,2),ja=Ee[0],U=Ee[1],Ma=(0,h.useState)([]),Ae=f()(Ma,2),Ha=Ae[0],G=Ae[1],$a=function(e){e.type=e.targetType,e.typeId=e.targetId,Q(!1),U({icon:e.icon,name:e.name,description:e.description,targetType:e.targetType,targetId:e.targetId.toString(),shareStatus:v.yB.DRAFT}),G([{type:e.targetType,targetId:e.targetId,status:D.BQ.Added}])},Fa=function(){var t=k()(p()().mark(function e(r){var n,u,a;return p()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(L!==g.eH.SHARED){o.next=12;break}J(r),he(!0),z(!0),Q(!1),n=r.targetType,u={icon:r.icon||"",uid:r.uid,name:r.name||"",description:r.description||"",targetType:n,targetId:(r.targetId||"").toString(),author:r.author||"",publishDoc:r.publishDoc||"",shareStatus:r.shareStatus,configParamJson:r.configParamJson||""},U(u),ge({targetType:n,type:v.Th.TEMPLATE}),G([{type:n,targetId:Number(u.targetId)||0,status:D.BQ.Added}]),o.next=23;break;case 12:if(!r.uid){o.next=23;break}return o.prev=13,o.next=16,(0,b.Ry)(r.uid);case 16:a=o.sent,a&&(de(a),Z(!0)),o.next=23;break;case 20:o.prev=20,o.t0=o.catch(13),S.error("\u83B7\u53D6\u8BE6\u60C5\u5931\u8D25");case 23:case"end":return o.stop()}},e,null,[[13,20]])}));return function(r){return t.apply(this,arguments)}}(),Ia=function(){var t=k()(p()().mark(function e(r){var n;return p()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,(0,b.n)(r);case 4:n=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(!n){a.next=14;break}return S.success("\u6A21\u677F\u5DF2\u4E0B\u7EBF"),P(),a.abrupt("return",!0);case 14:return a.abrupt("return",!1);case 15:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return t.apply(this,arguments)}}(),Za=function(){var t=k()(p()().mark(function e(r){var n;return p()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,(0,b.LI)(r);case 4:n=a.sent,a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(1),a.abrupt("return",!1);case 10:if(!n){a.next=14;break}return S.success("\u6A21\u677F\u5DF2\u64A4\u9500\u53D1\u5E03"),P(),a.abrupt("return",!0);case 14:return a.abrupt("return",!1);case 15:case"end":return a.stop()}},e,null,[[1,7]])}));return function(r){return t.apply(this,arguments)}}(),za=function(){z(!1),J(null),U(null),G([])},Ba=function(e){m.current.shareStatus=e,P()},Ja=function(e){m.current.categoryCode=e,P()},Va=function(e){m.current.targetType=e,m.current.categoryCode="",P()},Wa=function(){return L===g.eH.SHARED?(0,i.jsxs)("div",{className:y(E.headerRight),children:[(0,i.jsx)(ne,{className:y(E.searchInput),placeholder:"\u641C\u7D22\u6A21\u677F",value:F,onChange:function(r){return I(r.target.value)},onSearch:O,onClear:function(){return O("")},allowClear:!0}),(0,i.jsx)(We.Z,{menu:ka,children:(0,i.jsxs)(Oe.ZP,{type:"primary",children:[(0,i.jsx)(ze.Z,{}),"\u521B\u5EFA\u5206\u4EAB",(0,i.jsx)(Be.Z,{})]})})]}):(0,i.jsxs)("div",{className:y(E.headerRight),children:[m.current.targetType&&(0,i.jsx)($e.Z,{targetType:m.current.targetType,onChange:function(r){return Ja(r)}}),(0,i.jsx)(ne,{className:y(E.searchInput),placeholder:"\u641C\u7D22\u6A21\u677F",value:F,onChange:function(r){return I(r.target.value)},onSearch:O,onClear:function(){return O("")},allowClear:!0})]})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:y(E.container,"flex","flex-col","h-full","overflow-hide"),children:[(0,i.jsxs)("div",{className:y(E.header),children:[(0,i.jsxs)(Qe.Z,{children:[(0,i.jsx)("h3",{className:y(E.title),children:"\u6A21\u677F"}),(0,i.jsx)(Ue.Z,{className:y(E.segmented),options:Xe,value:L,onChange:function(e){return aa(e)}}),L===g.eH.SHARED?(0,i.jsx)(te.default,{options:[{label:"\u5168\u90E8",value:-1},{label:"\u5DF2\u53D1\u5E03",value:3},{label:"\u5BA1\u6838\u4E2D",value:2},{label:"\u5DF2\u4E0B\u7EBF",value:4}],style:{width:100},value:m.current.shareStatus,onChange:function(e){return Ba(e)}}):(0,i.jsx)(te.default,{options:[{label:"\u5168\u90E8",value:""},{label:"\u667A\u80FD\u4F53",value:D.qR.Agent},{label:"\u5DE5\u4F5C\u6D41",value:D.qR.Workflow}],style:{width:100},value:m.current.targetType,onChange:function(e){return Va(e)}})]}),Wa()]}),(0,i.jsx)("div",{className:y(E.pluginList,"flex-1","scroll-container-hide"),onScroll:function(e){var r=e.currentTarget,n=r.scrollTop,u=r.scrollHeight,a=r.clientHeight;u-n-a<100&&!q&&H.current<(A.pages||0)&&Pa(H.current+1,!0)},children:q&&(A==null||(M=A.records)===null||M===void 0?void 0:M.length)===0?(0,i.jsx)(je.Z,{className:y("h-full")}):A!=null&&(K=A.records)!==null&&K!==void 0&&K.length?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:y(E["list-section"]),children:(Y=A.records)===null||Y===void 0?void 0:Y.map(function(t){return(0,i.jsx)(Me.Z,C()(C()({},ya(t)),{},{onClick:k()(p()().mark(function e(){return p()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Fa(t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},e)}))}),t?.uid)})}),!(H.current<(A.pages||0))&&(0,i.jsx)(Ie.Z,{})]}):(0,i.jsx)("div",{className:y("flex","h-full","items-center","content-center"),children:(0,i.jsx)(Ge.Z,{className:y("flex","flex-col","items-center","content-center"),description:"\u6682\u65E0\u6570\u636E"})})})]}),(0,i.jsx)(He.Z,{visible:ta,data:R?ma(R):void 0,onClose:Ta,onUpdateAndEnable:Ca,onDisable:ba}),(0,i.jsx)(Fe.Z,C()({visible:ua,isEdit:X,onClose:za,onOffline:Ia,onWithdraw:Za,onSave:Da,data:ja,onAddComponent:function(){Q(!0)},onRemoveComponent:function(){U(null),G([])}},pa)),(0,i.jsx)(Ze.Z,C()({onAdded:$a,open:Na,disableCollect:!0,onCancel:function(){return Q(!1)},addComponents:Ha},oa))]})}}}]);})();
